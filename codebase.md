# app\api\upload\route.ts

```ts
import { NextRequest, NextResponse } from 'next/server'; import { writeFile } from 'fs/promises'; import { join } from 'path'; import { ValidationError } from '@/lib/errors'; import { withAuth } from '@/middleware/auth'; import { JWTPayload } from '@/lib/jwt'; // –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã —Ñ–∞–π–ª–æ–≤ const ALLOWED_TYPES = [ 'image/jpeg', 'image/png', 'image/webp', 'application/pdf', ]; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (5MB) const MAX_FILE_SIZE = 5 * 1024 * 1024; async function handler(request: NextRequest, payload: JWTPayload) { try { const formData = await request.formData(); const file = formData.get('file') as File; const type = formData.get('type') as string; if (!file) { throw new ValidationError('No file provided'); } if (!type) { throw new ValidationError('File type is required'); } // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞ if (!ALLOWED_TYPES.includes(file.type)) { throw new ValidationError('File type not allowed'); } // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞ if (file.size > MAX_FILE_SIZE) { throw new ValidationError('File size exceeds limit'); } // –°–æ–∑–¥–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞ const timestamp = Date.now(); const filename = `${payload.userId}_${timestamp}_${file.name}`; // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è const uploadDir = join(process.cwd(), 'public', 'uploads'); const filePath = join(uploadDir, filename); // –ß–∏—Ç–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ const bytes = await file.arrayBuffer(); const buffer = Buffer.from(bytes); // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª await writeFile(filePath, buffer); // URL –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª—É const fileUrl = `/uploads/${filename}`; return NextResponse.json( { url: fileUrl, type: file.type, size: file.size, }, { status: 201 } ); } catch (error) { if (error instanceof ValidationError) { return NextResponse.json( { error: error.message }, { status: error.statusCode } ); } console.error('File upload error:', error); return NextResponse.json( { error: 'Internal server error' }, { status: 500 } ); } } // Export with auth middleware export const POST = withAuth(handler);
```

# app\cargos\page.tsx

```tsx
// 'use client'; // import React, { useState, useEffect } from 'react'; // import { Button } from '@/components/ui/button'; // import { Input } from '@/components/ui/input'; // import { // Select, // SelectContent, // SelectItem, // SelectTrigger, // SelectValue, // } from '@/components/ui/select'; // import { Textarea } from '@/components/ui/textarea'; // import { // Dialog, // DialogContent, // DialogHeader, // DialogTitle, // } from '@/components/ui/dialog'; // import { Checkbox } from '@/components/ui/checkbox'; // import { Card, CardContent } from '@/components/ui/card'; // import { Badge } from '@/components/ui/badge'; // import { ScrollArea } from '@/components/ui/scroll-area'; // import { // X, // Plus, // TruckIcon, // MapPinIcon, // CalendarIcon, // CreditCardIcon, // BellIcon, // } from 'lucide-react'; // import NavigationMenu from '../components/NavigationMenu'; // import { Router } from 'next/router'; // import { useRouter } from 'next/navigation'; // import Link from 'next/link'; // import { useUser } from '@/contexts/UserContext'; // interface CargoFormData { // cargo: { // name: string; // weight: string; // volume: string; // length: string; // width: string; // height: string; // diameter: string; // packaging: string; // notes: string; // }; // route: { // loading: string; // unloading: string; // }; // transport: { // bodyType: string; // loadingType: string; // }; // when: { // loadingDates: string; // isConstant: boolean; // isReady: boolean; // }; // payment: { // method: string; // options: string[]; // }; // notifications: { // enabled: boolean; // }; // } // const initialFormData: CargoFormData = { // cargo: { // name: '', // weight: '', // volume: '', // length: '', // width: '', // height: '', // diameter: '', // packaging: '', // notes: '', // }, // route: { loading: '', unloading: '' }, // transport: { bodyType: '', loadingType: '' }, // when: { loadingDates: '', isConstant: false, isReady: false }, // payment: { method: '', options: [] }, // notifications: { enabled: false }, // }; // const sections = [ // { id: 'cargo', title: '–ì—Ä—É–∑', icon: TruckIcon }, // { id: 'route', title: '–ú–∞—Ä—à—Ä—É—Ç', icon: MapPinIcon }, // { id: 'transport', title: '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç', icon: TruckIcon }, // { id: 'when', title: '–ö–æ–≥–¥–∞', icon: CalendarIcon }, // { id: 'payment', title: '–û–ø–ª–∞—Ç–∞', icon: CreditCardIcon }, // { id: 'notifications', title: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è', icon: BellIcon }, // ]; // type CargoSection = { // name: string; // weight: string; // volume: string; // length: string; // width: string; // height: string; // diameter: string; // packaging: string; // notes: string; // }; // type RouteSection = { // loading: string; // unloading: string; // }; // type TransportSection = { // bodyType: string; // loadingType: string; // }; // type WhenSection = { // loadingDates: string; // isConstant: boolean; // isReady: boolean; // }; // type PaymentSection = { // method: string; // options: string[]; // }; // type NotificationsSection = { // enabled: boolean; // }; // // –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å CargoFormData // interface CargoFormData { // cargo: CargoSection; // route: RouteSection; // transport: TransportSection; // when: WhenSection; // payment: PaymentSection; // notifications: NotificationsSection; // } // export default function MyCargoPage() { // const [isAddingCargo, setIsAddingCargo] = useState<boolean>(false); // const [cargoCount, setCargoCount] = useState<number>(1); // const { userState } = useUser(); // const [formData, setFormData] = useState<CargoFormData>(initialFormData); // const [activeSection, setActiveSection] = useState<string>('cargo'); // const [isDialogOpen, setIsDialogOpen] = useState<boolean>(false); // const [isAllFilled, setIsAllFilled] = useState<boolean>(false); // const router = useRouter(); // useEffect(() => { // checkAllFilled(); // }, [formData]); // const checkAllFilled = () => { // const isFilled = Object.values(formData).every((section) => // Object.values(section).every((value) => // typeof value === 'boolean' // ? true // : Array.isArray(value) // ? value.length > 0 // : value !== '' // ) // ); // setIsAllFilled(isFilled); // }; // const handleInputChange = ( // section: keyof CargoFormData, // field: string, // value: string | boolean | string[] // ) => { // setFormData((prev) => ({ // ...prev, // [section]: { // ...prev[section], // [field]: value, // }, // })); // }; // const clearSection = (section: keyof CargoFormData) => { // setFormData((prev) => ({ // ...prev, // [section]: initialFormData[section], // })); // }; // const goToNextSection = () => { // const currentIndex = sections.findIndex( // (section) => section.id === activeSection // ); // if (currentIndex < sections.length - 1) { // setActiveSection(sections[currentIndex + 1].id); // } else { // setIsDialogOpen(false); // } // }; // // –¢–∏–ø—ã-–∑–∞—â–∏—Ç–Ω–∏–∫–∏ // function isCargo(section: any): section is CargoSection { // return 'name' in section && 'weight' in section && 'volume' in section; // } // function isRoute(section: any): section is RouteSection { // return 'loading' in section && 'unloading' in section; // } // function isTransport(section: any): section is TransportSection { // return 'bodyType' in section && 'loadingType' in section; // } // function isWhen(section: any): section is WhenSection { // return ( // 'loadingDates' in section && // 'isConstant' in section && // 'isReady' in section // ); // } // function isPayment(section: any): section is PaymentSection { // return ( // 'method' in section && // 'options' in section && // Array.isArray(section.options) // ); // } // function isNotifications(section: any): section is NotificationsSection { // return 'enabled' in section; // } // // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è getSectionSummary // const getSectionSummary = (sectionId: keyof CargoFormData): string => { // const sectionData = formData[sectionId]; // if (isCargo(sectionData)) { // return sectionData.name // ? `${sectionData.name}, ${sectionData.weight} ${sectionData.volume}` // : ''; // } // if (isRoute(sectionData)) { // return sectionData.loading && sectionData.unloading // ? `${sectionData.loading} - ${sectionData.unloading}` // : ''; // } // if (isTransport(sectionData)) { // return sectionData.bodyType || sectionData.loadingType // ? `${sectionData.bodyType || ''}, ${sectionData.loadingType || ''}` // .trim() // .replace(/^,\s|,\s$/g, '') // : ''; // } // if (isWhen(sectionData)) { // return sectionData.loadingDates // ? `${sectionData.loadingDates}${ // sectionData.isConstant ? ', –ø–æ—Å—Ç–æ—è–Ω–Ω–æ' : '' // }` // : ''; // } // if (isPayment(sectionData)) { // return sectionData.method // ? `${sectionData.method}, ${sectionData.options.join(', ')}` // : ''; // } // if (isNotifications(sectionData)) { // return sectionData.enabled ? '–í–∫–ª—é—á–µ–Ω—ã' : '–í—ã–∫–ª—é—á–µ–Ω—ã'; // } // return ''; // }; // const renderSectionButton = (section: { // id: string; // title: string; // icon: React.ElementType; // }) => { // const Icon = section.icon; // const summary = getSectionSummary(section.id as keyof CargoFormData); // return ( // <Button // key={section.id} // variant='outline' // className='w-full text-left justify-start items-center flex p-4 h-auto' // onClick={() => { // setActiveSection(section.id); // setIsDialogOpen(true); // }} // > // <Icon className='mr-2 h-5 w-5' /> // <div className='flex flex-col items-start'> // <span className='font-semibold'>{section.title}</span> // {summary && ( // <span className='text-sm text-gray-500 mt-1 truncate w-full'> // {summary} // </span> // )} // </div> // </Button> // ); // }; // const renderCargoContent = () => ( // <div className='space-y-4'> // <Input // placeholder='–ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–∑–∞*' // value={formData.cargo.name} // onChange={(e) => handleInputChange('cargo', 'name', e.target.value)} // /> // <div className='grid grid-cols-2 gap-2'> // <Input // placeholder='–í–µ—Å (—Ç–æ–Ω–Ω/–∫–≥)*' // value={formData.cargo.weight} // onChange={(e) => handleInputChange('cargo', 'weight', e.target.value)} // /> // <Input // placeholder='–û–±—ä–µ–º (–º¬≥)*' // value={formData.cargo.volume} // onChange={(e) => handleInputChange('cargo', 'volume', e.target.value)} // /> // </div> // <div className='grid grid-cols-2 gap-2'> // <Input // placeholder='–î–ª–∏–Ω–∞' // value={formData.cargo.length} // onChange={(e) => handleInputChange('cargo', 'length', e.target.value)} // /> // <Input // placeholder='–®–∏—Ä–∏–Ω–∞' // value={formData.cargo.width} // onChange={(e) => handleInputChange('cargo', 'width', e.target.value)} // /> // <Input // placeholder='–í—ã—Å–æ—Ç–∞' // value={formData.cargo.height} // onChange={(e) => handleInputChange('cargo', 'height', e.target.value)} // /> // <Input // placeholder='–î–∏–∞–º–µ—Ç—Ä' // value={formData.cargo.diameter} // onChange={(e) => // handleInputChange('cargo', 'diameter', e.target.value) // } // /> // </div> // <Input // placeholder='–£–ø–∞–∫–æ–≤–∫–∞' // value={formData.cargo.packaging} // onChange={(e) => // handleInputChange('cargo', 'packaging', e.target.value) // } // /> // <Textarea // placeholder='–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ' // value={formData.cargo.notes} // onChange={(e) => handleInputChange('cargo', 'notes', e.target.value)} // /> // </div> // ); // const renderRouteContent = () => ( // <div className='space-y-4'> // <Input // placeholder='–ü–æ–≥—Ä—É–∑–∫–∞*' // value={formData.route.loading} // onChange={(e) => handleInputChange('route', 'loading', e.target.value)} // /> // <Input // placeholder='–í—ã–≥—Ä—É–∑–∫–∞*' // value={formData.route.unloading} // onChange={(e) => // handleInputChange('route', 'unloading', e.target.value) // } // /> // </div> // ); // const renderTransportContent = () => ( // <div className='space-y-4'> // <Select // onValueChange={(value) => // handleInputChange('transport', 'bodyType', value) // } // > // <SelectTrigger> // <SelectValue placeholder='–¢–∏–ø –∫—É–∑–æ–≤–∞' /> // </SelectTrigger> // <SelectContent> // <SelectItem value='isothermal'>–ò–∑–æ—Ç–µ—Ä–º–∏—á–µ—Å–∫–∏–π</SelectItem> // <SelectItem value='tented'>–¢–µ–Ω—Ç–æ–≤–∞–Ω–Ω—ã–π</SelectItem> // <SelectItem value='container'>–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä</SelectItem> // <SelectItem value='van'>–§—É—Ä–≥–æ–Ω</SelectItem> // </SelectContent> // </Select> // <Select // onValueChange={(value) => // handleInputChange('transport', 'loadingType', value) // } // > // <SelectTrigger> // <SelectValue placeholder='–¢–∏–ø –ø–æ–≥—Ä—É–∑–∫–∏' /> // </SelectTrigger> // <SelectContent> // <SelectItem value='ramps'>–ê–ø–ø–∞—Ä–µ–ª–∏</SelectItem> // <SelectItem value='no-doors'>–ë–µ–∑ –≤–æ—Ä–æ—Ç</SelectItem> // <SelectItem value='side'>–ë–æ–∫–æ–≤–∞—è</SelectItem> // <SelectItem value='top'>–í–µ—Ä—Ö–Ω—è—è</SelectItem> // <SelectItem value='hydroboard'>–ì–∏–¥—Ä–æ–±–æ—Ä—Ç</SelectItem> // </SelectContent> // </Select> // </div> // ); // const renderWhenContent = () => ( // <div className='space-y-4'> // <Input // type='date' // placeholder='–î–∞—Ç–∞ –ø–æ–≥—Ä—É–∑–∫–∏*' // value={formData.when.loadingDates} // onChange={(e) => // handleInputChange('when', 'loadingDates', e.target.value) // } // /> // <div className='flex items-center space-x-2'> // <Checkbox // id='constant' // checked={formData.when.isConstant} // onCheckedChange={(checked) => // handleInputChange('when', 'isConstant', Boolean(checked)) // } // /> // <label htmlFor='constant'>–ü–æ—Å—Ç–æ—è–Ω–Ω–æ</label> // </div> // <div className='flex items-center space-x-2'> // <Checkbox // id='ready' // checked={formData.when.isReady} // onCheckedChange={(checked) => // handleInputChange('when', 'isReady', Boolean(checked)) // } // /> // <label htmlFor='ready'>–ì—Ä—É–∑ –≥–æ—Ç–æ–≤</label> // </div> // </div> // ); // const renderPaymentContent = () => ( // <div className='space-y-4'> // <Select // onValueChange={(value) => handleInputChange('payment', 'method', value)} // > // <SelectTrigger> // <SelectValue placeholder='–ú–µ—Ç–æ–¥ –æ–ø–ª–∞—Ç—ã' /> // </SelectTrigger> // <SelectContent> // <SelectItem value='cash'>–ù–∞–ª–∏—á–Ω—ã–µ</SelectItem> // <SelectItem value='card'>–ö–∞—Ä—Ç–∞</SelectItem> // <SelectItem value='transfer'>–ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ</SelectItem> // <SelectItem value='advance'>–ê–≤–∞–Ω—Å</SelectItem> // </SelectContent> // </Select> // <div className='space-y-2'> // {[ // '–í–æ–∑–º–æ–∂–µ–Ω —Ç–æ—Ä–≥', // '–û–ø–ª–∞—Ç–∞ –Ω–∞ –≤—ã–≥—Ä—É–∑–∫–µ', // '–û–ø–ª–∞—Ç–∞ –ø–æ—Å–ª–µ –≤—ã–≥—Ä—É–∑–∫–∏', // '–ß–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –¥–Ω–µ–π', // '–ó–∞–ø—Ä–æ—Å —Å—Ç–∞–≤–∫–∏', // ].map((option) => ( // <div key={option} className='flex items-center space-x-2'> // <Checkbox // id={option} // checked={formData.payment.options.includes(option)} // onCheckedChange={(checked) => { // const newOptions = checked // ? [...formData.payment.options, option] // : formData.payment.options.filter((item) => item !== option); // handleInputChange('payment', 'options', newOptions); // }} // /> // <label htmlFor={option}>{option}</label> // </div> // ))} // </div> // </div> // ); // const renderNotificationsContent = () => ( // <div className='space-y-4'> // <div className='flex items-center space-x-2'> // <Checkbox // id='notifications' // checked={formData.notifications.enabled} // onCheckedChange={(checked) => // handleInputChange('notifications', 'enabled', Boolean(checked)) // } // /> // <label htmlFor='notifications'>–í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</label> // </div> // </div> // ); // const renderContent = () => { // switch (activeSection) { // case 'cargo': // return renderCargoContent(); // case 'route': // return renderRouteContent(); // case 'transport': // return renderTransportContent(); // case 'when': // return renderWhenContent(); // case 'payment': // return renderPaymentContent(); // case 'notifications': // return renderNotificationsContent(); // default: // return null; // } // }; // return ( // <div className='min-h-screen bg-gray-50 p-4 pb-20'> // <h1 className='text-3xl font-bold text-center mb-6 text-gray-800'> // –ú–æ–∏ –≥—Ä—É–∑—ã // </h1> // <div className='space-y-4 mb-8'> // <Button // onClick={() => setIsAddingCargo(true)} // className='w-full bg-blue-600 hover:bg-blue-700 text-white' // > // <Plus className='mr-2 h-4 w-4' /> –î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–∑ // </Button> // <Button // variant='outline' // className='w-full' // onClick={() => { // router.push('/my-cargo'); // }} // > // <TruckIcon className='mr-2 h-4 w-4' /> –ú–æ–∏ –≥—Ä—É–∑—ã{' '} // <Badge variant='secondary' className='ml-2'> // {cargoCount} // </Badge> // </Button> // </div> // {isAddingCargo && ( // <Card className='mb-8 shadow-lg'> // <CardContent className='p-6'> // <h2 className='text-2xl font-semibold mb-4 text-gray-800'> // –î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–∑ // </h2> // <ScrollArea className='h-[60vh]'> // <div className='space-y-4'> // {sections.map(renderSectionButton)} // </div> // </ScrollArea> // {isAllFilled && ( // <Button // onClick={() => { // router.push('/my-cargo'); // /* –õ–æ–≥–∏–∫–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ */ // }} // className='w-full mt-6 bg-green-600 hover:bg-green-700 text-white' // > // –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å // </Button> // )} // </CardContent> // </Card> // )} // <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}> // <DialogContent className='sm:max-w-[425px]'> // <DialogHeader> // <DialogTitle> // {sections.find((s) => s.id === activeSection)?.title} // </DialogTitle> // </DialogHeader> // <ScrollArea className='max-h-[60vh] pr-4'> // {renderContent()} // </ScrollArea> // <div className='flex justify-between mt-6'> // <Button // variant='outline' // onClick={() => clearSection(activeSection as keyof CargoFormData)} // > // <X className='mr-2 h-4 w-4' /> –û—á–∏—Å—Ç–∏—Ç—å // </Button> // <Button onClick={goToNextSection}> // –î–∞–ª–µ–µ <Plus className='ml-2 h-4 w-4' /> // </Button> // </div> // </DialogContent> // </Dialog> // <NavigationMenu // userRole={userState.role === 'carrier' ? 'carrier' : 'other'} // /> // {/* <NavigationMenu userRole={'carrier'} /> */} // </div> // ); // } // app/cargos/page.tsx 'use client'; import React, { useState, useEffect } from 'react'; import { Button } from '@/components/ui/button'; import { Input } from '@/components/ui/input'; import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue, } from '@/components/ui/select'; import { Textarea } from '@/components/ui/textarea'; import { Dialog, DialogContent, DialogHeader, DialogTitle, } from '@/components/ui/dialog'; import { Checkbox } from '@/components/ui/checkbox'; import { Card, CardContent } from '@/components/ui/card'; import { Badge } from '@/components/ui/badge'; import { ScrollArea } from '@/components/ui/scroll-area'; import { X, Plus, TruckIcon, MapPinIcon, CalendarIcon, CreditCardIcon, BellIcon, AlertCircle, Loader2, } from 'lucide-react'; import NavigationMenu from '../components/NavigationMenu'; import { useRouter } from 'next/navigation'; import { useUser } from '@/contexts/UserContext'; import { api } from '@/lib/api'; import { toast } from 'sonner'; import Link from 'next/link'; interface CargoFormData { title: string; description: string; weight: number; volume?: number; length?: number; width?: number; height?: number; loading_point: string; unloading_point: string; additional_points?: { point: string; type: 'loading' | 'unloading' }[]; loading_date: string; is_constant: boolean; is_ready: boolean; vehicle_type: string; loading_type: string; payment_method: string; price?: number; payment_details?: { advance_payment?: number; payment_terms?: string; payment_location?: string; }; } const initialFormData: CargoFormData = { title: '', description: '', weight: 0, loading_point: '', unloading_point: '', loading_date: '', is_constant: false, is_ready: false, vehicle_type: '', loading_type: '', payment_method: '', }; const vehicleTypes = [ { value: 'tent', label: '–¢–µ–Ω—Ç–æ–≤–∞–Ω–Ω—ã–π' }, { value: 'refrigerator', label: '–†–µ—Ñ—Ä–∏–∂–µ—Ä–∞—Ç–æ—Ä' }, { value: 'isothermal', label: '–ò–∑–æ—Ç–µ—Ä–º–∏—á–µ—Å–∫–∏–π' }, { value: 'container', label: '–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä' }, { value: 'car_carrier', label: '–ê–≤—Ç–æ–≤–æ–∑' }, { value: 'board', label: '–ë–æ—Ä—Ç–æ–≤–æ–π' }, ]; const loadingTypes = [ { value: 'ramps', label: '–ê–ø–ø–∞—Ä–µ–ª–∏' }, { value: 'no_doors', label: '–ë–µ–∑ –≤–æ—Ä–æ—Ç' }, { value: 'side', label: '–ë–æ–∫–æ–≤–∞—è' }, { value: 'top', label: '–í–µ—Ä—Ö–Ω—è—è' }, { value: 'hydro_board', label: '–ì–∏–¥—Ä–æ–±–æ—Ä—Ç' }, ]; const paymentMethods = [ { value: 'cash', label: '–ù–∞–ª–∏—á–Ω—ã–µ' }, { value: 'card', label: '–ö–∞—Ä—Ç–∞' }, { value: 'transfer', label: '–ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥' }, { value: 'advance', label: '–ê–≤–∞–Ω—Å' }, ]; const sections = [ { id: 'cargo', title: '–ì—Ä—É–∑', icon: TruckIcon }, { id: 'route', title: '–ú–∞—Ä—à—Ä—É—Ç', icon: MapPinIcon }, { id: 'transport', title: '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç', icon: TruckIcon }, { id: 'when', title: '–ö–æ–≥–¥–∞', icon: CalendarIcon }, { id: 'payment', title: '–û–ø–ª–∞—Ç–∞', icon: CreditCardIcon }, ]; export default function CargoPage() { const [isAddingCargo, setIsAddingCargo] = useState<boolean>(false); const [formData, setFormData] = useState<CargoFormData>(initialFormData); const [activeSection, setActiveSection] = useState<string>('cargo'); const [isDialogOpen, setIsDialogOpen] = useState<boolean>(false); const [isAllFilled, setIsAllFilled] = useState<boolean>(false); const [isSubmitting, setIsSubmitting] = useState<boolean>(false); const [errors, setErrors] = useState<Record<string, string>>({}); // const [cargoCount, setCargoCount] = useState<number>(0); const { userState } = useUser(); const router = useRouter(); useEffect(() => { validateForm(); }, [formData]); const validateForm = () => { const newErrors: Record<string, string> = {}; const requiredFields = [ 'title', 'weight', 'loading_point', 'unloading_point', 'loading_date', 'vehicle_type', 'loading_type', 'payment_method', ]; requiredFields.forEach((field) => { if (!formData[field as keyof CargoFormData]) { newErrors[field] = '–≠—Ç–æ –ø–æ–ª–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ'; } }); if (formData.weight <= 0) { newErrors.weight = '–í–µ—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–æ–ª—å—à–µ 0'; } if ( formData.payment_method === 'advance' && !formData.payment_details?.advance_payment ) { newErrors.advance_payment = '–£–∫–∞–∂–∏—Ç–µ —Å—É–º–º—É –∞–≤–∞–Ω—Å–∞'; } setErrors(newErrors); setIsAllFilled(Object.keys(newErrors).length === 0); }; const handleInputChange = (name: string, value: any) => { setFormData((prev) => { const updated = { ...prev, [name]: value }; // Calculate volume if dimensions are provided if ( ['length', 'width', 'height'].includes(name) && updated.length && updated.width && updated.height ) { updated.volume = updated.length * updated.width * updated.height; } return updated; }); }; const handlePaymentDetailsChange = (field: string, value: any) => { setFormData((prev) => ({ ...prev, payment_details: { ...prev.payment_details, [field]: value, }, })); }; const handleSubmit = async () => { try { setIsSubmitting(true); validateForm(); if (!isAllFilled) { toast.error('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è'); return; } const response = await api.createCargo(formData); toast.success('–ì—Ä—É–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω'); setIsAddingCargo(false); setFormData(initialFormData); router.push('/my-cargo'); } catch (error: any) { toast.error(error.response?.data?.detail || '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≥—Ä—É–∑–∞'); console.error('Create cargo error:', error); } finally { setIsSubmitting(false); } }; const renderCargoContent = () => ( <div className='space-y-4'> <div> <label className='block text-sm font-medium mb-2'> –ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–∑–∞* </label> <Input placeholder='–ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–∑–∞' value={formData.title} onChange={(e) => handleInputChange('title', e.target.value)} // error={errors.title} /> {errors.title && ( <p className='text-sm text-red-500 mt-1'>{errors.title}</p> )} </div> <div className='grid grid-cols-2 gap-4'> <div> <label className='block text-sm font-medium mb-2'>–í–µ—Å (—Ç–æ–Ω–Ω)*</label> <Input type='number' placeholder='–í–µ—Å' value={formData.weight || ''} onChange={(e) => handleInputChange('weight', parseFloat(e.target.value)) } // error={errors.weight} /> {errors.weight && ( <p className='text-sm text-red-500 mt-1'>{errors.weight}</p> )} </div> <div> <label className='block text-sm font-medium mb-2'>–û–±—ä–µ–º (–º¬≥)</label> <Input type='number' placeholder='–û–±—ä–µ–º' value={formData.volume || ''} onChange={(e) => handleInputChange('volume', parseFloat(e.target.value)) } /> </div> </div> <div className='grid grid-cols-3 gap-4'> <div> <label className='block text-sm font-medium mb-2'>–î–ª–∏–Ω–∞ (–º)</label> <Input type='number' placeholder='–î–ª–∏–Ω–∞' value={formData.length || ''} onChange={(e) => handleInputChange('length', parseFloat(e.target.value)) } /> </div> <div> <label className='block text-sm font-medium mb-2'>–®–∏—Ä–∏–Ω–∞ (–º)</label> <Input type='number' placeholder='–®–∏—Ä–∏–Ω–∞' value={formData.width || ''} onChange={(e) => handleInputChange('width', parseFloat(e.target.value)) } /> </div> <div> <label className='block text-sm font-medium mb-2'>–í—ã—Å–æ—Ç–∞ (–º)</label> <Input type='number' placeholder='–í—ã—Å–æ—Ç–∞' value={formData.height || ''} onChange={(e) => handleInputChange('height', parseFloat(e.target.value)) } /> </div> </div> <div> <label className='block text-sm font-medium mb-2'>–û–ø–∏—Å–∞–Ω–∏–µ</label> <Textarea placeholder='–û–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–∑–∞' value={formData.description} onChange={(e) => handleInputChange('description', e.target.value)} /> </div> </div> ); const renderRouteContent = () => ( <div className='space-y-4'> <div> <label className='block text-sm font-medium mb-2'> –ü—É–Ω–∫—Ç –ø–æ–≥—Ä—É–∑–∫–∏* </label> <Input placeholder='–û—Ç–∫—É–¥–∞' value={formData.loading_point} onChange={(e) => handleInputChange('loading_point', e.target.value)} // error={errors.loading_point} /> {errors.loading_point && ( <p className='text-sm text-red-500 mt-1'>{errors.loading_point}</p> )} </div> <div> <label className='block text-sm font-medium mb-2'> –ü—É–Ω–∫—Ç –≤—ã–≥—Ä—É–∑–∫–∏* </label> <Input placeholder='–ö—É–¥–∞' value={formData.unloading_point} onChange={(e) => handleInputChange('unloading_point', e.target.value)} // error={errors.unloading_point} /> {errors.unloading_point && ( <p className='text-sm text-red-500 mt-1'>{errors.unloading_point}</p> )} </div> {formData.additional_points?.map((point, index) => ( <div key={index} className='flex items-center gap-2'> <Input placeholder={ point.type === 'loading' ? '–ü—É–Ω–∫—Ç –ø–æ–≥—Ä—É–∑–∫–∏' : '–ü—É–Ω–∫—Ç –≤—ã–≥—Ä—É–∑–∫–∏' } value={point.point} onChange={(e) => { const newPoints = [...(formData.additional_points || [])]; newPoints[index].point = e.target.value; handleInputChange('additional_points', newPoints); }} /> <Button variant='outline' size='icon' onClick={() => { const newPoints = formData.additional_points?.filter( (_, i) => i !== index ); handleInputChange('additional_points', newPoints); }} > <X className='h-4 w-4' /> </Button> </div> ))} <Button variant='outline' onClick={() => { const newPoints = [...(formData.additional_points || [])]; newPoints.push({ point: '', type: 'loading' }); handleInputChange('additional_points', newPoints); }} > <Plus className='h-4 w-4 mr-2' /> –î–æ–±–∞–≤–∏—Ç—å —Ç–æ—á–∫—É –º–∞—Ä—à—Ä—É—Ç–∞ </Button> </div> ); const renderTransportContent = () => ( <div className='space-y-4'> <div> <label className='block text-sm font-medium mb-2'> –¢–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞* </label> <Select value={formData.vehicle_type} onValueChange={(value) => handleInputChange('vehicle_type', value)} > <SelectTrigger className={errors.vehicle_type ? 'border-red-500' : ''} > <SelectValue placeholder='–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞' /> </SelectTrigger> <SelectContent> {vehicleTypes.map((type) => ( <SelectItem key={type.value} value={type.value}> {type.label} </SelectItem> ))} </SelectContent> </Select> {errors.vehicle_type && ( <p className='text-sm text-red-500 mt-1'>{errors.vehicle_type}</p> )} </div> <div> <label className='block text-sm font-medium mb-2'>–¢–∏–ø –ø–æ–≥—Ä—É–∑–∫–∏*</label> <Select value={formData.loading_type} onValueChange={(value) => handleInputChange('loading_type', value)} > <SelectTrigger className={errors.loading_type ? 'border-red-500' : ''} > <SelectValue placeholder='–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ø–æ–≥—Ä—É–∑–∫–∏' /> </SelectTrigger> <SelectContent> {loadingTypes.map((type) => ( <SelectItem key={type.value} value={type.value}> {type.label} </SelectItem> ))} </SelectContent> </Select> {errors.loading_type && ( <p className='text-sm text-red-500 mt-1'>{errors.loading_type}</p> )} </div> </div> ); const renderWhenContent = () => ( <div className='space-y-4'> <div> <label className='block text-sm font-medium mb-2'>–î–∞—Ç–∞ –ø–æ–≥—Ä—É–∑–∫–∏*</label> <Input type='date' value={formData.loading_date} onChange={(e) => handleInputChange('loading_date', e.target.value)} min={new Date().toISOString().split('T')[0]} // error={errors.loading_date} /> {errors.loading_date && ( <p className='text-sm text-red-500 mt-1'>{errors.loading_date}</p> )} </div> <div className='flex items-center space-x-2'> <Checkbox id='constant' checked={formData.is_constant} onCheckedChange={(checked) => handleInputChange('is_constant', checked) } /> <label htmlFor='constant'>–ü–æ—Å—Ç–æ—è–Ω</label> {/* </div> */} </div> <div className='flex items-center space-x-2'> <Checkbox id='ready' checked={formData.is_ready} onCheckedChange={(checked) => handleInputChange('is_ready', checked)} /> <label htmlFor='ready'>–ì—Ä—É–∑ –≥–æ—Ç–æ–≤ –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ</label> </div> </div> ); const renderPaymentContent = () => ( <div className='space-y-4'> <div> <label className='block text-sm font-medium mb-2'>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã*</label> <Select value={formData.payment_method} onValueChange={(value) => handleInputChange('payment_method', value)} > <SelectTrigger className={errors.payment_method ? 'border-red-500' : ''} > <SelectValue placeholder='–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã' /> </SelectTrigger> <SelectContent> {paymentMethods.map((method) => ( <SelectItem key={method.value} value={method.value}> {method.label} </SelectItem> ))} </SelectContent> </Select> {errors.payment_method && ( <p className='text-sm text-red-500 mt-1'>{errors.payment_method}</p> )} </div> <div> <label className='block text-sm font-medium mb-2'>–¶–µ–Ω–∞</label> <Input type='number' placeholder='–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É' value={formData.price || ''} onChange={(e) => handleInputChange('price', parseFloat(e.target.value)) } /> </div> {formData.payment_method === 'advance' && ( <div> <label className='block text-sm font-medium mb-2'> –°—É–º–º–∞ –∞–≤–∞–Ω—Å–∞* </label> <div> <Input type='number' placeholder='–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –∞–≤–∞–Ω—Å–∞' value={formData.payment_details?.advance_payment || ''} onChange={(e) => handlePaymentDetailsChange( 'advance_payment', parseFloat(e.target.value) ) } className={errors.advance_payment ? 'border-red-500' : ''} /> {errors.advance_payment && ( <p className='text-sm text-red-500 mt-1'> {errors.advance_payment} </p> )} </div> </div> )} <div> <label className='block text-sm font-medium mb-2'>–£—Å–ª–æ–≤–∏—è –æ–ø–ª–∞—Ç—ã</label> <Select value={formData.payment_details?.payment_terms || ''} onValueChange={(value) => handlePaymentDetailsChange('payment_terms', value) } > <SelectTrigger> <SelectValue placeholder='–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª–æ–≤–∏—è –æ–ø–ª–∞—Ç—ã' /> </SelectTrigger> <SelectContent> <SelectItem value='on_loading'>–ü—Ä–∏ –ø–æ–≥—Ä—É–∑–∫–µ</SelectItem> <SelectItem value='on_unloading'>–ü—Ä–∏ –≤—ã–≥—Ä—É–∑–∫–µ</SelectItem> <SelectItem value='after_unloading'>–ü–æ—Å–ª–µ –≤—ã–≥—Ä—É–∑–∫–∏</SelectItem> <SelectItem value='delayed'>–û—Ç—Å—Ä–æ—á–∫–∞ –ø–ª–∞—Ç–µ–∂–∞</SelectItem> </SelectContent> </Select> </div> <div> <label className='block text-sm font-medium mb-2'>–ú–µ—Å—Ç–æ –æ–ø–ª–∞—Ç—ã</label> <Select value={formData.payment_details?.payment_location || ''} onValueChange={(value) => handlePaymentDetailsChange('payment_location', value) } > <SelectTrigger> <SelectValue placeholder='–í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—Ç–æ –æ–ø–ª–∞—Ç—ã' /> </SelectTrigger> <SelectContent> <SelectItem value='loading_point'>–í –ø—É–Ω–∫—Ç–µ –ø–æ–≥—Ä—É–∑–∫–∏</SelectItem> <SelectItem value='unloading_point'>–í –ø—É–Ω–∫—Ç–µ –≤—ã–≥—Ä—É–∑–∫–∏</SelectItem> <SelectItem value='office'>–í –æ—Ñ–∏—Å–µ</SelectItem> </SelectContent> </Select> </div> </div> ); const renderContent = () => { switch (activeSection) { case 'cargo': return renderCargoContent(); case 'route': return renderRouteContent(); case 'transport': return renderTransportContent(); case 'when': return renderWhenContent(); case 'payment': return renderPaymentContent(); default: return null; } }; const getSectionSummary = (sectionId: string) => { switch (sectionId) { case 'cargo': return formData.title ? `${formData.title}, ${formData.weight} —Ç${ formData.volume ? `, ${formData.volume} –º¬≥` : '' }` : ''; case 'route': return formData.loading_point && formData.unloading_point ? `${formData.loading_point} - ${formData.unloading_point}` : ''; case 'transport': return formData.vehicle_type ? `${ vehicleTypes.find((t) => t.value === formData.vehicle_type) ?.label || '' }, ${ loadingTypes.find((t) => t.value === formData.loading_type) ?.label || '' }` : ''; case 'when': return formData.loading_date ? `${new Date(formData.loading_date).toLocaleDateString()}${ formData.is_constant ? ', –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π' : '' }${formData.is_ready ? ', –≥–æ—Ç–æ–≤' : ''}` : ''; case 'payment': return formData.payment_method ? `${ paymentMethods.find((m) => m.value === formData.payment_method) ?.label || '' }${formData.price ? `, ${formData.price} ‚ÇΩ` : ''}` : ''; default: return ''; } }; return ( <div className='min-h-screen bg-gray-50 p-4 pb-20'> <h1 className='text-3xl font-bold text-center mb-6 text-gray-800'> –ú–æ–∏ –≥—Ä—É–∑—ã </h1> <div className='space-y-4 mb-8'> <Button onClick={() => setIsAddingCargo(true)} className='w-full bg-blue-600 hover:bg-blue-700 text-white' > <Plus className='mr-2 h-4 w-4' /> –î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–∑ </Button> <Button variant='outline' className='w-full' onClick={() => { router.push('/my-cargo'); }} > <TruckIcon className='mr-2 h-4 w-4' /> –ú–æ–∏ –≥—Ä—É–∑—ã{' '} </Button> </div> {isAddingCargo && ( <Card className='mb-8 shadow-lg'> <CardContent className='p-6'> <h2 className='text-2xl font-semibold mb-4 text-gray-800'> –î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–∑ </h2> <ScrollArea className='h-[60vh]'> <div className='space-y-4'> {sections.map((section) => { const Icon = section.icon; const summary = getSectionSummary(section.id); return ( <Button key={section.id} variant='outline' className='w-full text-left justify-start items-center flex p-4 h-auto' onClick={() => { setActiveSection(section.id); setIsDialogOpen(true); }} > <Icon className='mr-2 h-5 w-5' /> <div className='flex flex-col items-start'> <span className='font-semibold'>{section.title}</span> {summary && ( <span className='text-sm text-gray-500 mt-1 truncate w-full'> {summary} </span> )} </div> {errors[section.id] && ( <AlertCircle className='ml-auto h-5 w-5 text-red-500' /> )} </Button> ); })} </div> </ScrollArea> {isAllFilled && ( <Button onClick={handleSubmit} className='w-full mt-6 bg-green-600 hover:bg-green-700 text-white' disabled={isSubmitting} > {isSubmitting ? ( <> <Loader2 className='mr-2 h-4 w-4 animate-spin' /> –°–æ–∑–¥–∞–Ω–∏–µ... </> ) : ( '–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å' )} </Button> )} </CardContent> </Card> )} <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}> <DialogContent className='sm:max-w-[425px]'> <DialogHeader> <DialogTitle> {sections.find((s) => s.id === activeSection)?.title} </DialogTitle> </DialogHeader> <ScrollArea className='max-h-[60vh] pr-4'> {renderContent()} </ScrollArea> <div className='flex justify-between mt-6'> <Button variant='outline' onClick={() => { const sectionData = formData[activeSection as keyof CargoFormData]; if (typeof sectionData === 'object') { handleInputChange(activeSection, {}); } else { handleInputChange(activeSection, ''); } }} > <X className='mr-2 h-4 w-4' /> –û—á–∏—Å—Ç–∏—Ç—å </Button> <Button onClick={() => { const currentIndex = sections.findIndex( (s) => s.id === activeSection ); if (currentIndex < sections.length - 1) { setActiveSection(sections[currentIndex + 1].id); } else { setIsDialogOpen(false); } }} > –î–∞–ª–µ–µ <Plus className='ml-2 h-4 w-4' /> </Button> </div> </DialogContent> </Dialog> <Link href={'/student/cargos/'}>go to cargos nigga</Link> <NavigationMenu userRole={userState.role === 'carrier' ? 'carrier' : 'other'} /> </div> ); }
```

# app\carrier-animation\page.tsx

```tsx
'use client'; import { useState, useEffect } from 'react'; import { motion, AnimatePresence } from 'framer-motion'; import Image from 'next/image'; import { useRouter } from 'next/navigation'; import img from '../blue.png'; export default function CarrierAnimationPage() { const [animationStage, setAnimationStage] = useState(0); const router = useRouter(); useEffect(() => { const timers = [ setTimeout(() => setAnimationStage(1), 4000), setTimeout(() => setAnimationStage(2), 8000), setTimeout(() => setAnimationStage(3), 10000), setTimeout(() => router.push('/registration-confirm'), 13000), // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–æ–∫–∞–∑–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ ]; return () => timers.forEach(clearTimeout); }, [router]); const logoVariants = { hidden: { x: '120%', opacity: 0, scale: 0.8 }, visible: { x: '0%', opacity: 1, scale: 1, transition: { type: 'spring', stiffness: 100, damping: 20, duration: 3 }, }, exit: { x: '-120%', opacity: 0, scale: 0.8, transition: { type: 'spring', stiffness: 100, damping: 20, duration: 3 }, }, }; const textVariants = { hidden: { opacity: 0, y: 20 }, visible: { opacity: 1, y: 0, transition: { type: 'spring', stiffness: 100, damping: 10, delay: 0.5 }, }, exit: { opacity: 0, y: -20, transition: { duration: 0.5 }, }, }; const statsVariants = { hidden: { opacity: 0, scale: 0.9 }, visible: { opacity: 1, scale: 1, transition: { type: 'spring', stiffness: 100, damping: 10, delayChildren: 0.3, staggerChildren: 0.2, }, }, exit: { opacity: 0, scale: 0.9, transition: { duration: 0.5 }, }, }; const statItemVariants = { hidden: { y: 20, opacity: 0 }, visible: { y: 0, opacity: 1, transition: { type: 'spring', stiffness: 100, damping: 10 }, }, }; return ( <div className='flex flex-col items-center justify-center min-h-screen bg-gradient-to-br from-blue-600 via-purple-500 to-pink-500 overflow-hidden p-4'> <AnimatePresence mode='wait'> {animationStage < 3 && ( <motion.div key='logo' variants={logoVariants} initial='hidden' animate={animationStage < 2 ? 'visible' : 'exit'} exit='exit' className='relative w-64 h-64 mb-8' > <Image src={img} alt='Company Logo' layout='fill' objectFit='contain' /> </motion.div> )} {animationStage === 1 && ( <motion.div key='text' variants={textVariants} initial='hidden' animate='visible' exit='exit' className='text-center mb-8' > <motion.h1 className='text-4xl font-bold text-white mb-4' style={{ textShadow: '2px 2px 4px rgba(0,0,0,0.3)' }} > –°–ª–µ–¥—É–π –∑–∞ –º–µ—á—Ç–æ–π </motion.h1> <motion.p className='text-xl text-white'> –í–º–µ—Å—Ç–µ –º—ã –¥–æ—Å—Ç–∏–≥–Ω–µ–º –Ω–æ–≤—ã—Ö –≤—ã—Å–æ—Ç </motion.p> </motion.div> )} {animationStage === 3 && ( <motion.div key='stats' variants={statsVariants} initial='hidden' animate='visible' exit='exit' className='w-full max-w-4xl' > <div className='grid grid-cols-1 md:grid-cols-3 gap-6'> {[ { label: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏', value: '+48,437', icon: 'üë•' }, { label: '–ü–µ—Ä–µ–≤–æ–∑—á–∏–∫–∏', value: '+43,743', icon: 'üöö' }, { label: '–ó–∞—è–≤–∫–∏', value: '+4,343', icon: 'üì¶' }, ].map((stat, index) => ( <motion.div key={index} variants={statItemVariants} className='bg-white bg-opacity-20 backdrop-filter backdrop-blur-lg rounded-2xl p-6 shadow-lg hover:shadow-xl transition-shadow duration-300 flex flex-col items-center justify-center text-center' > <span className='text-5xl mb-4'>{stat.icon}</span> <h3 className='text-2xl font-semibold text-white mb-2'> {stat.label} </h3> <p className='text-4xl font-bold text-yellow-300'> {stat.value} </p> </motion.div> ))} </div> </motion.div> )} </AnimatePresence> </div> ); }
```

# app\carrier-welcome\page.tsx

```tsx
'use client'; import Link from 'next/link'; import { ArrowRight } from 'lucide-react'; export default function CarrierWelcomePage() { return ( <div className='flex flex-col min-h-screen bg-red-700'> <main className='flex-grow flex items-center justify-center p-4'> <div className='bg-red-700 rounded-lg shadow-lg p-6 max-w-sm w-full border-2 border-white'> <h1 className='text-3xl font-bold mb-4 text-center text-white'> –£–≤–∞–∂–∞–µ–º—ã–µ –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–∏! </h1> <section className='mb-8 text-center text-white'> <p> –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –Ω–∞—à –º–∏–Ω–∏-–≤–µ–±—Å–∞–π—Ç –ø–æ —Å–ª–µ–¥—É—é—â–µ–π –∫–Ω–æ–ø–∫–µ "–Ω–∞—á–∞—Ç—å"üëá. </p> <br /> <p>–í—Å—è —Ä–∞–±–æ—Ç–∞ –±—É–¥–µ—Ç –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ —ç—Ç–æ—Ç –≤–µ–±—Å–∞–π—Ç.</p> <p className='mt-4 font-semibold'>–°–ø–∞—Å–∏–±–æ –∑–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ!</p> </section> </div> </main> <footer className='p-4 fixed bottom-0 left-0 right-0 flex flex-col'> <Link href='/carrier-animation' className='w-full bg-blue-500 hover:bg-blue-600 text-white text-center py-3 rounded-lg text-lg font-semibold transition duration-300 flex items-center justify-center' > –ù–∞—á–∞—Ç—å <ArrowRight className='ml-2' size={24} /> </Link> </footer> </div> ); }
```

# app\components\Button.tsx

```tsx
'use client'; import React from 'react'; interface ButtonProps { children: React.ReactNode; onClick?: () => void; className?: string; } const Button: React.FC<ButtonProps> = ({ children, onClick, className }) => { return ( <button className={`px-4 py-2 bg-primary text-white rounded-lg hover:bg-secondary transition-colors ${className}`} onClick={onClick} > {children} </button> ); }; export default Button;
```

# app\components\Form.tsx

```tsx
'use client'; import React, { ReactNode } from 'react'; interface FormProps { onSubmit: (e: React.FormEvent<HTMLFormElement>) => void; children: ReactNode; className?: string; } const Form: React.FC<FormProps> = ({ onSubmit, children, className }) => { return ( <form onSubmit={onSubmit} className={className}> {children} </form> ); }; export default Form;
```

# app\components\Input.tsx

```tsx
'use client'; import React, { ChangeEvent } from 'react'; interface InputProps { type: string; placeholder: string; value: string; onChange: (e: ChangeEvent<HTMLInputElement>) => void; className?: string; name: string; } const Input: React.FC<InputProps> = ({ type, placeholder, value, onChange, className, name }) => { return ( <input type={type} placeholder={placeholder} value={value} onChange={onChange} name={name} className={`px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary ${className}`} /> ); }; export default Input;
```

# app\components\Layout.tsx

```tsx
import React from 'react'; interface LayoutProps { children: React.ReactNode; } const Layout: React.FC<LayoutProps> = ({ children }) => { return ( <div className="min-h-screen bg-gray-100 flex flex-col"> <main className="flex-grow container mx-auto px-4 py-8">{children}</main> </div> ); }; export default Layout;
```

# app\components\NavigationMenu.tsx

```tsx
'use client'; import Link from 'next/link'; import { usePathname } from 'next/navigation'; import { Button } from '@/components/ui/button'; import { Badge } from '@/components/ui/badge'; import { Home, Truck, Package, Bell, Menu, Heart, Car } from 'lucide-react'; import { useNotifications } from '@/hooks/useNotifications'; import { useFavorites } from '@/hooks/useFavorites'; import { memo, useEffect } from 'react'; import { useApp } from '@/contexts/AppContext'; interface NavigationMenuProps { userRole: 'carrier' | 'other'; } // export default function NavigationMenu({ userRole }: NavigationMenuProps) { // const pathname = usePathname(); // const { unreadCount } = useNotifications(); // const { favorites } = useFavorites(); const NavigationMenu = memo(function NavigationMenu({ userRole, }: NavigationMenuProps) { const pathname = usePathname(); const { notificationsCount, favoritesCount } = useApp(); const isActive = (path: string) => { return pathname === path ? 'text-blue-600' : ''; }; const menuItems = userRole === 'carrier' ? [ { href: '/home', icon: Home, label: '–ì–ª–∞–≤–Ω–∞—è' }, { href: '/favorites', icon: Heart, label: '–ò–∑–±—Ä.', count: favoritesCount, }, { href: '/my-cars', icon: Car, label: '–ú–∞—à–∏–Ω—ã' }, { href: '/notifications', icon: Bell, label: '–£–≤–µ–¥–æ–º–ª.', count: notificationsCount, }, { href: '/menu', icon: Menu, label: '–ú–µ–Ω—é' }, ] : [ { href: '/home', icon: Home, label: '–ì–ª–∞–≤–Ω–∞—è' }, { href: '/requests', icon: Truck, label: '–ó–∞—è–≤–∫–∏' }, { href: '/cargos', icon: Package, label: '–ì—Ä—É–∑—ã' }, { href: '/notifications', icon: Bell, label: '–£–≤–µ–¥–æ–º–ª.', count: notificationsCount, }, { href: '/menu', icon: Menu, label: '–ú–µ–Ω—é' }, ]; useEffect(() => {}, [ notificationsCount, favoritesCount, menuItems, pathname, ]); return ( <div className='fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 py-2 px-4 flex justify-between items-center'> {menuItems.map((item) => ( <Link key={item.href} href={item.href} passHref> <Button variant='ghost' size='sm' className={`flex flex-col items-center relative ${isActive( item.href )}`} > <item.icon className='h-5 w-5' /> <span className='text-xs'>{item.label}</span> {item.count && item.count > 0 && ( <Badge variant='destructive' className='absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 text-xs' > {item.count > 99 ? '99+' : item.count} </Badge> )} </Button> </Link> ))} </div> ); }); export default NavigationMenu;
```

# app\driver-verification\page.tsx

```tsx
'use client'; import React, { useState } from 'react'; import { motion, AnimatePresence } from 'framer-motion'; import { FileUpload } from '@/components/FileUpload'; import { Button } from '@/components/ui/button'; import { Dialog, DialogContent, DialogHeader, DialogTitle, } from '@/components/ui/dialog'; import { Loader2 } from 'lucide-react'; import { useRouter } from 'next/navigation'; import { AuthService } from '@/lib/auth'; import { toast } from 'sonner'; type VerificationStage = 'initial' | 'uploading' | 'verifying' | 'result'; interface VerificationResult { isApproved: boolean; message: string; } interface Document { id: string; type: string; url: string; } const DriverVerificationPage: React.FC = () => { const router = useRouter(); const [stage, setStage] = useState<VerificationStage>('initial'); const [isModalOpen, setIsModalOpen] = useState<boolean>(false); const [documents, setDocuments] = useState<Document[]>([]); const [verificationResult, setVerificationResult] = useState<VerificationResult | null>(null); const [isLoading, setIsLoading] = useState(false); // const handleDocumentUpload = async (documentData: any, type: string) => { // try { // const response = await AuthService.uploadDocument( // documentData.file, // type // ); // setDocuments((prev) => [...prev, response]); // toast.success('–î–æ–∫—É–º–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω'); // } catch (error) { // toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞'); // console.error('Document upload error:', error); // } // }; const handleVerification = async () => { if (documents.length < 2) { toast.error('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∞–≤'); return; } setStage('verifying'); setIsModalOpen(false); setIsLoading(true); try { // –ò–º–∏—Ç–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ await new Promise((resolve) => setTimeout(resolve, 2000)); const isApproved = Math.random() > 0.1; setVerificationResult({ isApproved, message: isApproved ? '–í–∞—à–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø—Ä–∞–≤–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞—à–∏–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º. –¢–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ –ø—Ä–æ–π—Ç–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —á–µ—Ä–µ–∑ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É MyID.' : "–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤–∞—à–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø—Ä–∞–≤–∞ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞—à–∏–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º.\n –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∫–∞—Ç–µ–≥–æ—Ä–∏—è –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∞–≤ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–∞–∫ –º–∏–Ω–∏–º—É–º 'C'. ", }); setStage('result'); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤'); console.error('Verification error:', error); setStage('initial'); } finally { setIsLoading(false); } }; const pageVariants = { initial: { opacity: 0, y: 20 }, in: { opacity: 1, y: 0 }, out: { opacity: 0, y: -20 }, }; const pageTransition = { type: 'tween', ease: 'anticipate', duration: 0.5, }; return ( <div className='min-h-screen bg-blue-600 flex items-center justify-center p-4'> <AnimatePresence mode='wait'> {stage === 'initial' && ( <motion.div key='initial' initial='initial' animate='in' exit='out' variants={pageVariants} transition={pageTransition} className='bg-white rounded-lg shadow-xl p-8 max-w-md w-full text-center' > <h1 className='text-2xl font-bold mb-6 text-blue-800'> –£–≤–∞–∂–∞–µ–º—ã–π –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫ </h1> <p className='mb-8 text-gray-600'> –ß—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞—à–∏–º —Å–µ—Ä–≤–∏—Å–æ–º –±–µ—Å–ø–ª–∞—Ç–Ω–æ, –ø—Ä–æ—Å–∏–º –≤–∞—Å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤–∞—à—É –ª–∏—á–Ω–æ—Å—Ç—å. –î–ª—è —ç—Ç–æ–≥–æ —Å–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∞—à–∏ –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∞. </p> <Button onClick={() => setIsModalOpen(true)} className='bg-blue-500 hover:bg-blue-600 text-white' > –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∞ </Button> </motion.div> )} {stage === 'verifying' && ( <motion.div key='verifying' initial='initial' animate='in' exit='out' variants={pageVariants} transition={pageTransition} className='bg-white rounded-lg shadow-xl p-8 max-w-md w-full text-center' > <Loader2 className='animate-spin h-16 w-16 text-blue-500 mx-auto mb-4' /> <h2 className='text-xl font-semibold text-blue-800'> –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ </h2> <p className='text-gray-600 mt-2'> –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ. –ú—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞—à–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã. </p> </motion.div> )} {stage === 'result' && verificationResult && ( <motion.div key='result' initial='initial' animate='in' exit='out' variants={pageVariants} transition={pageTransition} className='bg-white rounded-lg shadow-xl p-8 max-w-md w-full text-center' > <h1 className='text-2xl font-bold mb-6 text-blue-800'> –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ </h1> <p className={`mb-8 ${ verificationResult.isApproved ? 'text-green-600' : 'text-red-600' }`} > {verificationResult.message} </p> {verificationResult.isApproved && ( <Button className='bg-green-500 hover:bg-green-600 text-white' onClick={() => { router.push('/registration-confirm'); }} > –ü–µ—Ä–µ–π—Ç–∏ –∫ MyID </Button> )} </motion.div> )} </AnimatePresence> <Dialog open={isModalOpen} onOpenChange={setIsModalOpen}> <DialogContent className='sm:max-w-md'> <DialogHeader> <DialogTitle className='text-center text-xl font-semibold text-blue-800'> –ó–∞–≥—Ä—É–∑–∫–∞ –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∞–≤ </DialogTitle> </DialogHeader> <div className='space-y-6'> <div> <label className='block text-sm font-medium mb-2 text-gray-700'> –ü–µ—Ä–µ–¥–Ω—è—è —Å—Ç–æ—Ä–æ–Ω–∞ </label> {/* <FileUpload type='driver_license_front' onUpload={(data) => handleDocumentUpload(data, 'driver_license_front') } allowedTypes={['image/jpeg', 'image/png']} maxSize={5 * 1024 * 1024} label='–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–µ—Ä–µ–¥–Ω—é—é —Å—Ç–æ—Ä–æ–Ω—É' /> */} </div> <div> <label className='block text-sm font-medium mb-2 text-gray-700'> –ó–∞–¥–Ω—è—è —Å—Ç–æ—Ä–æ–Ω–∞ </label> {/* <FileUpload type='driver_license_back' onUpload={(data) => handleDocumentUpload(data, 'driver_license_back') } allowedTypes={['image/jpeg', 'image/png']} maxSize={5 * 1024 * 1024} label='–ó–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞–¥–Ω—é—é —Å—Ç–æ—Ä–æ–Ω—É' /> */} </div> <Button onClick={handleVerification} disabled={documents.length < 2 || isLoading} className='w-full bg-blue-500 hover:bg-blue-600 text-white' > {isLoading ? ( <> <Loader2 className='animate-spin h-4 w-4 mr-2' /> –ü—Ä–æ–≤–µ—Ä–∫–∞... </> ) : ( '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É' )} </Button> </div> </DialogContent> </Dialog> </div> ); }; export default DriverVerificationPage;
```

# app\favorites\page.tsx

```tsx
'use client'; import React, { useState } from 'react'; import { Button } from '@/components/ui/button'; import { Card, CardContent } from '@/components/ui/card'; import { Badge } from '@/components/ui/badge'; import { Heart, ArrowLeft, Trash2, ChevronDown, ChevronUp } from 'lucide-react'; import NavigationMenu from '../components/NavigationMenu'; import { useRouter } from 'next/navigation'; import { useApp } from '@/contexts/AppContext'; import { formatDate } from '@/lib/utils'; import { motion, AnimatePresence } from 'framer-motion'; import { Dialog, DialogContent, DialogHeader, DialogTitle, } from '@/components/ui/dialog'; import { useUser } from '@/contexts/UserContext'; export default function FavoritesPage() { const router = useRouter(); const { favorites, removeFromFavorites, clearAllFavorites } = useApp(); const [expandedItems, setExpandedItems] = useState<string[]>([]); const [showDeleteConfirm, setShowDeleteConfirm] = useState(false); const [itemToDelete, setItemToDelete] = useState<number | null>(null); const { userState } = useUser(); const toggleExpand = (id: string) => { setExpandedItems((prev) => prev.includes(id) ? prev.filter((item) => item !== id) : [...prev, id] ); }; const getFavoriteIcon = (type: string) => { switch (type) { case 'cargo': return 'üì¶'; case 'route': return 'üöö'; case 'carrier': return 'üöõ'; default: return '‚ù§Ô∏è'; } }; const handleDelete = (id: number) => { setItemToDelete(id); setShowDeleteConfirm(true); }; const confirmDelete = () => { if (itemToDelete) { removeFromFavorites(itemToDelete); } setShowDeleteConfirm(false); setItemToDelete(null); }; const groupedFavorites = favorites.reduce( (acc: Record<string, any[]>, item) => { // const groupedFavorites = favorites.reduce((acc, item) => { if (!acc[item.type]) { acc[item.type] = []; } acc[item.type].push(item); return acc; }, {} as Record<string, any[]> ); return ( <div className='min-h-screen bg-gray-50 p-4 pb-20'> <div className='flex items-center mb-6'> <Button variant='ghost' onClick={() => router.back()} className='mr-2'> <ArrowLeft className='h-6 w-6' /> </Button> <h1 className='text-2xl font-bold'>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</h1> </div> <div className='flex justify-between items-center mb-4'> <div className='flex items-center'> <Heart className='h-5 w-5 mr-2 text-red-500' /> <span className='font-semibold'>–í—Å–µ–≥–æ: {favorites.length}</span> </div> {favorites.length > 0 && ( <Button variant='outline' size='sm' onClick={clearAllFavorites}> <Trash2 className='h-4 w-4 mr-2' /> –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ </Button> )} </div> <AnimatePresence mode='popLayout'> {Object.entries(groupedFavorites).length === 0 ? ( <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -20 }} className='text-center py-8 text-gray-500' > –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ </motion.div> ) : ( Object.entries(groupedFavorites).map(([type, items]) => ( <motion.div key={type} layout initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className='mb-6' > <h2 className='text-lg font-semibold mb-3 flex items-center'> {getFavoriteIcon(type)} <span className='ml-2'> {type === 'cargo' && '–ì—Ä—É–∑—ã'} {type === 'route' && '–ú–∞—Ä—à—Ä—É—Ç—ã'} {type === 'carrier' && '–ü–µ—Ä–µ–≤–æ–∑—á–∏–∫–∏'} </span> <Badge variant='secondary' className='ml-2'> {items.length} </Badge> </h2> <AnimatePresence mode='popLayout'> {items.map((item) => ( <motion.div key={item.id} layout initial={{ opacity: 0, x: -20 }} animate={{ opacity: 1, x: 0 }} exit={{ opacity: 0, x: 20 }} transition={{ duration: 0.2 }} > <Card className='mb-3'> <CardContent className='p-4'> <div className='flex justify-between items-start'> <div className='flex-1'> <div className='flex items-center justify-between'> <h3 className='font-medium'>{item.title}</h3> <Button variant='ghost' size='sm' onClick={() => handleDelete(item.orderId)} > <Trash2 className='h-4 w-4 text-red-500' /> </Button> </div> <p className='text-sm text-gray-500 mb-2'> {formatDate(item.createdAt)} </p> <p className='text-sm'>{item.description}</p> <AnimatePresence> {expandedItems.includes(item.id) && ( <motion.div initial={{ height: 0, opacity: 0 }} animate={{ height: 'auto', opacity: 1 }} exit={{ height: 0, opacity: 0 }} className='mt-4 space-y-2 text-sm' > {Object.entries(item.details).map( ([key, value]) => ( <p key={key}> <span className='font-medium'> {key}: </span>{' '} {value as React.ReactNode} </p> ) )} </motion.div> )} </AnimatePresence> </div> </div> <Button variant='ghost' size='sm' onClick={() => toggleExpand(item.id)} className='mt-2 w-full' > {expandedItems.includes(item.id) ? ( <> <ChevronUp className='h-4 w-4 mr-2' /> –°–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª–∏ </> ) : ( <> <ChevronDown className='h-4 w-4 mr-2' /> –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª–∏ </> )} </Button> </CardContent> </Card> </motion.div> ))} </AnimatePresence> </motion.div> )) )} </AnimatePresence> <Dialog open={showDeleteConfirm} onOpenChange={setShowDeleteConfirm}> <DialogContent> <DialogHeader> <DialogTitle>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è</DialogTitle> </DialogHeader> <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ?</p> <div className='flex justify-end space-x-2 mt-4'> <Button variant='outline' onClick={() => setShowDeleteConfirm(false)} > –û—Ç–º–µ–Ω–∞ </Button> <Button variant='destructive' onClick={confirmDelete}> –£–¥–∞–ª–∏—Ç—å </Button> </div> </DialogContent> </Dialog> <NavigationMenu userRole={userState.role === 'carrier' ? 'carrier' : 'other'} /> {/* <NavigationMenu userRole='carrier' /> */} </div> ); }
```

# app\game\page.tsx

```tsx
'use client'; import React, { useRef, useState, useEffect } from 'react'; import * as THREE from 'three'; import { Canvas, useFrame, useLoader } from '@react-three/fiber'; import { Sky, OrbitControls, Environment, useTexture } from '@react-three/drei'; import { usePlane } from '@react-three/cannon'; // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–¥–∞–Ω–∏—è —Å —Ç–µ–∫—Å—Ç—É—Ä–∞–º–∏ const Building = ({ position, size, }: { position: [number, number, number]; size: [number, number, number]; }) => { const texture = useTexture({ map: '/building_texture.jpg', // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –ø—É—Ç—å –∫ —Ç–µ–∫—Å—Ç—É—Ä–µ }); return ( <mesh position={position}> <boxGeometry args={size} /> <meshStandardMaterial map={texture.map} roughness={0.7} metalness={0.3} /> </mesh> ); }; // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–µ–º–ª–∏ —Å —Ç–µ–∫—Å—Ç—É—Ä–æ–π // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–µ–º–ª–∏ const Ground = () => { const [ref] = usePlane(() => ({ rotation: [-Math.PI / 2, 0, 0], position: [0, -0.5, 0], })); return ( <mesh ref={ref as any} rotation={[-Math.PI / 2, 0, 0]} position={[0, -0.5, 0]} > <planeGeometry args={[1000, 1000]} /> <meshStandardMaterial color='#3a7e3d' /> </mesh> ); }; // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥—Ä–æ–Ω–∞ const Drone = () => { const droneRef = useRef<THREE.Group>(null); const [movement, setMovement] = useState({ forward: false, backward: false, left: false, right: false, up: false, down: false, }); const speed = 0.5; const [position, setPosition] = useState<[number, number, number]>([0, 5, 0]); useEffect(() => { const handleKeyDown = (e: KeyboardEvent) => { switch (e.code) { case 'KeyW': setMovement((prev) => ({ ...prev, forward: true })); break; case 'KeyS': setMovement((prev) => ({ ...prev, backward: true })); break; case 'KeyA': setMovement((prev) => ({ ...prev, left: true })); break; case 'KeyD': setMovement((prev) => ({ ...prev, right: true })); break; case 'Space': setMovement((prev) => ({ ...prev, up: true })); break; case 'ShiftLeft': setMovement((prev) => ({ ...prev, down: true })); break; } }; const handleKeyUp = (e: KeyboardEvent) => { switch (e.code) { case 'KeyW': setMovement((prev) => ({ ...prev, forward: false })); break; case 'KeyS': setMovement((prev) => ({ ...prev, backward: false })); break; case 'KeyA': setMovement((prev) => ({ ...prev, left: false })); break; case 'KeyD': setMovement((prev) => ({ ...prev, right: false })); break; case 'Space': setMovement((prev) => ({ ...prev, up: false })); break; case 'ShiftLeft': setMovement((prev) => ({ ...prev, down: false })); break; } }; window.addEventListener('keydown', handleKeyDown); window.addEventListener('keyup', handleKeyUp); return () => { window.removeEventListener('keydown', handleKeyDown); window.removeEventListener('keyup', handleKeyUp); }; }, []); useFrame((state) => { if (!droneRef.current) return; const moveDirection = new THREE.Vector3(); const camera = state.camera; // –ü–æ–ª—É—á–∞–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–≤–æ—Ä–æ—Ç–∞ –∫–∞–º–µ—Ä—ã if (movement.forward) moveDirection.z -= 1; if (movement.backward) moveDirection.z += 1; if (movement.left) moveDirection.x -= 1; if (movement.right) moveDirection.x += 1; if (movement.up) moveDirection.y += 1; if (movement.down) moveDirection.y -= 1; moveDirection.normalize(); moveDirection.applyEuler(new THREE.Euler(0, camera.rotation.y, 0)); moveDirection.multiplyScalar(speed); // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é setPosition((prev) => [ prev[0] + moveDirection.x, prev[1] + moveDirection.y, prev[2] + moveDirection.z, ]); // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é –∫–∞–º–µ—Ä—ã camera.position.set(position[0], position[1], position[2]); }); return ( <group ref={droneRef} position={position}> <mesh> <boxGeometry args={[0.5, 0.2, 0.5]} /> <meshStandardMaterial color='red' metalness={0.8} roughness={0.2} /> </mesh> </group> ); }; // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≥–æ—Ä–æ–¥–∞ const City = () => { const buildingData = [ { pos: [-20, 15, -20], size: [10, 30, 10] }, { pos: [20, 20, -20], size: [10, 40, 10] }, { pos: [-20, 25, 20], size: [10, 50, 10] }, { pos: [20, 15, 20], size: [10, 30, 10] }, { pos: [0, 20, -30], size: [15, 40, 15] }, { pos: [-30, 18, 0], size: [12, 36, 12] }, { pos: [30, 22, 0], size: [14, 44, 14] }, { pos: [0, 25, 30], size: [16, 50, 16] }, ]; return ( <> {buildingData.map((building, index) => ( <Building key={index} position={building.pos as [number, number, number]} size={building.size as [number, number, number]} /> ))} </> ); }; // –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è const DroneSimulator = () => { const [started, setStarted] = useState(false); const handleStart = () => { setStarted(true); // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º –¥–ª—è Telegram Web App // if (window.Telegram?.WebApp) { // window.Telegram.WebApp.requestFullScreen(); // } }; if (!started) { return ( <div style={{ position: 'fixed', top: 0, left: 0, width: '100vw', height: '100vh', display: 'flex', justifyContent: 'center', alignItems: 'center', backgroundColor: '#000', }} > <button onClick={handleStart} style={{ padding: '20px 40px', fontSize: '20px', borderRadius: '10px', border: 'none', backgroundColor: '#4CAF50', color: 'white', cursor: 'pointer', }} > –ù–∞—á–∞—Ç—å –ø–æ–ª—ë—Ç </button> </div> ); } return ( <div style={{ width: '100vw', height: '100vh' }}> <Canvas shadows camera={{ fov: 75 }}> <ambientLight intensity={0.5} /> <pointLight position={[10, 10, 10]} intensity={1} castShadow /> <Sky sunPosition={[100, 20, 100]} /> <Environment preset='city' /> <Drone /> <City /> <Ground /> <OrbitControls makeDefault /> </Canvas> <div style={{ position: 'absolute', top: 20, left: 20, color: 'white', backgroundColor: 'rgba(0,0,0,0.5)', padding: '10px', borderRadius: '5px', fontFamily: 'Arial', }} > <h3 style={{ margin: '0 0 10px 0' }}>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</h3> <p style={{ margin: '5px 0' }}>WASD - –¥–≤–∏–∂–µ–Ω–∏–µ</p> <p style={{ margin: '5px 0' }}>–ú—ã—à—å - –ø–æ–≤–æ—Ä–æ—Ç –∫–∞–º–µ—Ä—ã</p> <p style={{ margin: '5px 0' }}>–ü—Ä–æ–±–µ–ª - –ø–æ–¥—ä—ë–º</p> <p style={{ margin: '5px 0' }}>Shift - —Å–Ω–∏–∂–µ–Ω–∏–µ</p> </div> </div> ); }; export default DroneSimulator;
```

# app\globals.css

```css
@tailwind base; @tailwind components; @tailwind utilities; @layer base { :root { --background: #ffffff; --background-secondary: #f3f4f6; --foreground: #020817; --foreground-secondary: #4b5563; --primary: #0066ff; --primary-foreground: #ffffff; --secondary: #ff6b00; --secondary-foreground: #ffffff; --muted: #f3f4f6; --muted-foreground: #6b7280; --accent: #f3f4f6; --accent-foreground: #0066ff; --destructive: #ef4444; --destructive-foreground: #ffffff; --border: #e5e7eb; --input: #e5e7eb; --ring: #0066ff; --radius: 0.5rem; } .dark { --background: #020817; --background-secondary: #1f2937; --foreground: #ffffff; --foreground-secondary: #9ca3af; --primary: #3b82f6; --primary-foreground: #ffffff; --secondary: #ff8533; --secondary-foreground: #ffffff; --muted: #1f2937; --muted-foreground: #9ca3af; --accent: #1f2937; --accent-foreground: #3b82f6; --destructive: #ef4444; --destructive-foreground: #ffffff; --border: #374151; --input: #374151; --ring: #3b82f6; } } @layer base { * { @apply border-border; } body { @apply bg-background text-foreground; font-feature-settings: 'rlig' 1, 'calt' 1; } } .text-balance { text-wrap: balance; }
```

# app\home\page.tsx

```tsx
'use client'; import React, { useState, useEffect } from 'react'; import { Input } from '@/components/ui/input'; import { Button } from '@/components/ui/button'; import { Card, CardContent } from '@/components/ui/card'; import { Badge } from '@/components/ui/badge'; import { Dialog, DialogContent, DialogHeader, DialogTitle, } from '@/components/ui/dialog'; import { Checkbox } from '@/components/ui/checkbox'; import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue, } from '@/components/ui/select'; import { DateRange, Range, RangeKeyDict } from 'react-date-range'; import 'react-date-range/dist/styles.css'; import 'react-date-range/dist/theme/default.css'; import { Filter, Star, CheckCircle, Clock, Bell, Heart, ChevronDown, ChevronUp, } from 'lucide-react'; import NavigationMenu from '../components/NavigationMenu'; import { useUser } from '@/contexts/UserContext'; import { useRouter } from 'next/navigation'; import { useFavorites } from '@/hooks/useFavorites'; import { useNotifications } from '@/hooks/useNotifications'; import { useApp } from '@/contexts/AppContext'; type UserRole = 'carrier' | 'other'; interface Order { id: number; cargo: string; weight: number; date: string; payment: string; price: string; from: string; to: string; vehicleType: string; description: string; isTop: boolean; isVerified: boolean; experience: number; rating: number; dimensions: string; loadingType: string; unloadingType: string; additionalRequirements: string; } interface FilterState { category: string; from: string; to: string; dateRange: Range; notifications: boolean; } const mockOrders: Order[] = [ { id: 1, cargo: '–ú–µ—Ç–∞–ª–ª', weight: 22, date: '12.12.2023 14:34', payment: '–ö–æ–º–±–æ', price: '–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è', from: '–¢–∞—à–∫–µ–Ω—Ç', to: '–ú–æ—Å–∫–≤–∞', vehicleType: '–¢–µ–Ω—Ç', description: '–¢–∞—à–∫–µ–Ω—Ç-–ú–æ—Å–∫–≤–∞, –Ω—É–∂–µ–Ω-—Ç–µ–Ω—Ç, –≥—Ä—É–∑-–º–µ—Ç–∞–ª–ª, –≤–µ—Å:22—Ç, –æ–ø–ª–∞—Ç–∞:–∫–æ–º–±–æ, –¥–∞—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è: 12.12.2023', isTop: true, isVerified: true, experience: 2, rating: 4, dimensions: '5x2x2 –º', loadingType: '–ë–æ–∫–æ–≤–∞—è', unloadingType: '–ó–∞–¥–Ω—è—è', additionalRequirements: '–¢—Ä–µ–±—É–µ—Ç—Å—è –∫—Ä–µ–ø–ª–µ–Ω–∏–µ –≥—Ä—É–∑–∞', }, { id: 2, cargo: '–¢–µ–∫—Å—Ç–∏–ª—å', weight: 15, date: '10.12.2023 11:00', payment: '–ë–µ–∑–Ω–∞–ª–∏—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç', price: '2500$', from: '–ë—É—Ö–∞—Ä–∞', to: '–ê–ª–º–∞—Ç—ã', vehicleType: '–†–µ—Ñ—Ä–∏–∂–µ—Ä–∞—Ç–æ—Ä', description: '–ë—É—Ö–∞—Ä–∞-–ê–ª–º–∞—Ç—ã, —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ—Ñ—Ä–∏–∂–µ—Ä–∞—Ç–æ—Ä, —Ç–µ–∫—Å—Ç–∏–ª—å–Ω—ã–µ –∏–∑–¥–µ–ª–∏—è, –≤–µ—Å: 15—Ç, –æ–ø–ª–∞—Ç–∞: –±–µ–∑–Ω–∞–ª–∏—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç, –¥–∞—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è: 10.12.2023', isTop: false, isVerified: true, experience: 3, rating: 5, dimensions: '6x2.5x2.5 –º', loadingType: '–ó–∞–¥–Ω—è—è', unloadingType: '–ó–∞–¥–Ω—è—è', additionalRequirements: '–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å -5¬∞C', }, { id: 3, cargo: '–ê–≤—Ç–æ–∑–∞–ø—á–∞—Å—Ç–∏', weight: 8, date: '08.12.2023 09:30', payment: '–ù–∞–ª–∏—á–Ω—ã–µ', price: '1200$', from: '–°–∞–º–∞—Ä–∫–∞–Ω–¥', to: '–ö–∏–µ–≤', vehicleType: '–¢–µ–Ω—Ç', description: '–°–∞–º–∞—Ä–∫–∞–Ω–¥-–ö–∏–µ–≤, —Ç–µ–Ω—Ç, –∞–≤—Ç–æ–∑–∞–ø—á–∞—Å—Ç–∏, –≤–µ—Å: 8—Ç, –æ–ø–ª–∞—Ç–∞: –Ω–∞–ª–∏—á–Ω—ã–µ, –¥–∞—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è: 08.12.2023', isTop: false, isVerified: true, experience: 1, rating: 3.5, dimensions: '4x2x2 –º', loadingType: '–ë–æ–∫–æ–≤–∞—è', unloadingType: '–ó–∞–¥–Ω—è—è', additionalRequirements: '–ù–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π', }, { id: 4, cargo: '–°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã', weight: 30, date: '05.12.2023 07:45', payment: '–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è', price: '–ü–æ –∑–∞–ø—Ä–æ—Å—É', from: '–¢–∞—à–∫–µ–Ω—Ç', to: '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥', vehicleType: '–¢–µ–Ω—Ç', description: '–¢–∞—à–∫–µ–Ω—Ç-–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, —Ç–µ–Ω—Ç, —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã, –≤–µ—Å: 30—Ç, –æ–ø–ª–∞—Ç–∞: –¥–æ–≥–æ–≤–æ—Ä–Ω–∞—è, –¥–∞—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è: 05.12.2023', isTop: true, isVerified: false, experience: 5, rating: 4.5, dimensions: '10x3x3 –º', loadingType: '–ó–∞–¥–Ω—è—è', unloadingType: '–ó–∞–¥–Ω—è—è', additionalRequirements: '–¢—Ä–µ–±—É—é—Ç—Å—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤', }, // –î–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ –∑–∞–∫–∞–∑–æ–≤ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏ ]; const cargoCategories = [ '–ú–µ—Ç–∞–ª–ª', '–¢–µ–∫—Å—Ç–∏–ª—å', '–ü—Ä–æ–¥—É–∫—Ç—ã', '–¢–µ—Ö–Ω–∏–∫–∞', '–°—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª—ã', ]; const cities = [ '–¢–∞—à–∫–µ–Ω—Ç', '–ú–æ—Å–∫–≤–∞', '–ë—É—Ö–∞—Ä–∞', '–ê–Ω–¥–∏–∂–∞–Ω', '–°–∞–º–∞—Ä–∫–∞–Ω–¥', '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥', ]; const RoleConfirmationDialog: React.FC<{ onConfirm: (role: 'carrier' | 'other') => void; }> = ({ onConfirm }) => { return ( <Dialog open={true}> <DialogContent> <DialogHeader> <DialogTitle>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –≤–∞—à—É —Ä–æ–ª—å</DialogTitle> </DialogHeader> <div className='space-y-4'> <Button onClick={() => onConfirm('carrier')} className='w-full'> –Ø –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫ </Button> <Button onClick={() => onConfirm('other')} className='w-full'> –Ø –¥—Ä—É–≥–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å </Button> </div> </DialogContent> </Dialog> ); }; const FilterModal: React.FC<{ isOpen: boolean; onClose: () => void; onApply: (filters: FilterState) => void; }> = ({ isOpen, onClose, onApply }) => { const [filters, setFilters] = useState<FilterState>({ category: '', from: '', to: '', dateRange: { startDate: undefined, endDate: undefined, key: 'selection', }, notifications: false, }); const handleSelectChange = (name: keyof FilterState, value: string) => { setFilters((prev) => ({ ...prev, [name]: value })); }; const handleDateRangeChange = (ranges: RangeKeyDict) => { setFilters((prev) => ({ ...prev, dateRange: ranges.selection })); }; const handleCheckboxChange = (checked: boolean) => { setFilters((prev) => ({ ...prev, notifications: checked })); }; const handleApply = () => { onApply(filters); onClose(); }; return ( <Dialog open={isOpen} onOpenChange={onClose}> <DialogContent className='bg-blue-600 text-white'> <DialogHeader> <DialogTitle className='text-white text-center'> –ü–æ–∏—Å–∫ –≥—Ä—É–∑–æ–≤ </DialogTitle> </DialogHeader> <div className='space-y-4 max-w-[100vw] overflow-y-auto'> <Select onValueChange={(value) => handleSelectChange('category', value)} > <SelectTrigger className='bg-blue-500 text-white border-blue-400'> <SelectValue placeholder='–ö–∞—Ç–µ–≥–æ—Ä–∏—è –≥—Ä—É–∑–æ–≤' /> </SelectTrigger> <SelectContent> {cargoCategories.map((category) => ( <SelectItem key={category} value={category}> {category} </SelectItem> ))} </SelectContent> </Select> <Select onValueChange={(value) => handleSelectChange('from', value)}> <SelectTrigger className='bg-blue-500 text-white border-blue-400'> <SelectValue placeholder='–û—Ç–∫—É–¥–∞' /> </SelectTrigger> <SelectContent> {cities.map((city) => ( <SelectItem key={city} value={city}> {city} </SelectItem> ))} </SelectContent> </Select> <Select onValueChange={(value) => handleSelectChange('to', value)}> <SelectTrigger className='bg-blue-500 text-white border-blue-400'> <SelectValue placeholder='–ö—É–¥–∞' /> </SelectTrigger> <SelectContent> {cities.map((city) => ( <SelectItem key={city} value={city}> {city} </SelectItem> ))} </SelectContent> </Select> <div className='bg-white rounded-md p-2'> <DateRange ranges={[filters.dateRange]} onChange={handleDateRangeChange} months={1} direction='vertical' className='w-full' /> </div> <div className='flex items-center space-x-2'> <Checkbox id='notifications' checked={filters.notifications} onCheckedChange={handleCheckboxChange} /> <label htmlFor='notifications' className='text-white'> –í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è </label> </div> <Button onClick={handleApply} className='w-full bg-yellow-400 text-blue-800 hover:bg-yellow-500' > –ù–∞–π—Ç–∏ –≥—Ä—É–∑—ã </Button> </div> </DialogContent> </Dialog> ); }; export default function OrdersPage() { const [searchTerm, setSearchTerm] = useState(''); const [orders, setOrders] = useState<Order[]>(mockOrders); const [isFilterModalOpen, setIsFilterModalOpen] = useState(false); const [showNotificationDialog, setShowNotificationDialog] = useState(false); const [expandedOrder, setExpandedOrder] = useState<number | null>(null); const { userState, setUserRole } = useUser(); // const router = useRouter(); const [currentOrder, setCurrentOrder] = useState<Order | null>(null); // const { userState } = useUser(); const router = useRouter(); const { addNotification, addToFavorites, removeFromFavorites, isFavorite, notifications, favorites, } = useApp(); // const { addNotification } = useNotifications(); // const { addToFavorites, removeFromFavorites, isFavorite } = useFavorites(); const [showErrorDialog, setShowErrorDialog] = useState(false); const [errorMessage, setErrorMessage] = useState(''); useEffect(() => { // if (!userState.isAuthenticated && !userState.role) { // router.push('/select-lang'); // } // const savedRole = localStorage.getItem('userRole') as UserRole | null; // if (savedRole) { // setUserRole(savedRole); // } setOrders(mockOrders); const handleBeforeUnload = () => { localStorage.clear(); }; window.addEventListener('beforeunload', handleBeforeUnload); return () => { window.removeEventListener('beforeunload', handleBeforeUnload); }; }, [ userState, router, addNotification, addToFavorites, removeFromFavorites, isFavorite, orders, ]); const handleRoleConfirm = (role: 'carrier' | 'other') => { setUserRole(role === 'carrier' ? 'carrier' : 'cargo-owner'); }; const handleSearch = (e: React.ChangeEvent<HTMLInputElement>) => { setSearchTerm(e.target.value); // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∑–∞–∫–∞–∑–æ–≤ }; const handleApplyFilters = (filters: FilterState) => { console.log('Applied filters:', filters); // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∫ –∑–∞–∫–∞–∑–∞–º }; const handleNotificationToggle = (order: Order) => { if ( notifications.some( (notification) => notification.orderId === order.id && !notification.isRead ) ) { setErrorMessage('–î–ª—è —ç—Ç–æ–≥–æ –≥—Ä—É–∑–∞ —É–∂–µ –≤–∫–ª—é—á–µ–Ω—ã –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏'); setShowErrorDialog(true); } else { setCurrentOrder(order); setShowNotificationDialog(true); } }; const handleEnableNotification = () => { if (currentOrder) { addNotification({ orderId: currentOrder.id, type: 'cargo', message: `–í–∫–ª—é—á–µ–Ω—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –≥—Ä—É–∑–∞: ${currentOrder.cargo} (${currentOrder.from} - ${currentOrder.to})`, }); setShowNotificationDialog(false); } }; const handleFavoriteToggle = (order: Order) => { // const favoriteId = `cargo-${order.id}`; if (isFavorite(order.id)) { setErrorMessage('–≠—Ç–æ—Ç –≥—Ä—É–∑ —É–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–º'); setShowErrorDialog(true); } else { addToFavorites({ orderId: order.id, type: order.cargo, title: `${order.cargo}: ${order.from} - ${order.to}`, description: order.description, details: { –í–µ—Å: `${order.weight} —Ç`, –ì–∞–±–∞—Ä–∏—Ç—ã: order.dimensions, '–¢–∏–ø –ø–æ–≥—Ä—É–∑–∫–∏': order.loadingType, '–¢–∏–ø —Ä–∞–∑–≥—Ä—É–∑–∫–∏': order.unloadingType, –û–ø–ª–∞—Ç–∞: order.payment, –¶–µ–Ω–∞: order.price, }, }); } }; const renderStars = (rating: number) => { return Array(5) .fill(0) .map((_, i) => ( <Star key={i} className={`h-4 w-4 ${ i < rating ? 'text-yellow-400 fill-current' : 'text-gray-300' }`} /> )); }; const toggleOrderExpansion = (orderId: number) => { setExpandedOrder(expandedOrder === orderId ? null : orderId); }; if (!userState.role && !userState.isAuthenticated) { return <RoleConfirmationDialog onConfirm={handleRoleConfirm} />; } return ( <div className='min-h-screen bg-blue-600 p-4 pb-20'> <div className='flex items-center mb-4 bg-white rounded-lg p-2'> <Input type='text' placeholder='–ü–æ–∏—Å–∫ –∑–∞–∫–∞–∑–æ–≤...' value={searchTerm} onChange={handleSearch} className='mr-2 flex-grow' /> <Button variant='default' size='sm' className='bg-yellow-400 text-black hover:bg-yellow-500 whitespace-nowrap' onClick={() => setIsFilterModalOpen(true)} > <Filter className='h-4 w-4 mr-2' /> –§–∏–ª—å—Ç—Ä—ã </Button> </div> <FilterModal isOpen={isFilterModalOpen} onClose={() => setIsFilterModalOpen(false)} onApply={handleApplyFilters} /> <div className='space-y-4 mb-20'> {orders.map((order) => ( <Card key={order.id} className='bg-white overflow-hidden'> <CardContent className='p-4'> <div className='flex justify-between items-start mb-2'> <div className='flex space-x-1'> {order.isTop && ( <Badge variant='secondary' className='bg-yellow-100 text-yellow-800' title='–¢–æ–ø –∑–∞—è–≤–∫–∏ –æ—Ç –Ω–∞—à–∏—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤' > <Star className='h-4 w-4' /> </Badge> )} {order.isVerified && ( <Badge variant='secondary' className='bg-green-100 text-green-800' title='–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω' > <CheckCircle className='h-4 w-4' /> </Badge> )} {order.experience > 1 && ( <Badge variant='secondary' className='bg-blue-100 text-blue-800' title='–û–ø—ã—Ç –ª–æ–≥–∏—Å—Ç–∞' > <Clock className='h-4 w-4' /> {order.experience}–≥ </Badge> )} </div> <div className='flex items-center'> <span className='font-bold mr-1'>{order.rating}</span> <div className='flex'>{renderStars(order.rating)}</div> </div> </div> <div className='flex justify-between items-center mb-2'> <span className='font-bold text-lg'> {order.from} - {order.to} </span> <span className='text-sm text-gray-500'>{order.date}</span> </div> <div className='grid grid-cols-2 gap-2 mb-2 text-sm'> <span>–ì—Ä—É–∑: {order.cargo}</span> <span>–í–µ—Å: {order.weight} —Ç</span> <span>–¢–∏–ø: {order.vehicleType}</span> <span>–û–ø–ª–∞—Ç–∞: {order.payment}</span> </div> <div className='mb-2'> <span className='font-semibold'>–¶–µ–Ω–∞: {order.price}</span> </div> {expandedOrder === order.id && ( <div className='mt-4 text-sm'> <p>–†–∞–∑–º–µ—Ä—ã: {order.dimensions}</p> <p>–¢–∏–ø –ø–æ–≥—Ä—É–∑–∫–∏: {order.loadingType}</p> <p>–¢–∏–ø —Ä–∞–∑–≥—Ä—É–∑–∫–∏: {order.unloadingType}</p> <p>–î–æ–ø. —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è: {order.additionalRequirements}</p> <p className='mt-2'>–û–ø–∏—Å–∞–Ω–∏–µ: {order.description}</p> </div> )} <div className='flex justify-between mt-4'> <Button variant='outline' size='sm' className='flex-1 mr-1' onClick={() => toggleOrderExpansion(order.id)} > {expandedOrder === order.id ? ( <ChevronUp className='h-4 w-4 mr-1' /> ) : ( <ChevronDown className='h-4 w-4 mr-1' /> )} {expandedOrder === order.id ? '–°–∫—Ä—ã—Ç—å' : '–ü–æ–¥—Ä–æ–±–Ω–µ–µ'} </Button> <Button variant='outline' size='sm' className='flex-1 ml-1 mr-1' onClick={() => handleNotificationToggle(order)} > <Bell className='h-4 w-4 mr-1' /> </Button> {/* <Button variant='outline' size='sm' className='flex-1 ml-1 mr-1' onClick={() => setShowNotificationDialog(true)} > <Bell className='h-4 w-4 mr-1' /> </Button> */} <Button variant='outline' size='sm' className={`flex-1 ${ isFavorite(order.id) ? 'text-red-500 hover:text-red-600' : '' }`} onClick={() => handleFavoriteToggle(order)} > <Heart className='h-4 w-4 mr-1' /> </Button> {/* <Button variant='outline' size='sm' className='flex-1'> <Heart className='h-4 w-4 mr-1' /> </Button> */} </div> </CardContent> </Card> ))} </div> <Dialog open={showNotificationDialog} onOpenChange={setShowNotificationDialog} > <DialogContent> <DialogHeader> <DialogTitle>–í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è?</DialogTitle> </DialogHeader> <p> –í—ã –±—É–¥–µ—Ç–µ –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö –ø–æ —ç—Ç–æ–º—É –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é –∏ —Ç–∏–ø—É –≥—Ä—É–∑–∞. </p> <div className='flex justify-end space-x-2 mt-4'> <Button variant='outline' onClick={() => setShowNotificationDialog(false)} > –û—Ç–º–µ–Ω–∞ </Button> <Button onClick={handleEnableNotification}>–í–∫–ª—é—á–∏—Ç—å</Button> </div> </DialogContent> </Dialog> {/* <Dialog open={showNotificationDialog} onOpenChange={setShowNotificationDialog} > <DialogContent> <DialogHeader> <DialogTitle>–í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è?</DialogTitle> </DialogHeader> <p> –•–æ—Ç–∏—Ç–µ –≤–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Ç–∏–ø–∞–º –≥—Ä—É–∑–∞ –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º? </p> <div className='flex justify-end space-x-2 mt-4'> <Button variant='outline' onClick={() => setShowNotificationDialog(false)} > –û—Ç–º–µ–Ω–∞ </Button> <Button onClick={() => { // –õ–æ–≥–∏–∫–∞ –≤–∫–ª—é—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π setShowNotificationDialog(false); }} > –í–∫–ª—é—á–∏—Ç—å </Button> </div> </DialogContent> </Dialog> */} <Dialog open={showErrorDialog} onOpenChange={setShowErrorDialog}> <DialogContent> <DialogHeader> <DialogTitle>–í–Ω–∏–º–∞–Ω–∏–µ</DialogTitle> </DialogHeader> <p>{errorMessage}</p> <div className='flex justify-end space-x-2 mt-4'> <Button onClick={() => setShowErrorDialog(false)}>–ü–æ–Ω—è—Ç–Ω–æ</Button> </div> </DialogContent> </Dialog> <NavigationMenu userRole={userState.role === 'carrier' ? 'carrier' : 'other'} /> </div> ); // <NavigationMenu // userRole={userState.role === 'carrier' ? 'carrier' : 'other'} // /> // {/* <NavigationMenu userRole={userRole} /> */} // </div> // ); }
```

# app\layout.tsx

```tsx
'use client'; import './globals.css'; import { Inter } from 'next/font/google'; import { ErrorBoundary } from '@/components/ErrorBoundary'; import { AppProvider } from '@/contexts/AppContext'; import { ThemeProvider } from '@/contexts/ThemeContext'; import { LoadingProvider } from '@/components/LoadingProvider'; import { ToastProvider } from '@/components/ToastProvider'; import Script from 'next/script'; import { UserProvider } from '@/contexts/UserContext'; const inter = Inter({ subsets: ['latin'] }); export default function RootLayout({ children, }: { children: React.ReactNode; }) { return ( <html lang='en' suppressHydrationWarning> <head> <Script src='https://telegram.org/js/telegram-web-app.js' strategy='beforeInteractive' /> </head> <body className={inter.className}> <ErrorBoundary> <AppProvider> <UserProvider> {/* <ThemeProvider> */} <LoadingProvider> <ToastProvider /> {children} </LoadingProvider> </UserProvider> {/* </ThemeProvider> */} </AppProvider> </ErrorBoundary> </body> </html> ); }
```

# app\menu\page.tsx

```tsx
// 'use client'; // import React, { useState } from 'react'; // import { Button } from '@/components/ui/button'; // import { Card, CardContent } from '@/components/ui/card'; // import { Avatar } from '@/components/ui/avatar'; // import { Input } from '@/components/ui/input'; // import { // Dialog, // DialogContent, // DialogHeader, // DialogTitle, // } from '@/components/ui/dialog'; // import { // Star, // Search, // MapPin, // Heart, // FileText, // HelpCircle, // Settings, // MessageSquare, // LogOut, // ChevronRight, // Camera, // Trash2, // ArrowLeft, // } from 'lucide-react'; // import NavigationMenu from '../components/NavigationMenu'; // import { useRouter } from 'next/navigation'; // import { useUser } from '@/contexts/UserContext'; // interface UserProfile { // name: string; // photo: string; // contactInfo: string; // rating: number; // experience: string; // recommendations: number; // complaints: number; // id: string; // position: string; // telegram: string; // whatsapp: string; // mobile: string; // role: string; // studyCity: string; // group: string; // studyLanguage: string; // curator: string; // graduationDate: string; // } // export default function MenuPage() { // const [showProfile, setShowProfile] = useState<boolean>(false); // const [isEditModalOpen, setIsEditModalOpen] = useState<boolean>(false); // const [showLogoutConfirm, setShowLogoutConfirm] = useState<boolean>(false); // const [userProfile, setUserProfile] = useState<UserProfile>({ // name: '', // photo: // 'https://i.pinimg.com/736x/24/00/1e/24001e0c9918570fae6645f683a515a8.jpg', // contactInfo: '', // rating: 0, // experience: '', // recommendations: 0, // complaints: 0, // id: '', // position: '', // telegram: '', // whatsapp: '', // mobile: '', // role: '', // studyCity: '', // group: '', // studyLanguage: '', // curator: '', // graduationDate: '', // }); // const router = useRouter(); // const { userState, logout, setUserData } = useUser(); // React.useEffect(() => { // if (userState.userData) { // setUserProfile({ // name: userState.userData.fullName || '', // photo: // 'https://i.pinimg.com/736x/24/00/1e/24001e0c9918570fae6645f683a515a8.jpg', // contactInfo: userState.userData.phoneNumber || '', // rating: 5, // experience: '1 –≥–æ–¥', // recommendations: 0, // complaints: 0, // id: Math.random().toString(36).substr(2, 9), // position: userState.userData.position || '', // telegram: userState.userData.telegramNumber || '', // whatsapp: userState.userData.whatsappNumber || '', // mobile: userState.userData.phoneNumber || '', // role: userState.role || '', // studyCity: userState.userData.city || '', // group: userState.userData.groupName || '', // studyLanguage: userState.userData.studyLanguage || '', // curator: userState.userData.curatorName || '', // graduationDate: userState.userData.endDate || '', // }); // } // }, [userState]); // const handleLogout = () => { // logout(); // router.push('/'); // }; // // const handleLogout = () => { // // // –û—á–∏—â–∞–µ–º localStorage // // localStorage.removeItem('logit_token'); // // localStorage.removeItem('logit_user_state'); // // // –£–¥–∞–ª—è–µ–º –∫—É–∫–∏ // // document.cookie = 'logit_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;'; // // document.cookie = 'bot_access=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;'; // // // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–æ–≥–∏–Ω–∞ // // router.push('/login'); // // }; // const renderStars = (rating: number) => { // return Array(5) // .fill(0) // .map((_, i) => ( // <Star // key={i} // className={`h-5 w-5 ${ // i < rating ? 'text-yellow-400 fill-current' : 'text-gray-300' // }`} // /> // )); // }; // const renderProfile = () => ( // <Card className='mt-4'> // <CardContent className='p-6'> // <div className='flex items-center justify-between mb-4'> // <div className='flex items-center'> // <Avatar className='h-16 w-16 mr-4'> // <img src={userProfile.photo} alt={userProfile.name} /> // </Avatar> // <div> // <h2 className='text-2xl font-bold'>{userProfile.name}</h2> // <p className='text-gray-600'>{userProfile.id}</p> // </div> // </div> // <Button // variant='outline' // size='sm' // onClick={() => setIsEditModalOpen(true)} // > // <Camera className='h-4 w-4 mr-2' /> // –ò–∑–º–µ–Ω–∏—Ç—å // </Button> // </div> // <div className='mb-4'> // <p className='text-green-600 font-semibold mb-2'> // –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω // </p> // <div className='flex mb-2'>{renderStars(userProfile.rating)}</div> // <p className='mb-2'>–°—Ç–∞–∂: {userProfile.experience}</p> // <p className='mb-2'>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: {userProfile.recommendations}</p> // <p className='mb-2'>–ñ–∞–ª–æ–±—ã: {userProfile.complaints}</p> // </div> // <div className='space-y-2'> // <h3 className='text-xl font-semibold mb-3'>–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3> // <p>Telegram: {userProfile.telegram}</p> // <p>WhatsApp: {userProfile.whatsapp}</p> // <p>–¢–µ–ª–µ—Ñ–æ–Ω: {userProfile.mobile}</p> // </div> // <div className='mt-4 space-y-2'> // <h3 className='text-xl font-semibold mb-3'>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ–±—É—á–µ–Ω–∏–∏</h3> // <p>–î–æ–ª–∂–Ω–æ—Å—Ç—å: {userProfile.position}</p> // <p>–†–æ–ª—å: {userProfile.role}</p> // <p>–ì–æ—Ä–æ–¥ –æ–±—É—á–µ–Ω–∏—è: {userProfile.studyCity}</p> // <p>–ì—Ä—É–ø–ø–∞: {userProfile.group}</p> // <p>–Ø–∑—ã–∫ –æ–±—É—á–µ–Ω–∏—è: {userProfile.studyLanguage}</p> // <p>–ö—É—Ä–∞—Ç–æ—Ä: {userProfile.curator}</p> // <p>–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è: {userProfile.graduationDate}</p> // </div> // <Button // variant='destructive' // className='w-full mt-6' // onClick={() => setShowLogoutConfirm(true)} // > // <LogOut className='h-5 w-5 mr-2' /> // –í—ã–π—Ç–∏ // </Button> // </CardContent> // </Card> // ); // const EditProfileModal = () => ( // <Dialog open={isEditModalOpen} onOpenChange={setIsEditModalOpen}> // <DialogContent className='sm:max-w-[425px]'> // <DialogHeader> // <DialogTitle>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</DialogTitle> // </DialogHeader> // <div className='grid gap-4 py-4'> // <div className='flex items-center justify-center mb-4'> // <Avatar className='h-24 w-24'> // <img src={userProfile.photo} alt={userProfile.name} /> // </Avatar> // <div className='ml-4 space-y-2'> // <Button variant='outline' size='sm'> // <Camera className='h-4 w-4 mr-2' /> // –ò–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ç–æ // </Button> // <Button variant='outline' size='sm'> // <Trash2 className='h-4 w-4 mr-2' /> // –£–¥–∞–ª–∏—Ç—å —Ñ–æ—Ç–æ // </Button> // </div> // </div> // <Input // placeholder='–§–ò–û' // value={userProfile.name} // onChange={(e) => { // setUserProfile({ ...userProfile, name: e.target.value }); // setUserData({ ...userState.userData!, fullName: e.target.value }); // }} // /> // <Input // placeholder='–ú–æ–±–∏–ª—å–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω' // value={userProfile.mobile} // onChange={(e) => { // setUserProfile({ ...userProfile, mobile: e.target.value }); // setUserData({ // ...userState.userData!, // phoneNumber: e.target.value, // }); // }} // /> // <Input // placeholder='Telegram' // value={userProfile.telegram} // onChange={(e) => { // setUserProfile({ ...userProfile, telegram: e.target.value }); // setUserData({ // ...userState.userData!, // telegramNumber: e.target.value, // }); // }} // /> // <Input // placeholder='WhatsApp' // value={userProfile.whatsapp} // onChange={(e) => { // setUserProfile({ ...userProfile, whatsapp: e.target.value }); // setUserData({ // ...userState.userData!, // whatsappNumber: e.target.value, // }); // }} // /> // <Input // placeholder='–î–æ–ª–∂–Ω–æ—Å—Ç—å' // value={userProfile.position} // onChange={(e) => { // setUserProfile({ ...userProfile, position: e.target.value }); // setUserData({ ...userState.userData!, position: e.target.value }); // }} // /> // <Input // placeholder='–ì–æ—Ä–æ–¥' // value={userProfile.studyCity} // onChange={(e) => { // setUserProfile({ ...userProfile, studyCity: e.target.value }); // setUserData({ ...userState.userData!, city: e.target.value }); // }} // /> // </div> // <div className='flex justify-end space-x-2'> // <Button variant='outline' onClick={() => setIsEditModalOpen(false)}> // –û—Ç–º–µ–Ω–∞ // </Button> // <Button onClick={() => setIsEditModalOpen(false)}>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</Button> // </div> // </DialogContent> // </Dialog> // ); // const menuItems = [ // { // icon: <Search className='h-5 w-5 mr-2' />, // text: '–ü–æ–∏—Å–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏ —Å–ø–∏—Å–æ–∫ —Ñ–∏—Ä–º', // action: () => router.push('/search'), // }, // { // icon: <MapPin className='h-5 w-5 mr-2' />, // text: '–†–∞—Å—á–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π', // action: () => {}, // }, // { // icon: <Heart className='h-5 w-5 mr-2' />, // text: '–ò–∑–±—Ä–∞–Ω–Ω–æ–µ', // action: () => router.push('/favorites'), // }, // { // icon: <FileText className='h-5 w-5 mr-2' />, // text: '–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏', // action: () => {}, // }, // { // icon: <HelpCircle className='h-5 w-5 mr-2' />, // text: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞', // action: () => {}, // }, // { // icon: <Settings className='h-5 w-5 mr-2' />, // text: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è', // action: () => router.push('/settings'), // }, // { // icon: <MessageSquare className='h-5 w-5 mr-2' />, // text: '–û—Ç–∑—ã–≤—ã', // action: () => {}, // }, // ]; // return ( // <div className='min-h-screen bg-gray-50 p-4 pb-20'> // <div className='flex items-center mb-6'> // <Button variant='ghost' onClick={() => router.back()}> // <ArrowLeft className='h-6 w-6' /> // </Button> // <h1 className='text-2xl font-bold ml-2'>–ú–µ–Ω—é</h1> // </div> // <div className='flex items-center justify-between mb-4'> // <div className='flex items-center'> // <Avatar className='h-12 w-12 mr-4'> // <img src={userProfile.photo} alt={userProfile.name} /> // </Avatar> // <div> // <p className='font-semibold'>{userProfile.name}</p> // <Button // variant='link' // className='p-0' // onClick={() => setShowProfile(!showProfile)} // > // –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç // </Button> // </div> // </div> // <Button // variant='ghost' // size='sm' // onClick={() => setIsEditModalOpen(true)} // > // <ChevronRight className='h-5 w-5' /> // </Button> // </div> // {showProfile ? ( // renderProfile() // ) : ( // <> // <Input className='mb-4' placeholder='–ü–æ–∏—Å–∫...' /> // {menuItems.map((item, index) => ( // <Button // key={index} // variant='ghost' // className='w-full justify-start mb-2' // onClick={item.action} // > // {item.icon} // {item.text} // </Button> // ))} // </> // )} // <EditProfileModal /> // <Dialog open={showLogoutConfirm} onOpenChange={setShowLogoutConfirm}> // <DialogContent> // <DialogHeader> // <DialogTitle>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞</DialogTitle> // </DialogHeader> // <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?</p> // <div className='flex justify-end space-x-2 mt-4'> // <Button // variant='outline' // onClick={() => setShowLogoutConfirm(false)} // > // –û—Ç–º–µ–Ω–∞ // </Button> // <Button variant='destructive' onClick={handleLogout}> // –í—ã–π—Ç–∏ // </Button> // </div> // </DialogContent> // </Dialog> // <NavigationMenu // userRole={userState.role === 'carrier' ? 'carrier' : 'other'} // /> // </div> // ); // } 'use client'; import React, { useState, useEffect } from 'react'; import { Button } from '@/components/ui/button'; import { Card, CardContent } from '@/components/ui/card'; import { Avatar } from '@/components/ui/avatar'; import { Input } from '@/components/ui/input'; import { ScrollArea } from '@/components/ui/scroll-area'; import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter, } from '@/components/ui/dialog'; import { Separator } from '@/components/ui/separator'; import { toast } from 'sonner'; import { Search, MapPin, Heart, FileText, HelpCircle, Settings, MessageSquare, LogOut, ChevronRight, Camera, Trash2, ArrowLeft, User, Building2, Truck, GraduationCap, Loader2, Gamepad, FileIcon, Plus, Trash2Icon, } from 'lucide-react'; import NavigationMenu from '../components/NavigationMenu'; import { useRouter } from 'next/navigation'; import { useUser } from '@/contexts/UserContext'; import { api } from '@/lib/api'; import { Language, UserRole, UserType } from '@/types'; import { Badge } from '@/components/ui/badge'; import { FileUpload } from '@/components/FileUpload'; import { Select, SelectTrigger, SelectValue, SelectContent, SelectItem, } from '@radix-ui/react-select'; interface ProfileField { key: string; label: string; type: 'text' | 'tel' | 'email' | 'date'; required?: boolean; } const defaultProfiles: Record<string, ProfileField[]> = { student: [ { key: 'full_name', label: '–§–ò–û', type: 'text', required: true }, { key: 'student_id', label: '–°—Ç—É–¥–µ–Ω—á–µ—Å–∫–∏–π ID', type: 'text', required: true, }, { key: 'username', label: 'Telegram', type: 'text' }, { key: 'whatsapp_number', label: 'WhatsApp', type: 'tel' }, { key: 'phone_number', label: '–¢–µ–ª–µ—Ñ–æ–Ω', type: 'tel', required: true }, { key: 'group_name', label: '–ì—Ä—É–ø–ø–∞', type: 'text', required: true }, { key: 'end_date', label: '–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è', type: 'date' }, ], carrier: [ { key: 'full_name', label: '–§–ò–û', type: 'text', required: true }, { key: 'company_name', label: '–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏', type: 'text' }, // { key: 'telegramNumber', label: 'Telegram', type: 'text' }, { key: 'whatsapp_number', label: 'WhatsApp', type: 'tel' }, { key: 'phone_number', label: '–¢–µ–ª–µ—Ñ–æ–Ω', type: 'tel', required: true }, // { // key: 'licenseNumber', // label: '–ù–æ–º–µ—Ä –ª–∏—Ü–µ–Ω–∑–∏–∏', // type: 'text', // required: true, // }, ], 'cargo-owner': [ { key: 'full_name', label: '–§–ò–û', type: 'text', required: true }, { key: 'company_name', label: '–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏', type: 'text', required: true, }, // { key: 'telegramNumber', label: 'Telegram', type: 'text' }, { key: 'whatsapp_number', label: 'WhatsApp', type: 'tel' }, { key: 'phone_number', label: '–¢–µ–ª–µ—Ñ–æ–Ω', type: 'tel', required: true }, // { // key: 'registration_certificate', // label: '–†–µ–≥. –Ω–æ–º–µ—Ä', // type: 'file', // required: true, // }, ], }; const getRoleIcon = (role: string) => { switch (role) { case 'student': return GraduationCap; case 'carrier': return Truck; case 'cargo-owner': return Building2; default: return User; } }; const documentTypes = [ { value: 'driver_license', label: '–í–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∞', required: true }, { value: 'passport', label: '–ü–∞—Å–ø–æ—Ä—Ç', required: true }, { value: 'company_certificate', label: '–°–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–º–ø–∞–Ω–∏–∏', required: false, }, { value: 'other', label: '–î—Ä—É–≥–æ–µ', required: false }, ] as const; interface DocumentFormData { file: File; type: 'driver_license' | 'passport' | 'company_certificate' | 'other'; title: string; } export interface Document { id: string; type: string; title: string; file_url: string; uploaded_at: string; verified: boolean; verified_at?: string; notes?: string; } export interface VehicleDocument extends Document { vehicle_id: string; expiry_date?: string; } export interface UserDocument extends Document { user_id: string; } const DocumentsSection = () => { const [documents, setDocuments] = useState<UserDocument[]>([]); const [isAddingDocument, setIsAddingDocument] = useState(false); const [isLoading, setIsLoading] = useState(true); const [selectedDocument, setSelectedDocument] = useState<DocumentFormData | null>(null); useEffect(() => { fetchDocuments(); }, []); const fetchDocuments = async () => { try { setIsLoading(true); const response = await api.getUserDocuments(); setDocuments(response); console.log(response, 'document users'); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤'); } finally { setIsLoading(false); } }; const handleDocumentUpload = async (document: DocumentFormData) => { try { await api.addUserDocument(document); toast.success('–î–æ–∫—É–º–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω'); fetchDocuments(); setIsAddingDocument(false); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞'); } }; const handleDeleteDocument = async (id: string) => { try { await api.deleteUserDocument(id); toast.success('–î–æ–∫—É–º–µ–Ω—Ç —É–¥–∞–ª–µ–Ω'); fetchDocuments(); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞'); } }; const renderDocumentCard = (document: UserDocument) => ( <Card key={document.id} className='mb-4'> <CardContent className='p-4'> <div className='flex justify-between items-start'> <div> <h3 className='font-semibold'>{document.title}</h3> <p className='text-sm text-gray-600'> {documentTypes.find((t) => t.value === document.type)?.label} </p> </div> <div className='flex space-x-2'> <Badge variant={document.verified ? 'outline' : 'secondary'}> {document.verified ? '–ü—Ä–æ–≤–µ—Ä–µ–Ω' : '–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ'} </Badge> <Button variant='ghost' size='sm' onClick={() => window.open(document.file_url, '_blank')} > <FileIcon className='h-4 w-4 mr-1' /> –ü—Ä–æ—Å–º–æ—Ç—Ä </Button> <Button variant='ghost' size='sm' className='text-red-600' onClick={() => handleDeleteDocument(document.id)} > <Trash2Icon className='h-4 w-4' /> </Button> </div> </div> </CardContent> </Card> ); const renderAddDocumentDialog = () => ( <Dialog open={isAddingDocument} onOpenChange={setIsAddingDocument}> <DialogContent> <DialogHeader> <DialogTitle>–î–æ–±–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç</DialogTitle> </DialogHeader> <div className='space-y-4'> <div> <label className='block text-sm font-medium mb-2'>type*</label> <Select value={selectedDocument?.type} onValueChange={(value: any) => setSelectedDocument( (prev) => ({ ...prev, type: value } as DocumentFormData) ) } > <SelectTrigger> <SelectValue placeholder='–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞' /> </SelectTrigger> <SelectContent> {documentTypes.map((type) => ( <SelectItem key={type.value} value={type.value}> {type.label} {type.required && ' *'} </SelectItem> ))} </SelectContent> </Select> </div> {/* <Select value={selectedDocument?.type} onValueChange={(value: any) => setSelectedDocument( (prev) => ({ ...prev, type: value } as DocumentFormData) ) } > <SelectTrigger> <SelectValue placeholder='–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞' /> </SelectTrigger> <SelectContent> {documentTypes.map((type) => ( <SelectItem key={type.value} value={type.value}> {type.label} {type.required && ' *'} </SelectItem> ))} </SelectContent> </Select> */} <Input placeholder='–ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞' value={selectedDocument?.title || ''} onChange={(e) => setSelectedDocument( (prev) => ({ ...prev, title: e.target.value } as DocumentFormData) ) } /> <FileUpload onUpload={(file) => { if (selectedDocument?.type) { handleDocumentUpload({ file, type: selectedDocument.type, title: selectedDocument.title || file.name, }); } else { toast.error('–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞'); } }} allowedTypes={['image/jpeg', 'image/png', 'application/pdf']} maxSize={5 * 1024 * 1024} label='–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç' /> </div> </DialogContent> </Dialog> ); if (isLoading) { return <Loader2 className='h-8 w-8 animate-spin text-blue-600' />; } return ( <div className='space-y-4'> <div className='flex justify-between items-center'> <h2 className='text-xl font-semibold'>–ú–æ–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã</h2> <Button onClick={() => setIsAddingDocument(true)}> <Plus className='h-4 w-4 mr-2' /> –î–æ–±–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç </Button> </div> {documents.length === 0 ? ( <div className='text-center text-gray-500 py-8'> –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ </div> ) : ( documents.map(renderDocumentCard) )} {renderAddDocumentDialog()} </div> ); }; // Add DocumentsSection to your menu page layout where appropriate export default function MenuPage() { const [showProfile, setShowProfile] = useState<boolean>(false); const [isEditModalOpen, setIsEditModalOpen] = useState<boolean>(false); const [showLogoutConfirm, setShowLogoutConfirm] = useState<boolean>(false); const [formData, setFormData] = useState<Record<string, string>>({}); const [isUploading, setIsUploading] = useState<boolean>(false); const [isMobile, setIsMobile] = useState<boolean>(false); const [isLoading, setIsLoading] = useState<boolean>(true); const [isSaving, setIsSaving] = useState<boolean>(false); const router = useRouter(); const { userState, setUserRole, setLanguage, setUserType, logout } = useUser(); useEffect(() => { fetchUserProfile(); // Check if running in Telegram WebApp const isTelegramWebApp = window.Telegram?.WebApp; // Check viewport width for mobile const checkMobile = () => { setIsMobile(window.innerWidth < 768 || !!isTelegramWebApp); }; checkMobile(); window.addEventListener('resize', checkMobile); return () => window.removeEventListener('resize', checkMobile); }, []); const fetchUserProfile = async () => { try { setIsLoading(true); const userData = await api.getCurrentUser(); console.log(userData); setUserRole(userData.role); // if (userData.role === 'carrier' && userData.is_verified === false) { // router.push('driver-verification/'); // } setFormData(userData); console.log(formData); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–æ—Ñ–∏–ª—è'); console.error('Error fetching profile:', error); } finally { setIsLoading(false); } }; const handleInputChange = (key: string, value: string) => { setFormData((prev) => ({ ...prev, [key]: value })); }; const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => { const file = e.target.files?.[0]; if (!file) return; if (!file.type.startsWith('image/')) { toast.error('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ'); return; } if (file.size > 5 * 1024 * 1024) { toast.error('–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–≤—ã—à–∞—Ç—å 5MB'); return; } try { setIsUploading(true); // Here you would normally upload the file to your server // const formData = new FormData(); // formData.append('photo', file); // const response = await api.uploadProfilePhoto(formData); // For now, just create a local preview const previewUrl = URL.createObjectURL(file); setFormData((prev) => ({ ...prev, photo: previewUrl })); toast.success('–§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ'); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–æ—Ç–æ'); console.error('Error uploading photo:', error); } finally { setIsUploading(false); } }; const handleRemovePhoto = async () => { try { // Here you would normally call an API endpoint to remove the photo // await api.removeProfilePhoto(); setFormData((prev) => { const newData = { ...prev }; delete newData.photo; return newData; }); toast.success('–§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è —É–¥–∞–ª–µ–Ω–æ'); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ñ–æ—Ç–æ'); console.error('Error removing photo:', error); } }; const handleSaveProfile = async () => { try { setIsSaving(true); const data = { student_id: formData.telegram_id, ...formData }; console.log(data, 'data'); await api.updateProfile(data); setUserRole(formData?.role as UserRole); setUserType(formData.type as UserType); setLanguage(formData.preferred_language as Language); setIsEditModalOpen(false); toast.success('–ü—Ä–æ—Ñ–∏–ª—å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω'); fetchUserProfile(); // Refresh profile data } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è'); console.error('Error updating profile:', error); } finally { setIsSaving(false); } }; const handleLogout = () => { logout(); router.push('/'); toast.success('–í—ã —É—Å–ø–µ—à–Ω–æ –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã'); }; const getProfileFields = () => { return ( defaultProfiles[formData.role || 'carrier'] || defaultProfiles.carrier ); }; console.log(formData, 'formdataa'); const RoleIcon = getRoleIcon(userState.role || 'carrier'); const menuItems = [ { icon: Search, text: '–ü–æ–∏—Å–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏ —Å–ø–∏—Å–æ–∫ —Ñ–∏—Ä–º', action: () => router.push('/search'), }, { icon: MapPin, text: '–†–∞—Å—á–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π', action: () => router.push('/calculate-distance'), }, { icon: Heart, text: '–ò–∑–±—Ä–∞–Ω–Ω–æ–µ', action: () => router.push('/favorites') }, { icon: FileText, text: '–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏', action: () => router.push('/instructions'), }, { icon: HelpCircle, text: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞', action: () => router.push('/support'), }, { icon: Settings, text: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è', action: () => router.push('/settings'), }, { icon: MessageSquare, text: '–û—Ç–∑—ã–≤—ã', action: () => router.push('/reviews'), }, { icon: Gamepad, text: '–ò–≥—Ä–∞', action: () => router.push('/game'), }, ]; if (isLoading) { return ( <div className='min-h-screen flex items-center justify-center'> <Loader2 className='h-8 w-8 animate-spin text-primary' /> </div> ); } const renderProfileContent = () => ( <Card className='mt-4'> <CardContent className='p-4'> <div className='flex flex-col sm:flex-row items-center justify-between mb-6'> <div className='flex flex-col sm:flex-row items-center text-center sm:text-left'> <Avatar className='h-20 w-20 sm:h-16 sm:w-16 mb-4 sm:mb-0 sm:mr-4'> <img src={formData.photo || 'https://i.pravatar.cc/150'} alt={formData.full_name || '–ü—Ä–æ—Ñ–∏–ª—å'} className='object-cover' /> </Avatar> <div> <h2 className='text-xl sm:text-2xl font-bold mb-2 sm:mb-1'> {formData.full_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'} </h2> <div className='flex items-center justify-center sm:justify-start text-gray-600'> <RoleIcon className='h-4 w-4 mr-1' /> <span className='text-sm'> {formData.role || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'} </span> </div> <div className='flex items-center justify-center sm:justify-start text-gray-600'> <span className='text-sm'> {formData.is_verified ? '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω' : '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–µ –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω'}{' '} </span> </div> </div> </div> <Button variant='outline' size='sm' onClick={() => setIsEditModalOpen(true)} className='mt-4 sm:mt-0' > <Camera className='h-4 w-4 mr-2' /> –ò–∑–º–µ–Ω–∏—Ç—å </Button> </div> <Separator className='my-4' /> <ScrollArea className='h-[calc(100vh-400px)] sm:h-auto pr-4'> <div className='space-y-4'> {getProfileFields().map((field) => ( <div key={field.key} className='space-y-1'> <label className='text-sm font-medium text-gray-500'> {field.label} </label> <p className='text-base break-words'> {formData[field.key] || '‚Äî'} </p> </div> ))} </div> </ScrollArea> <Button variant='destructive' className='w-full mt-6' onClick={() => setShowLogoutConfirm(true)} > <LogOut className='h-5 w-5 mr-2' /> –í—ã–π—Ç–∏ </Button> </CardContent> </Card> ); return ( <div className='min-h-screen bg-gray-50 p-4 pb-20'> <div className='flex items-center mb-6'> <Button variant='ghost' onClick={() => router.back()} className='p-2'> <ArrowLeft className='h-6 w-6' /> </Button> <h1 className='text-xl sm:text-2xl font-bold ml-2'>–ú–µ–Ω—é</h1> </div> <div className='flex items-center justify-between mb-4'> <div className='flex items-center'> <Avatar className='h-12 w-12 mr-4'> <img src={formData.photo || 'https://i.pravatar.cc/150'} alt={formData.full_name || '–ü—Ä–æ—Ñ–∏–ª—å'} className='object-cover' /> </Avatar> <div> <p className='font-semibold'> {formData.full_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'} </p> <Button variant='link' className='p-0 h-auto text-sm' onClick={() => setShowProfile(!showProfile)} > –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç </Button> </div> </div> <Button variant='ghost' size='sm' onClick={() => setIsEditModalOpen(true)} className='p-2' > <ChevronRight className='h-5 w-5' /> </Button> </div> {showProfile ? ( renderProfileContent() ) : ( <div className='space-y-2'> {menuItems.map((item, index) => ( <Button key={index} variant='ghost' className='w-full justify-start p-4 h-auto text-left' onClick={item.action} > <item.icon className='h-5 w-5 mr-3 flex-shrink-0' /> <span className='line-clamp-1'>{item.text}</span> </Button> ))} </div> )} <Dialog open={isEditModalOpen} onOpenChange={setIsEditModalOpen}> <DialogContent className={`${ isMobile ? 'w-full h-[100vh] max-w-none m-0 rounded-none' : 'sm:max-w-[425px]' } overflow-hidden flex flex-col`} > <DialogHeader className='px-4 py-3'> <DialogTitle>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</DialogTitle> </DialogHeader> <ScrollArea className='flex-grow px-4'> <div className='space-y-4 py-4'> <div className='flex flex-col items-center justify-center mb-6'> <Avatar className='h-24 w-24 mb-4'> <img src={formData.photo || 'https://i.pravatar.cc/150'} alt={formData.full_name || '–ü—Ä–æ—Ñ–∏–ª—å'} className='object-cover' /> </Avatar> <div className='space-y-2 w-full flex flex-col items-center'> <div className='relative w-full'> <Input type='file' accept='image/*' onChange={handleImageUpload} className='hidden' id='photo-upload' /> <Button variant='outline' size='sm' disabled={isUploading} onClick={() => document.getElementById('photo-upload')?.click() } className='w-full' > <Camera className='h-4 w-4 mr-2' /> {isUploading ? '–ó–∞–≥—Ä—É–∑–∫–∞...' : '–ò–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ç–æ'} </Button> </div> <Button variant='outline' size='sm' onClick={handleRemovePhoto} disabled={!formData.photo} className='w-full' > <Trash2 className='h-4 w-4 mr-2' /> –£–¥–∞–ª–∏—Ç—å —Ñ–æ—Ç–æ </Button> </div> </div> {getProfileFields().map((field) => ( <div key={field.key} className='space-y-2'> <label className='text-sm font-medium'> {field.label} {field.required && ( <span className='text-red-500 ml-1'>*</span> )} </label> <Input type={field.type} value={formData[field.key] || ''} onChange={(e) => handleInputChange(field.key, e.target.value) } required={field.required} className='w-full' placeholder={`–í–≤–µ–¥–∏—Ç–µ ${field.label.toLowerCase()}`} /> </div> ))} </div> </ScrollArea> <DialogFooter className='px-4 py-3 mt-2 border-t'> <div className={`flex ${ isMobile ? 'flex-col w-full gap-2' : 'flex-row gap-4' }`} > <Button variant='outline' onClick={() => setIsEditModalOpen(false)} className={isMobile ? 'w-full' : ''} disabled={isSaving} > –û—Ç–º–µ–Ω–∞ </Button> <Button onClick={handleSaveProfile} className={isMobile ? 'w-full' : ''} disabled={isSaving} > {isSaving ? ( <> <Loader2 className='h-4 w-4 mr-2 animate-spin' /> –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ... </> ) : ( '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å' )} </Button> </div> </DialogFooter> </DialogContent> </Dialog> <DocumentsSection /> <Dialog open={showLogoutConfirm} onOpenChange={setShowLogoutConfirm}> <DialogContent className={`${ isMobile ? 'w-[95%] max-w-[95%] mx-auto' : 'sm:max-w-[425px]' }`} > <DialogHeader> <DialogTitle>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞</DialogTitle> </DialogHeader> <p className='py-4'>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?</p> <DialogFooter className={`${isMobile ? 'flex-col gap-2' : ''}`}> <Button variant='outline' onClick={() => setShowLogoutConfirm(false)} className={isMobile ? 'w-full' : ''} > –û—Ç–º–µ–Ω–∞ </Button> <Button variant='destructive' onClick={handleLogout} className={isMobile ? 'w-full' : ''} > –í—ã–π—Ç–∏ </Button> </DialogFooter> </DialogContent> </Dialog> <NavigationMenu userRole={userState.role === 'carrier' ? 'carrier' : 'other'} /> </div> ); }
```

# app\my-cargo\page.tsx

```tsx
// 'use client'; // import React, { useState } from 'react'; // import { Button } from '@/components/ui/button'; // import { Card, CardContent } from '@/components/ui/card'; // import { Badge } from '@/components/ui/badge'; // import { // TruckIcon, // EyeIcon, // PencilIcon, // PowerIcon, // PlusIcon, // } from 'lucide-react'; // import NavigationMenu from '../components/NavigationMenu'; // import { ScrollArea } from '@/components/ui/scroll-area'; // interface Cargo { // id: string; // name: string; // route: string; // weight: string; // volume: string; // isActive: boolean; // } // export default function MyCargoPage() { // const [activeTab, setActiveTab] = useState<'active' | 'inactive'>('active'); // const [cargos, setCargos] = useState<Cargo[]>([ // { // id: '1', // name: '–ú–µ—Ç–∞–ª–ª', // route: '–ú–æ—Å–∫–≤–∞ - –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥', // weight: '20 —Ç–æ–Ω–Ω', // volume: '40 –º¬≥', // isActive: true, // }, // // –î–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ –≥—Ä—É–∑–æ–≤ –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ // ]); // const activeCargos = cargos.filter((cargo) => cargo.isActive); // const inactiveCargos = cargos.filter((cargo) => !cargo.isActive); // const handleDeactivate = (id: string) => { // setCargos( // cargos.map((cargo) => // cargo.id === id ? { ...cargo, isActive: false } : cargo // ) // ); // }; // const renderCargoCard = (cargo: Cargo) => ( // <Card key={cargo.id} className='mb-4'> // <CardContent className='p-4'> // <div className='flex justify-between items-start mb-2'> // <h3 className='font-semibold'>{cargo.name}</h3> // <Badge variant={cargo.isActive ? 'default' : 'secondary'}> // {cargo.isActive ? '–ê–∫—Ç–∏–≤–Ω—ã–π' : '–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–π'} // </Badge> // </div> // <p className='text-sm text-gray-600 mb-2'>{cargo.route}</p> // <p className='text-sm text-gray-600 mb-4'> // {cargo.weight}, {cargo.volume} // </p> // <div className='flex justify-between'> // <Button variant='outline' size='sm'> // <EyeIcon className='h-4 w-4 mr-2' /> // –ü–æ–∫–∞–∑–∞—Ç—å // </Button> // <Button variant='outline' size='sm'> // <PencilIcon className='h-4 w-4 mr-2' /> // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å // </Button> // {cargo.isActive && ( // <Button // variant='outline' // size='sm' // onClick={() => handleDeactivate(cargo.id)} // > // <PowerIcon className='h-4 w-4 mr-2' /> // –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å // </Button> // )} // </div> // </CardContent> // </Card> // ); // return ( // <div className='min-h-screen bg-gray-100 p-4 pb-24'> // <h1 className='text-3xl font-bold text-center mb-6'>–ú–æ–∏ –≥—Ä—É–∑—ã</h1> // <div className='flex mb-4'> // <Button // variant={activeTab === 'active' ? 'default' : 'outline'} // className='flex-1 mr-2' // onClick={() => setActiveTab('active')} // > // –ê–∫—Ç–∏–≤–Ω—ã–µ{' '} // <Badge variant='secondary' className='ml-2'> // {activeCargos.length} // </Badge> // </Button> // <Button // variant={activeTab === 'inactive' ? 'default' : 'outline'} // className='flex-1' // onClick={() => setActiveTab('inactive')} // > // –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ{' '} // <Badge variant='secondary' className='ml-2'> // {inactiveCargos.length} // </Badge> // </Button> // </div> // <ScrollArea className='h-[calc(100vh-250px)]'> // {cargos.length === 1 && cargos[0].isActive && ( // <div // className='bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-4' // role='alert' // > // <p className='font-bold'>–£—Å–ø–µ—Ö!</p> // <p>–í–∞—à –≥—Ä—É–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω –∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω.</p> // </div> // )} // {activeTab === 'active' // ? activeCargos.map(renderCargoCard) // : inactiveCargos.map(renderCargoCard)} // </ScrollArea> // <div className='fixed bottom-20 left-4 right-4'> // <Button // className='w-full' // onClick={() => { // /* Navigate to add cargo page */ // }} // > // <PlusIcon className='h-4 w-4 mr-2' /> // –î–æ–±–∞–≤–∏—Ç—å –µ—â–µ –≥—Ä—É–∑ // </Button> // </div> // <p className='text-sm text-gray-600 italic mt-4 mb-16 text-center'> // –•–æ—Ç–∏–º –Ω–∞–ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∑–∞—è–≤–∫—É –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π // —Å–¥–µ–ª–∫–∏. // </p> // <NavigationMenu userRole={'carrier'} /> // </div> // ); // } // app/my-cargo/page.tsx 'use client'; import React, { useState, useEffect } from 'react'; import { Button } from '@/components/ui/button'; import { Card, CardContent } from '@/components/ui/card'; import { Badge } from '@/components/ui/badge'; import { ScrollArea } from '@/components/ui/scroll-area'; import { EyeIcon, PencilIcon, PowerIcon, PlusIcon, Loader2, } from 'lucide-react'; import NavigationMenu from '../components/NavigationMenu'; import { useUser } from '@/contexts/UserContext'; import { api } from '@/lib/api'; import { toast } from 'sonner'; import { useRouter } from 'next/navigation'; interface CargoResponse { results: Cargo[]; } interface Cargo { id: string; title: string; status: string; loading_point: string; unloading_point: string; weight: number; vehicle_type: string; payment_method: string; price?: number; loading_date: string; created_at: string; } export default function MyCargoPage() { const [activeTab, setActiveTab] = useState<'active' | 'inactive'>('active'); const [cargos, setCargos] = useState<CargoResponse>({ results: [] }); const [isLoading, setIsLoading] = useState(true); const [actionInProgress, setActionInProgress] = useState<string | null>(null); const { userState } = useUser(); const router = useRouter(); useEffect(() => { fetchCargos(); }, []); const fetchCargos = async () => { try { setIsLoading(true); const response = await api.getCargos(); setCargos(response); console.log(response, 'cargos'); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≥—Ä—É–∑–æ–≤'); console.error('Fetch cargos error:', error); } finally { setIsLoading(false); } }; const handleStatusChange = async (id: string, status: string) => { try { setActionInProgress(id); await api.updateCargo(id, { status }); toast.success('–°—Ç–∞—Ç—É—Å –≥—Ä—É–∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω'); await fetchCargos(); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞'); console.error('Update status error:', error); } finally { setActionInProgress(null); } }; const getStatusBadgeVariant = (status: string) => { switch (status) { case 'active': case 'pending': return 'default'; case 'completed': return 'secondary'; case 'cancelled': return 'destructive'; default: return 'secondary'; } }; const getStatusLabel = (status: string) => { const labels: Record<string, string> = { active: '–ê–∫—Ç–∏–≤–Ω—ã–π', pending: '–û–∂–∏–¥–∞–µ—Ç', completed: '–ó–∞–≤–µ—Ä—à–µ–Ω', cancelled: '–û—Ç–º–µ–Ω–µ–Ω', draft: '–ß–µ—Ä–Ω–æ–≤–∏–∫', inactive: '–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–π', }; return labels[status] || status; }; const activeCargos = cargos?.results?.filter((cargo) => ['active', 'pending', 'draft'].includes(cargo.status) ); const inactiveCargos = cargos?.results?.filter((cargo) => ['completed', 'cancelled', 'inactive'].includes(cargo.status) ); const handleView = (id: string) => { router.push(`/cargo/${id}`); }; const handleEdit = (id: string) => { router.push(`/cargo/${id}/edit`); }; const renderCargoCard = (cargo: Cargo) => ( <Card key={cargo.id} className='mb-4'> <CardContent className='p-4'> <div className='flex justify-between items-start mb-2'> <h3 className='font-semibold'>{cargo.title}</h3> <Badge variant={getStatusBadgeVariant(cargo.status)}> {getStatusLabel(cargo.status)} </Badge> </div> <p className='text-sm text-gray-600 mb-2'> {cargo.loading_point} - {cargo.unloading_point} </p> <p className='text-sm text-gray-600 mb-4'> {cargo.weight} —Ç, {cargo.vehicle_type} {cargo.price && `, ${cargo.price} ‚ÇΩ`} </p> <div className='flex justify-between'> <Button variant='outline' size='sm' onClick={() => handleView(cargo.id)} > <EyeIcon className='h-4 w-4 mr-2' /> –ü–æ–∫–∞–∑–∞—Ç—å </Button> <Button variant='outline' size='sm' onClick={() => handleEdit(cargo.id)} > <PencilIcon className='h-4 w-4 mr-2' /> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å </Button> {cargo.status === 'active' && ( <Button variant='outline' size='sm' onClick={() => handleStatusChange(cargo.id, 'inactive')} disabled={actionInProgress === cargo.id} > {actionInProgress === cargo.id ? ( <Loader2 className='h-4 w-4 mr-2 animate-spin' /> ) : ( <PowerIcon className='h-4 w-4 mr-2' /> )} –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å </Button> )} </div> </CardContent> </Card> ); if (isLoading) { return ( <div className='min-h-screen bg-gray-100 p-4 flex items-center justify-center'> <Loader2 className='h-8 w-8 animate-spin text-blue-600' /> </div> ); } return ( <div className='min-h-screen bg-gray-100 p-4 pb-24'> <h1 className='text-3xl font-bold text-center mb-6'>–ú–æ–∏ –≥—Ä—É–∑—ã</h1> <div className='flex mb-4'> <Button variant={activeTab === 'active' ? 'default' : 'outline'} className='flex-1 mr-2' onClick={() => setActiveTab('active')} > –ê–∫—Ç–∏–≤–Ω—ã–µ <Badge variant='secondary' className='ml-2'> {activeCargos?.length} </Badge> </Button> <Button variant={activeTab === 'inactive' ? 'default' : 'outline'} className='flex-1' onClick={() => setActiveTab('inactive')} > –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ <Badge variant='secondary' className='ml-2'> {inactiveCargos?.length} </Badge> </Button> </div> <ScrollArea className='h-[calc(100vh-250px)]'> {activeTab === 'active' ? activeCargos?.map(renderCargoCard) : inactiveCargos?.map(renderCargoCard)} {((activeTab === 'active' && activeCargos?.length === 0) || (activeTab === 'inactive' && inactiveCargos?.length === 0)) && ( <div className='text-center text-gray-500 mt-8'> –ù–µ—Ç {activeTab === 'active' ? '–∞–∫—Ç–∏–≤–Ω—ã—Ö' : '–Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö'} –≥—Ä—É–∑–æ–≤ </div> )} </ScrollArea> <div className='fixed bottom-20 left-4 right-4'> <Button className='w-full' onClick={() => router.push('/cargos')}> <PlusIcon className='h-4 w-4 mr-2' /> –î–æ–±–∞–≤–∏—Ç—å –µ—â–µ –≥—Ä—É–∑ </Button> </div> <NavigationMenu userRole={userState.role === 'carrier' ? 'carrier' : 'other'} /> </div> ); }
```

# app\my-cars\page.tsx

```tsx
// 'use client'; // import React, { useState } from 'react'; // import { Button } from "@/components/ui/button"; // import { Input } from "@/components/ui/input"; // import { Card, CardContent } from "@/components/ui/card"; // import { Badge } from "@/components/ui/badge"; // import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select"; // import { PlusIcon, FileIcon, Edit2Icon, TrashIcon, ChevronDown, ChevronUp } from 'lucide-react'; // import NavigationMenu from '../components/NavigationMenu'; // interface Vehicle { // id: string; // techPassport1: string; // techPassport2: string; // techPassport1Image: string | null; // techPassport2Image: string | null; // bodyType: string; // capacity: string; // volume: string; // cmr: boolean; // license: string; // dimensions: { // length: string; // width: string; // height: string; // }; // adr: boolean; // dozvol: boolean; // tir: boolean; // licenseFile?: File; // } // type PartialVehicle = { // id?: string; // techPassport1?: string; // techPassport2?: string; // techPassport1Image?: string | null; // techPassport2Image?: string | null; // bodyType?: string; // capacity?: string; // volume?: string; // cmr?: boolean; // license?: string; // dimensions: { // length: string; // width: string; // height: string; // }; // adr?: boolean; // dozvol?: boolean; // tir?: boolean; // licenseFile?: File; // }; // const bodyTypes = [ // '–¢–µ–Ω—Ç', // '–†–µ—Ñ—Ä–∏–∂–µ—Ä–∞—Ç–æ—Ä', // '–ò–∑–æ—Ç–µ—Ä–º', // '–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä', // '–ê–≤—Ç–æ–≤–æ–∑', // '–ë–æ—Ä—Ç–æ–≤–æ–π', // ]; // const AddVehicleForm: React.FC<{ onSave: (vehicle: Vehicle) => void; onCancel: () => void }> = ({ onSave, onCancel }) => { // const [formData, setFormData] = useState<PartialVehicle>({ // dimensions: { length: '', width: '', height: '' }, // techPassport1Image: null, // techPassport2Image: null // }); // const handleInputChange = (name: string, value: string | boolean) => { // if (name.startsWith('dimensions.')) { // const dimension = name.split('.')[1] as keyof typeof formData.dimensions; // setFormData(prev => ({ // ...prev, // dimensions: { // ...prev.dimensions, // [dimension]: value as string // } // })); // } else { // setFormData(prev => ({ // ...prev, // [name]: value // })); // } // }; // const handleImageUpload = (e: React.ChangeEvent<HTMLInputElement>, side: 'techPassport1Image' | 'techPassport2Image') => { // const file = e.target.files?.[0]; // if (file) { // const reader = new FileReader(); // reader.onloadend = () => { // if (typeof reader.result === 'string') { // setFormData(prev => ({ // ...prev, // [side]: reader.result // })); // } // }; // reader.readAsDataURL(file); // } // }; // const handleFileUpload = (e: React.ChangeEvent<HTMLInputElement>, fieldName: string) => { // const file = e.target.files?.[0]; // if (file) { // setFormData(prev => ({ ...prev, [fieldName]: file })); // } // }; // const handleSubmit = (e: React.FormEvent) => { // e.preventDefault(); // onSave(formData as Vehicle); // }; // return ( // <form onSubmit={handleSubmit} className="space-y-4 bg-white p-6 rounded-lg shadow"> // <h2 className="text-2xl font-bold mb-6">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—à–∏–Ω—ã</h2> // <div className="grid grid-cols-1 md:grid-cols-2 gap-4"> // <div> // <label className="block text-sm font-medium mb-2 text-gray-700">–¢–µ—Ö. –ø–∞—Å–ø–æ—Ä—Ç (—Å—Ç—Ä. 1)</label> // <Input // type="file" // accept="image/*" // onChange={(e) => handleImageUpload(e, 'techPassport1Image')} // className="file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100" // /> // {formData.techPassport1Image && ( // <img // src={formData.techPassport1Image} // alt="Tech Passport Front" // className="mt-2 max-h-40 rounded-lg shadow" // /> // )} // </div> // <div> // <label className="block text-sm font-medium mb-2 text-gray-700">–¢–µ—Ö. –ø–∞—Å–ø–æ—Ä—Ç (—Å—Ç—Ä. 2)</label> // <Input // type="file" // accept="image/*" // onChange={(e) => handleImageUpload(e, 'techPassport2Image')} // className="file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100" // /> // {formData.techPassport2Image && ( // <img // src={formData.techPassport2Image} // alt="Tech Passport Back" // className="mt-2 max-h-40 rounded-lg shadow" // /> // )} // </div> // </div> // <div> // <label className="block text-sm font-medium mb-1">–¢–∏–ø –∫—É–∑–æ–≤–∞</label> // <Select onValueChange={(value) => handleInputChange('bodyType', value)}> // <SelectTrigger> // <SelectValue placeholder="–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫—É–∑–æ–≤–∞" /> // </SelectTrigger> // <SelectContent> // {bodyTypes.map(type => ( // <SelectItem key={type} value={type}>{type}</SelectItem> // ))} // </SelectContent> // </Select> // </div> // <div className="grid grid-cols-2 gap-4"> // <div> // <label className="block text-sm font-medium mb-1">–ì—Ä—É–∑–æ–ø–æ–¥—ä–µ–º–Ω–æ—Å—Ç—å (—Ç–æ–Ω–Ω)</label> // <Input // type="number" // required // onChange={(e) => handleInputChange('capacity', e.target.value)} // /> // </div> // <div> // <label className="block text-sm font-medium mb-1">–û–±—ä–µ–º (–º¬≥)</label> // <Input // type="number" // required // onChange={(e) => handleInputChange('volume', e.target.value)} // /> // </div> // </div> // <div> // <label className="block text-sm font-medium mb-1">–õ–∏—Ü–µ–Ω–∑–∏—è</label> // <Input // type="file" // accept=".pdf,.doc,.docx" // onChange={(e) => handleFileUpload(e, 'licenseFile')} // className="file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100" // /> // </div> // <div> // <label className="block text-sm font-medium mb-2">–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –≥–∞–±–∞—Ä–∏—Ç—ã –∫—É–∑–æ–≤–∞ (–º)</label> // <div className="grid grid-cols-3 gap-4"> // <Input // placeholder="–î–ª–∏–Ω–∞" // type="number" // step="0.1" // required // onChange={(e) => handleInputChange('dimensions.length', e.target.value)} // /> // <Input // placeholder="–®–∏—Ä–∏–Ω–∞" // type="number" // step="0.1" // required // onChange={(e) => handleInputChange('dimensions.width', e.target.value)} // /> // <Input // placeholder="–í—ã—Å–æ—Ç–∞" // type="number" // step="0.1" // required // onChange={(e) => handleInputChange('dimensions.height', e.target.value)} // /> // </div> // </div> // <div className="grid grid-cols-3 gap-4"> // <div className="flex items-center"> // <input // type="checkbox" // id="adr" // className="mr-2" // onChange={(e) => handleInputChange('adr', e.target.checked)} // /> // <label htmlFor="adr">–ê–î–†</label> // </div> // <div className="flex items-center"> // <input // type="checkbox" // id="dozvol" // className="mr-2" // onChange={(e) => handleInputChange('dozvol', e.target.checked)} // /> // <label htmlFor="dozvol">–î–æ–∑–≤–æ–ª</label> // </div> // <div className="flex items-center"> // <input // type="checkbox" // id="tir" // className="mr-2" // onChange={(e) => handleInputChange('tir', e.target.checked)} // /> // <label htmlFor="tir">–¢–ò–†</label> // </div> // </div> // <div className="flex justify-end space-x-4 mt-6"> // <Button variant="outline" onClick={onCancel}> // –û—Ç–º–µ–Ω–∞ // </Button> // <Button type="submit"> // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å // </Button> // </div> // </form> // ); // }; // const VehicleCard: React.FC<{ vehicle: Vehicle }> = ({ vehicle }) => { // const [isExpanded, setIsExpanded] = useState(false); // return ( // <Card className="bg-white"> // <CardContent className="p-4"> // <div className="flex justify-between items-start mb-4"> // <div> // <h3 className="font-bold text-lg">{vehicle.bodyType}</h3> // <p className="text-sm text-gray-600">{vehicle.capacity} —Ç / {vehicle.volume} –º¬≥</p> // </div> // <div className="flex space-x-2"> // {vehicle.adr && <Badge>–ê–î–†</Badge>} // {vehicle.dozvol && <Badge>–î–æ–∑–≤–æ–ª</Badge>} // {vehicle.tir && <Badge>–¢–ò–†</Badge>} // </div> // </div> // {isExpanded && ( // <div className="space-y-2 text-sm"> // <div className="grid grid-cols-1 md:grid-cols-2 gap-4"> // {vehicle.techPassport1Image && ( // <img src={vehicle.techPassport1Image} alt="Tech Passport Front" className="max-h-40 rounded-lg shadow" /> // )} // {vehicle.techPassport2Image && ( // <img src={vehicle.techPassport2Image} alt="Tech Passport Back" className="max-h-40 rounded-lg shadow" /> // )} // </div> // <p>–†–∞–∑–º–µ—Ä—ã: {vehicle.dimensions.length}x{vehicle.dimensions.width}x{vehicle.dimensions.height} –º</p> // {vehicle.licenseFile && ( // <p className="flex items-center"> // <FileIcon className="h-4 w-4 mr-2" /> // –õ–∏—Ü–µ–Ω–∑–∏—è // </p> // )} // </div> // )} // <div className="flex justify-between mt-4"> // <Button // variant="ghost" // size="sm" // onClick={() => setIsExpanded(!isExpanded)} // > // {isExpanded ? <ChevronUp className="h-4 w-4 mr-1" /> : <ChevronDown className="h-4 w-4 mr-1" />} // {isExpanded ? '–°–∫—Ä—ã—Ç—å' : '–ü–æ–¥—Ä–æ–±–Ω–µ–µ'} // </Button> // <div className="space-x-2"> // <Button variant="outline" size="sm"> // <Edit2Icon className="h-4 w-4 mr-1" /> // –ò–∑–º–µ–Ω–∏—Ç—å // </Button> // <Button variant="outline" size="sm" className="text-red-600"> // <TrashIcon className="h-4 w-4 mr-1" /> // –£–¥–∞–ª–∏—Ç—å // </Button> // </div> // </div> // </CardContent> // </Card> // ); // }; // export default function MyVehiclesPage() { // const [isAddingVehicle, setIsAddingVehicle] = useState(false); // const [vehicles, setVehicles] = useState<Vehicle[]>([]); // const handleSaveVehicle = (vehicle: Vehicle) => { // setVehicles([...vehicles, { ...vehicle, id: Date.now().toString() }]); // setIsAddingVehicle(false); // }; // return ( // <div className="min-h-screen bg-blue-600 p-4 pb-20"> // <h1 className="text-2xl font-bold text-white text-center mb-6"> // –ú–æ–∏ –º–∞—à–∏–Ω—ã –∏ –∑–∞—è–≤–∫–∏ // </h1> // {!isAddingVehicle && vehicles.length === 0 && ( // <div className="flex flex-col items-center justify-center space-y-4 mt-10"> // <Button // className="w-64 h-12" // onClick={() => setIsAddingVehicle(true)} // > // <PlusIcon className="h-5 w-5 mr-2" /> // –î–æ–±–∞–≤–∏—Ç—å –º–∞—à–∏–Ω—É // </Button> // <Button className="w-64 h-12"> // <PlusIcon className="h-5 w-5 mr-2" /> // –î–æ–±–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É // </Button> // </div> // )} // {isAddingVehicle && ( // <AddVehicleForm // onSave={handleSaveVehicle} // onCancel={() => setIsAddingVehicle(false)} // /> // )} // {vehicles.length > 0 && ( // <div className="space-y-4 mb-20"> // {vehicles.map(vehicle => ( // <VehicleCard key={vehicle.id} vehicle={vehicle} /> // ))} // <div className="flex justify-center space-x-4 mt-6"> // <Button onClick={() => setIsAddingVehicle(true)}> // –î–æ–±–∞–≤–∏—Ç—å –µ—â—ë // </Button> // <Button> // –î–æ–±–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É // </Button> // </div> // </div> // )} // <NavigationMenu userRole="carrier" /> // </div> // ); // } // app/my-cars/page.tsx 'use client'; import React, { useState, useEffect } from 'react'; import { Button } from '@/components/ui/button'; import { Input } from '@/components/ui/input'; import { Card, CardContent } from '@/components/ui/card'; import { Avatar } from '@/components/ui/avatar'; import { Dialog, DialogContent, DialogHeader, DialogTitle, } from '@/components/ui/dialog'; import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue, } from '@/components/ui/select'; import { Checkbox } from '@/components/ui/checkbox'; import { ScrollArea } from '@/components/ui/scroll-area'; import { Badge } from '@/components/ui/badge'; import { FileUpload } from '@/components/FileUpload'; import { Camera, FileIcon, Edit2Icon, Trash2Icon, Plus, Loader2, ChevronDown, ChevronUp, } from 'lucide-react'; import NavigationMenu from '../components/NavigationMenu'; import { useRouter } from 'next/navigation'; import { api } from '@/lib/api'; import { ApiClient } from '@/lib/api'; import { toast } from 'sonner'; import { useUser } from '@/contexts/UserContext'; interface VehicleResponse { results: Vehicle[]; } interface CarrierRequestResponse { results: CarrierRequest[]; } interface Vehicle { id: string; registration_number: string; body_type: string; loading_type: string; capacity: number; volume: number; length: number; width: number; height: number; registration_country: string; adr: boolean; dozvol: boolean; tir: boolean; license_number?: string; is_active: boolean; is_verified: boolean; documents: VehicleDocument[]; } interface VehicleDocument { id: string; type: string; title: string; file: string; expiry_date?: string; verified: boolean; } interface CarrierRequest { id: string; loading_point: string; unloading_point: string; ready_date: string; vehicle: any; vehicle_count: number; price_expectation?: number; payment_terms?: string; notes?: string; status: | 'pending' | 'assigned' | 'accepted' | 'rejected' | 'completed' | 'cancelled'; } const bodyTypes = [ { value: 'tent', label: '–¢–µ–Ω—Ç–æ–≤–∞–Ω–Ω—ã–π' }, { value: 'refrigerator', label: '–†–µ—Ñ—Ä–∏–∂–µ—Ä–∞—Ç–æ—Ä' }, { value: 'isothermal', label: '–ò–∑–æ—Ç–µ—Ä–º–∏—á–µ—Å–∫–∏–π' }, { value: 'container', label: '–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä' }, { value: 'car_carrier', label: '–ê–≤—Ç–æ–≤–æ–∑' }, { value: 'board', label: '–ë–æ—Ä—Ç–æ–≤–æ–π' }, ]; const loadingTypes = [ { value: 'ramps', label: '–ê–ø–ø–∞—Ä–µ–ª–∏' }, { value: 'no_doors', label: '–ë–µ–∑ –≤–æ—Ä–æ—Ç' }, { value: 'side', label: '–ë–æ–∫–æ–≤–∞—è' }, { value: 'top', label: '–í–µ—Ä—Ö–Ω—è—è' }, { value: 'hydro_board', label: '–ì–∏–¥—Ä–æ–±–æ—Ä—Ç' }, ]; const countries = [ { value: 'UZ', label: '–£–∑–±–µ–∫–∏—Å—Ç–∞–Ω' }, { value: 'RU', label: '–†–æ—Å—Å–∏—è' }, { value: 'KZ', label: '–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω' }, ]; const initialVehicleForm = { id: '', registration_number: '', body_type: '', loading_type: '', capacity: 0, volume: 0, length: 0, width: 0, height: 0, registration_country: '', adr: false, dozvol: false, tir: false, license_number: '', }; const initialCarrierRequestForm = { loading_point: '', unloading_point: '', ready_date: '', vehicle: '', vehicle_count: 1, price_expectation: undefined, payment_terms: '', notes: '', }; interface DocumentFormData { file: File; type: | 'tech_passport' | 'license' | 'insurance' | 'adr_cert' | 'dozvol' | 'tir' | 'other'; title: string; expiry_date?: string; } const documentTypes = [ { value: 'tech_passport', label: '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–∞—Å–ø–æ—Ä—Ç', required: true }, { value: 'license', label: '–í–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∞', required: false }, { value: 'insurance', label: '–°—Ç—Ä–∞—Ö–æ–≤–∫–∞', required: true }, { value: 'adr_cert', label: 'ADR —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç', required: false }, { value: 'dozvol', label: 'DOZVOL', required: false }, { value: 'tir', label: 'TIR', required: false }, { value: 'other', label: '–î—Ä—É–≥–æ–µ', required: false }, ] as const; // const documentTypes = [ // { value: 'tech_passport', label: '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–∞—Å–ø–æ—Ä—Ç' }, // { value: 'driver_license', label: '–í–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∞' }, // { value: 'insurance', label: '–°—Ç—Ä–∞—Ö–æ–≤–∫–∞' }, // { value: 'adr_cert', label: 'ADR —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç' }, // { value: 'dozvol', label: 'DOZVOL' }, // { value: 'tir', label: 'TIR' }, // ]; export default function MyVehiclesPage() { const [vehicles, setVehicles] = useState<VehicleResponse>({ results: [] }); // const [vehicles, setVehicles] = useState<Vehicle[]>([]); const [carrierRequests, setCarrierRequests] = useState<CarrierRequestResponse>({ results: [] }); const [isLoading, setIsLoading] = useState(true); const [isAddingVehicle, setIsAddingVehicle] = useState(false); const [isAddingRequest, setIsAddingRequest] = useState(false); const [selectedVehicle, setSelectedVehicle] = useState<Vehicle | null>(null); const [expandedVehicle, setExpandedVehicle] = useState<string | null>(null); const [isSubmitting, setIsSubmitting] = useState(false); const [vehicleForm, setVehicleForm] = useState(initialVehicleForm); const [requestForm, setRequestForm] = useState(initialCarrierRequestForm); const [documents, setDocuments] = useState<DocumentFormData[]>([]); // const [documents, setDocuments] = useState<{ type: string; file: File }[]>( // [] // ); const { userState } = useUser(); const router = useRouter(); useEffect(() => { fetchVehicles(); fetchCarrierRequests(); }, []); const fetchVehicles = async () => { try { setIsLoading(true); const response = await api.getVehicles(); setVehicles(response); console.log(response, 'res'); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞'); console.error('Fetch vehicles error:', error); } finally { setIsLoading(false); } }; const fetchCarrierRequests = async () => { try { const response = await api.get('/cargo/carrier-requests/'); setCarrierRequests(response); console.log(response, 'res'); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∑–∞—è–≤–æ–∫'); console.error('Fetch carrier requests error:', error); } }; const handleVehicleSubmit = async () => { try { setIsSubmitting(true); if (selectedVehicle) { // Check required documents const requiredDocs = documentTypes.filter((dt) => dt.required); const missingDocs = requiredDocs.filter( (dt) => !documents.some((d) => d.type === dt.value) ); if (missingDocs.length > 0) { toast.error( `–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã: ${missingDocs .map((d) => d.label) .join(', ')}` ); return; } const vehicleResponse = await api.updateVehicle( vehicleForm.id, vehicleForm ); console.log(vehicleResponse, 'vehres'); const vehicleId = vehicleResponse?.id; console.log(vehicleResponse, 'vehres'); console.log(vehicleId, 'id'); // Upload documents const documentsUploaded = await handleDocumentUpload( vehicleForm.id, documents ); if (!documentsUploaded) { throw new Error('Failed to upload documents'); } // Upload documents // for (const doc of documents) { // const formData = new FormData(); // formData.append('file', doc.file); // formData.append('type', doc.type); // formData.append('vehicle', vehicleId); // const documents = await api.post( // `/vehicles/${vehicleForm.id}/documents/`, // formData // ); // console.log(documents, 'documents'); // } } else { const vehicleResponse = await api.createVehicle(vehicleForm); // Create vehicle console.log(vehicleResponse, 'vehres'); // const vehicleId = vehicleResponse?.id; // console.log(vehicleResponse, 'vehres'); // console.log(vehicleId, 'id'); // Upload documents // const documentsUploaded = await handleDocumentUpload( // vehicleId, // documents // ); // if (!documentsUploaded) { // throw new Error('Failed to upload documents'); // } // // Upload documents // for (const doc of documents) { // const formData = new FormData(); // formData.append('file', doc.file); // formData.append('type', doc.type); // formData.append('vehicle', vehicleId); // const documents = await api.post( // `/vehicles/${vehicleId}/documents/`, // formData // ); // console.log(documents, 'documents'); // } // .then((res) => console.log(res)) // .catch((err) => console.log(err, 'document errror')); } toast.success('–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω'); setIsAddingVehicle(false); setVehicleForm(initialVehicleForm); setDocuments([]); fetchVehicles(); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞'); console.error('Add vehicle error:', error); } finally { setIsSubmitting(false); } }; const handleRequestSubmit = async () => { try { setIsSubmitting(true); await api.post('/cargo/carrier-requests/', requestForm); toast.success('–ó–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞'); setIsAddingRequest(false); setRequestForm(initialCarrierRequestForm); fetchCarrierRequests(); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏'); console.error('Add request error:', error); } finally { setIsSubmitting(false); } }; // Update document upload handler const handleDocumentUpload = async ( vehicleId: string, documents: DocumentFormData[] ) => { try { for (const doc of documents) { await api.addVehicleDocument(vehicleId, { file: doc.file, type: doc.type, title: doc.title, expiry_date: doc.expiry_date, }); } return true; } catch (error) { console.error('Upload documents error:', error); return false; } }; // const handleDocumentUpload = (file: File, type: string) => { // setDocuments((prev) => [...prev, { file, type }]); // }; const handleVehicleInputChange = (name: string, value: any) => { setVehicleForm((prev) => { const updated = { ...prev, [name]: value }; // Calculate volume if dimensions are provided if (['length', 'width', 'height'].includes(name)) { if (updated.length && updated.width && updated.height) { updated.volume = updated.length * updated.width * updated.height; } } return updated; }); }; const handleRequestInputChange = (name: string, value: any) => { setRequestForm((prev) => ({ ...prev, [name]: value, })); }; const renderVehicleForm = () => ( <div className='space-y-4'> <div> <label className='block text-sm font-medium mb-2'>–ì–æ—Å. –Ω–æ–º–µ—Ä*</label> <Input value={vehicleForm.registration_number} onChange={(e) => handleVehicleInputChange('registration_number', e.target.value) } placeholder='–í–≤–µ–¥–∏—Ç–µ –≥–æ—Å. –Ω–æ–º–µ—Ä' /> </div> <div> <label className='block text-sm font-medium mb-2'> –°—Ç—Ä–∞–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏* </label> <Select value={vehicleForm.registration_country} onValueChange={(value) => handleVehicleInputChange('registration_country', value) } > <SelectTrigger> <SelectValue placeholder='–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É' /> </SelectTrigger> <SelectContent> {countries.map((country) => ( <SelectItem key={country.value} value={country.value}> {country.label} </SelectItem> ))} </SelectContent> </Select> </div> <div> <label className='block text-sm font-medium mb-2'>–¢–∏–ø –∫—É–∑–æ–≤–∞*</label> <Select value={vehicleForm.body_type} onValueChange={(value) => handleVehicleInputChange('body_type', value) } > <SelectTrigger> <SelectValue placeholder='–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫—É–∑–æ–≤–∞' /> </SelectTrigger> <SelectContent> {bodyTypes.map((type) => ( <SelectItem key={type.value} value={type.value}> {type.label} </SelectItem> ))} </SelectContent> </Select> </div> <div> <label className='block text-sm font-medium mb-2'>–¢–∏–ø –ø–æ–≥—Ä—É–∑–∫–∏*</label> <Select value={vehicleForm.loading_type} onValueChange={(value) => handleVehicleInputChange('loading_type', value) } > <SelectTrigger> <SelectValue placeholder='–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ø–æ–≥—Ä—É–∑–∫–∏' /> </SelectTrigger> <SelectContent> {loadingTypes.map((type) => ( <SelectItem key={type.value} value={type.value}> {type.label} </SelectItem> ))} </SelectContent> </Select> </div> <div className='grid grid-cols-2 gap-4'> <div> <label className='block text-sm font-medium mb-2'> –ì—Ä—É–∑–æ–ø–æ–¥—ä–µ–º–Ω–æ—Å—Ç—å (—Ç–æ–Ω–Ω)* </label> <Input type='number' value={vehicleForm.capacity || ''} onChange={(e) => handleVehicleInputChange('capacity', parseFloat(e.target.value)) } /> </div> <div> <label className='block text-sm font-medium mb-2'>–û–±—ä–µ–º (–º¬≥)</label> <Input type='number' value={vehicleForm.volume || ''} onChange={(e) => handleVehicleInputChange('volume', parseFloat(e.target.value)) } /> </div> </div> <div className='grid grid-cols-3 gap-4'> <div> <label className='block text-sm font-medium mb-2'>–î–ª–∏–Ω–∞ (–º)</label> <Input type='number' value={vehicleForm.length || ''} onChange={(e) => handleVehicleInputChange('length', parseFloat(e.target.value)) } /> </div> <div> <label className='block text-sm font-medium mb-2'>–®–∏—Ä–∏–Ω–∞ (–º)</label> <Input type='number' value={vehicleForm.width || ''} onChange={(e) => handleVehicleInputChange('width', parseFloat(e.target.value)) } /> </div> <div> <label className='block text-sm font-medium mb-2'>–í—ã—Å–æ—Ç–∞ (–º)</label> <Input type='number' value={vehicleForm.height || ''} onChange={(e) => handleVehicleInputChange('height', parseFloat(e.target.value)) } /> </div> </div> <div className='grid grid-cols-3 gap-4'> <div className='flex items-center'> <Checkbox id='adr' checked={vehicleForm.adr} onCheckedChange={(checked) => handleVehicleInputChange('adr', checked) } /> <label htmlFor='adr' className='ml-2'> ADR </label> </div> <div className='flex items-center'> <Checkbox id='dozvol' checked={vehicleForm.dozvol} onCheckedChange={(checked) => handleVehicleInputChange('dozvol', checked) } /> <label htmlFor='dozvol' className='ml-2'> DOZVOL </label> </div> <div className='flex items-center'> <Checkbox id='tir' checked={vehicleForm.tir} onCheckedChange={(checked) => handleVehicleInputChange('tir', checked) } /> <label htmlFor='tir' className='ml-2'> TIR </label> </div> </div> {selectedVehicle ? ( <div> <label className='block text-sm font-medium mb-2'>–î–æ–∫—É–º–µ–Ω—Ç—ã</label> {documentTypes.map((docType) => ( <div key={docType.value} className='border rounded-lg p-4 space-y-4' > <div className='flex items-center justify-between'> <span className='font-medium'> {docType.label} {docType.required && ( <span className='text-red-500 ml-1'>*</span> )} </span> </div> <Input type='text' placeholder='–ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞' className='mb-2' onChange={(e) => { const existingDoc = documents.find( (d) => d.type === docType.value ); if (existingDoc) { setDocuments((docs) => docs.map((d) => d.type === docType.value ? { ...d, title: e.target.value } : d ) ); } }} /> <div className='grid grid-cols-2 gap-4'> <Input type='date' placeholder='–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è' onChange={(e) => { const existingDoc = documents.find( (d) => d.type === docType.value ); if (existingDoc) { setDocuments((docs) => docs.map((d) => d.type === docType.value ? { ...d, expiry_date: e.target.value } : d ) ); } }} /> <FileUpload onUpload={(file: any) => { const existingDocIndex = documents.findIndex( (d) => d.type === docType.value ); const newDoc: DocumentFormData = { file, type: docType.value, title: `${docType.label} - ${file.name}`, }; if (existingDocIndex !== -1) { setDocuments((docs) => docs.map((d, i) => i === existingDocIndex ? newDoc : d ) ); } else { setDocuments((docs) => [...docs, newDoc]); } }} allowedTypes={['image/jpeg', 'image/png', 'application/pdf']} maxSize={5 * 1024 * 1024} label={`–ó–∞–≥—Ä—É–∑–∏—Ç—å ${docType.label}`} /> </div> </div> ))} </div> ) : ( // </div> <p>u will add the documents later nigga</p> )} </div> ); const renderCarrierRequestForm = () => ( <div className='space-y-4'> <div> <label className='block text-sm font-medium mb-2'> –ü—É–Ω–∫—Ç –ø–æ–≥—Ä—É–∑–∫–∏* </label> <Input placeholder='–û—Ç–∫—É–¥–∞' value={requestForm.loading_point} onChange={(e) => handleRequestInputChange('loading_point', e.target.value) } /> </div> <div> <label className='block text-sm font-medium mb-2'> –ü—É–Ω–∫—Ç –≤—ã–≥—Ä—É–∑–∫–∏* </label> <Input placeholder='–ö—É–¥–∞' value={requestForm.unloading_point} onChange={(e) => handleRequestInputChange('unloading_point', e.target.value) } /> </div> <div> <label className='block text-sm font-medium mb-2'> –î–∞—Ç–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏* </label> <Input type='date' value={requestForm.ready_date} onChange={(e) => handleRequestInputChange('ready_date', e.target.value) } min={new Date().toISOString().split('T')[0]} /> </div> <div> <label className='block text-sm font-medium mb-2'>–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç*</label> <Select value={requestForm.vehicle} onValueChange={(value) => handleRequestInputChange('vehicle', value)} > <SelectTrigger> <SelectValue placeholder='–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç' /> </SelectTrigger> <SelectContent> {vehicles?.results?.map((vehicle: any) => ( <SelectItem key={vehicle.id} value={vehicle.id}> {vehicle.registration_number} -{' '} {bodyTypes.find((t) => t.value === vehicle.body_type)?.label} </SelectItem> ))} </SelectContent> </Select> </div> <div className='grid grid-cols-2 gap-4'> <div> <label className='block text-sm font-medium mb-2'> –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω </label> <Input type='number' min={1} value={requestForm.vehicle_count} onChange={(e) => handleRequestInputChange( 'vehicle_count', parseInt(e.target.value) ) } /> </div> <div> <label className='block text-sm font-medium mb-2'> –û–∂–∏–¥–∞–µ–º–∞—è —Ü–µ–Ω–∞ </label> <Input type='number' placeholder='–¶–µ–Ω–∞' value={requestForm.price_expectation || ''} onChange={(e) => handleRequestInputChange( 'price_expectation', parseFloat(e.target.value) ) } /> </div> </div> <div> <label className='block text-sm font-medium mb-2'>–£—Å–ª–æ–≤–∏—è –æ–ø–ª–∞—Ç—ã</label> <Select value={requestForm.payment_terms || ''} onValueChange={(value) => handleRequestInputChange('payment_terms', value) } > <SelectTrigger> <SelectValue placeholder='–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª–æ–≤–∏—è –æ–ø–ª–∞—Ç—ã' /> </SelectTrigger> <SelectContent> <SelectItem value='on_loading'>–ü—Ä–∏ –ø–æ–≥—Ä—É–∑–∫–µ</SelectItem> <SelectItem value='on_unloading'>–ü—Ä–∏ –≤—ã–≥—Ä—É–∑–∫–µ</SelectItem> <SelectItem value='after_unloading'>–ü–æ—Å–ª–µ –≤—ã–≥—Ä—É–∑–∫–∏</SelectItem> <SelectItem value='delayed'>–û—Ç—Å—Ä–æ—á–∫–∞ –ø–ª–∞—Ç–µ–∂–∞</SelectItem> </SelectContent> </Select> </div> <div> <label className='block text-sm font-medium mb-2'>–ü—Ä–∏–º–µ—á–∞–Ω–∏—è</label> <Input placeholder='–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è' value={requestForm.notes} onChange={(e) => handleRequestInputChange('notes', e.target.value)} /> </div> </div> ); const renderVehicleCard = (vehicle: Vehicle) => { const isExpanded = expandedVehicle === vehicle.id; // console.log(vehicle, 'vehicelrender'); return ( <Card key={vehicle.id} className='mb-4'> <CardContent className='p-4'> <div className='flex justify-between items-start mb-4'> <div> <h3 className='font-bold text-lg'> {vehicle.registration_number} </h3> <p className='text-sm text-gray-600'> {bodyTypes.find((t) => t.value === vehicle.body_type)?.label} </p> </div> <div className='flex space-x-2'> {vehicle.adr && <Badge>ADR</Badge>} {vehicle.dozvol && <Badge>DOZVOL</Badge>} {vehicle.tir && <Badge>TIR</Badge>} <Badge variant={vehicle.is_verified ? 'default' : 'secondary'}> {/* <Badge variant={vehicle.is_verified ? 'success' : 'secondary'}> */} {vehicle.is_verified ? '–ü—Ä–æ–≤–µ—Ä–µ–Ω' : '–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ'} </Badge> </div> </div> <div className='space-y-2 text-sm'> <p> {vehicle.capacity} —Ç / {vehicle.volume} –º¬≥ </p> <p> –ì–∞–±–∞—Ä–∏—Ç—ã: {vehicle.length}x{vehicle.width}x{vehicle.height} –º </p> </div> {isExpanded && ( <div className='mt-4 space-y-4'> <div className='grid grid-cols-1 md:grid-cols-2 gap-4'> {vehicle?.documents?.map((doc) => ( <div key={doc.id} className='flex items-center space-x-2'> <FileIcon className='h-4 w-4' /> <span> {documentTypes.find((t) => t.value === doc.type)?.label} </span> <Badge variant={doc.verified ? 'default' : 'secondary'}> {doc.verified ? '–ü—Ä–æ–≤–µ—Ä–µ–Ω' : '–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ'} </Badge> </div> ))} </div> <div className='space-y-2'> <p> –¢–∏–ø –ø–æ–≥—Ä—É–∑–∫–∏:{' '} { loadingTypes.find((t) => t.value === vehicle.loading_type) ?.label } </p> <p> –°—Ç—Ä–∞–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:{' '} { countries.find( (c) => c.value === vehicle.registration_country )?.label } </p> {vehicle.license_number && ( <p>–ù–æ–º–µ—Ä –ª–∏—Ü–µ–Ω–∑–∏–∏: {vehicle.license_number}</p> )} </div> </div> )} <div className='flex justify-between mt-4'> <Button variant='ghost' size='sm' onClick={() => setExpandedVehicle(isExpanded ? null : vehicle.id)} > {isExpanded ? ( <ChevronUp className='h-4 w-4 mr-1' /> ) : ( <ChevronDown className='h-4 w-4 mr-1' /> )} {isExpanded ? '–°–∫—Ä—ã—Ç—å' : '–ü–æ–¥—Ä–æ–±–Ω–µ–µ'} </Button> <div className='space-x-2'> <Button variant='outline' size='sm' onClick={() => { setSelectedVehicle(vehicle); setVehicleForm({ ...vehicle, id: vehicle.id || '', license_number: vehicle.license_number || '', }); setIsAddingVehicle(true); }} > <Edit2Icon className='h-4 w-4 mr-1' /> –ò–∑–º–µ–Ω–∏—Ç—å </Button> <Button variant='outline' size='sm' className='text-red-600' onClick={async () => { try { await api.delete(`/vehicles/${vehicle.id}/`); toast.success('–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç —É–¥–∞–ª–µ–Ω'); fetchVehicles(); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞'); } }} > <Trash2Icon className='h-4 w-4 mr-1' /> –£–¥–∞–ª–∏—Ç—å </Button> </div> </div> </CardContent> </Card> ); }; const renderCarrierRequestCard = (request: CarrierRequest) => { console.log(request, 'carriererquest'); return ( <Card key={request.id} className='mb-4'> <CardContent className='p-4'> <div className='flex justify-between items-start mb-4'> <div> <h3 className='font-bold'> {request.loading_point} - {request.unloading_point} </h3> <p className='text-sm text-gray-600'> {request?.vehicle?.registration_number} -{' '} {request.vehicle.body_type} </p> </div> <Badge variant={request.status === 'pending' ? 'secondary' : 'outline'} > {request.status === 'pending' ? '–í –æ–∂–∏–¥–∞–Ω–∏–∏' : '–í —Ä–∞–±–æ—Ç–µ'} </Badge> </div> <div className='space-y-2 text-sm'> <p> –î–∞—Ç–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:{' '} {new Date(request.ready_date).toLocaleDateString()} </p> <p>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω: {request.vehicle_count}</p> {request.price_expectation && ( <p>–û–∂–∏–¥–∞–µ–º–∞—è —Ü–µ–Ω–∞: {request.price_expectation} ‚ÇΩ</p> )} {request.payment_terms && ( <p>–£—Å–ª–æ–≤–∏—è –æ–ø–ª–∞—Ç—ã: {request.payment_terms}</p> )} {request.notes && <p>–ü—Ä–∏–º–µ—á–∞–Ω–∏—è: {request.notes}</p>} </div> <div className='flex justify-end mt-4 space-x-2'> <Button variant='outline' size='sm' onClick={async () => { try { await api.delete(`/cargo/carrier-requests/${request.id}/`); toast.success('–ó–∞—è–≤–∫–∞ —É–¥–∞–ª–µ–Ω–∞'); fetchCarrierRequests(); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏'); } }} > <Trash2Icon className='h-4 w-4 mr-1' /> –£–¥–∞–ª–∏—Ç—å </Button> </div> </CardContent> </Card> ); }; if (isLoading) { return ( <div className='min-h-screen bg-gray-100 flex items-center justify-center'> <Loader2 className='h-8 w-8 animate-spin text-blue-600' /> </div> ); } return ( <div className='min-h-screen bg-blue-600 p-4 pb-20'> <h1 className='text-2xl font-bold text-white text-center mb-6'> –ú–æ–∏ –º–∞—à–∏–Ω—ã –∏ –∑–∞—è–≤–∫–∏ </h1> {!isAddingVehicle && !isAddingRequest && ( <div className='flex flex-col items-center justify-center space-y-4 mt-10'> <Button className='w-64 h-12' onClick={() => setIsAddingVehicle(true)} > <Plus className='h-5 w-5 mr-2' /> –î–æ–±–∞–≤–∏—Ç—å –º–∞—à–∏–Ω—É </Button> <Button className='w-64 h-12' onClick={() => setIsAddingRequest(true)} > <Plus className='h-5 w-5 mr-2' /> –î–æ–±–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É </Button> </div> )} {isAddingVehicle && ( <Card className='mb-8 shadow-lg'> <CardContent className='p-6'> <h2 className='text-xl font-semibold mb-4'> {selectedVehicle ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞—à–∏–Ω—É' : '–î–æ–±–∞–≤–∏—Ç—å –º–∞—à–∏–Ω—É'} </h2> {renderVehicleForm()} <div className='flex justify-end space-x-4 mt-6'> <Button variant='outline' onClick={() => { setIsAddingVehicle(false); setSelectedVehicle(null); setVehicleForm(initialVehicleForm); }} > –û—Ç–º–µ–Ω–∞ </Button> <Button onClick={handleVehicleSubmit} disabled={isSubmitting}> {isSubmitting ? ( <> <Loader2 className='h-4 w-4 mr-2 animate-spin' /> –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ... </> ) : ( '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å' )} </Button> </div> </CardContent> </Card> )} {isAddingRequest && ( <Card className='mb-8 shadow-lg'> <CardContent className='p-6'> <h2 className='text-xl font-semibold mb-4'>–î–æ–±–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</h2> {renderCarrierRequestForm()} <div className='flex justify-end space-x-4 mt-6'> <Button variant='outline' onClick={() => { setIsAddingRequest(false); setRequestForm(initialCarrierRequestForm); }} > –û—Ç–º–µ–Ω–∞ </Button> <Button onClick={handleRequestSubmit} disabled={isSubmitting}> {isSubmitting ? ( <> <Loader2 className='h-4 w-4 mr-2 animate-spin' /> –°–æ–∑–¥–∞–Ω–∏–µ... </> ) : ( '–°–æ–∑–¥–∞—Ç—å' )} </Button> </div> </CardContent> </Card> )} {vehicles?.results?.length > 0 && ( <div className='mb-8'> <h2 className='text-xl font-semibold text-white mb-4'>–ú–æ–∏ –º–∞—à–∏–Ω—ã</h2> {vehicles?.results?.map(renderVehicleCard)} </div> )} {carrierRequests?.results?.length > 0 && ( <div className='mb-20'> <h2 className='text-xl font-semibold text-white mb-4'>–ú–æ–∏ –∑–∞—è–≤–∫–∏</h2> {carrierRequests?.results?.map(renderCarrierRequestCard)} </div> )} <NavigationMenu userRole='carrier' /> </div> ); }
```

# app\notifications\page.tsx

```tsx
'use client'; import React, { useEffect } from 'react'; import { Button } from '@/components/ui/button'; import { Card, CardContent } from '@/components/ui/card'; import { Badge } from '@/components/ui/badge'; import { Bell, CheckCircle, Trash2, ArrowLeft } from 'lucide-react'; import NavigationMenu from '../components/NavigationMenu'; import { useRouter } from 'next/navigation'; import { useApp } from '@/contexts/AppContext'; import { useNotifications } from '@/hooks/useNotifications'; import { formatDate } from '@/lib/utils'; import { motion, AnimatePresence } from 'framer-motion'; import { useUser } from '@/contexts/UserContext'; export default function NotificationsPage() { const router = useRouter(); const { notifications, notificationsCount, markNotificationAsRead, markAllNotificationsAsRead, deleteNotification, clearAllNotifications, } = useApp(); const { userState } = useUser(); const getNotificationIcon = (type: string) => { switch (type) { case 'cargo': return 'üì¶'; case 'route': return 'üöö'; default: return 'üîî'; } }; return ( <div className='min-h-screen bg-gray-50 p-4 pb-20'> <div className='flex items-center mb-6'> <Button variant='ghost' onClick={() => router.back()} className='mr-2'> <ArrowLeft className='h-6 w-6' /> </Button> <h1 className='text-2xl font-bold'>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h1> </div> <div className='flex justify-between items-center mb-4'> <div className='flex items-center'> <Bell className='h-5 w-5 mr-2' /> <span className='font-semibold'> –í—Å–µ–≥–æ: {notifications.length} {notificationsCount > 0 && ( <Badge variant='secondary' className='ml-2'> –ù–æ–≤—ã—Ö: {notificationsCount} </Badge> )} </span> </div> <div className='space-x-2'> <Button variant='outline' size='sm' onClick={markAllNotificationsAsRead} disabled={notificationsCount === 0} > <CheckCircle className='h-4 w-4 mr-2' /> –ü—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å–µ </Button> <Button variant='outline' size='sm' onClick={clearAllNotifications} disabled={notifications.length === 0} > <Trash2 className='h-4 w-4 mr-2' /> –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ </Button> </div> </div> <AnimatePresence mode='popLayout'> {notifications.length === 0 ? ( <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -20 }} className='text-center py-8 text-gray-500' > –ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π </motion.div> ) : ( <div className='space-y-3'> {notifications.map((notification) => ( <motion.div key={notification.id} layout initial={{ opacity: 0, x: -20 }} animate={{ opacity: 1, x: 0 }} exit={{ opacity: 0, x: 20 }} transition={{ duration: 0.2 }} > <Card className={`transition-colors ${ !notification.isRead ? 'bg-blue-50' : '' }`} > <CardContent className='p-4'> <div className='flex items-start justify-between'> <div className='flex items-start space-x-3'> <div className='text-2xl'> {getNotificationIcon(notification.type)} </div> <div> <p className='font-medium'>{notification.message}</p> <p className='text-sm text-gray-500'> {formatDate(notification.createdAt)} </p> </div> </div> <div className='flex space-x-2'> {!notification.isRead && ( <Button variant='ghost' size='sm' onClick={() => markNotificationAsRead(notification.id) } > <CheckCircle className='h-4 w-4' /> </Button> )} <Button variant='ghost' size='sm' onClick={() => deleteNotification(notification.id)} > <Trash2 className='h-4 w-4' /> </Button> </div> </div> </CardContent> </Card> </motion.div> ))} </div> )} </AnimatePresence> <NavigationMenu userRole={userState.role === 'carrier' ? 'carrier' : 'other'} /> {/* <NavigationMenu userRole='carrier' /> */} </div> ); }
```

# app\page.tsx

```tsx
// import Link from 'next/link'; // export default function Home() { // return ( // <div className='flex flex-col min-h-screen bg-red-700'> // <main className='flex-grow flex items-center justify-center p-4'> // <div className='bg-red-700 rounded-lg shadow-lg p-6 max-w-sm w-full border-2 border-white-500 text-white'> // <h1 className='text-3xl font-bold mb-4 text-center text-white'> // –ß—Ç–æ –£–º–µ–µ—Ç –ë–æ—Ç? // </h1> // <section className='mb-8 text-center text-white'> // <p> // Logit-Smartbot - ‚Ññ1 –ö—Ä—É–ø–Ω–µ–π—à–∞—è –∞—Å—Å–æ—Ü–∏–∞—Ü–∏—è –ª–æ–≥–∏—Å—Ç–∏–∫–∏ –≤ –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω–µ // </p> // </section> // </div> // </main> // <footer className='p-4 fixed bottom-0 left-0 right-0'> // <Link // href='/select-lang' // className='block w-full bg-blue-500 hover:bg-blue-600 text-white text-center py-3 rounded-lg text-lg font-semibold transition duration-300' // > // START // </Link> // </footer> // </div> // ); // } 'use client'; import { useEffect, useState } from 'react'; import Link from 'next/link'; declare global { interface Window { Telegram?: { WebApp: { colorScheme: any; themeParams: any; isExpanded: any; isFullscreen: any; viewportHeight: any; viewportStableHeight: any; enableClosingConfirmation(): unknown; ready(): unknown; expand(): unknown; close(): unknown; onEvent(eventType: any, eventHandler: any): unknown; requestFullscreen(): unknown; exitFullscreen(): unknown; offEvent(eventType: any, eventHandler: any): unknown; initData: string; initDataUnsafe: { query_id: string; user: { id: number; first_name: string; last_name?: string; username?: string; language_code: string; }; auth_date: string; hash: string; }; }; }; } } export default function Home() { const [webAppData, setWebAppData] = useState<any>(null); useEffect(() => { // Check if running in Telegram WebApp environment if (window.Telegram?.WebApp) { const tg = window.Telegram.WebApp; // Get all available WebApp data const webAppInitData = { initDataRaw: tg.initData, initDataParsed: tg.initDataUnsafe, // You can add more WebApp properties here as needed colorScheme: tg.colorScheme, themeParams: tg.themeParams, isExpanded: tg.isExpanded, viewportHeight: tg.viewportHeight, viewportStableHeight: tg.viewportStableHeight, }; // setWebAppData(webAppInitData); // Enable closing confirmation if needed tg.enableClosingConfirmation(); // Ready event to Telegram tg.ready(); setWebAppData(tg); } }, []); return ( <div className='flex flex-col min-h-screen bg-red-700'> <main className='flex-grow flex items-center justify-center p-4'> <div className='bg-red-700 rounded-lg shadow-lg p-6 max-w-sm w-full border-2 border-white-500 text-white'> <h1 className='text-3xl font-bold mb-4 text-center text-white'> –ß—Ç–æ –£–º–µ–µ—Ç –ë–æ—Ç? </h1> <section className='mb-8 text-center text-white'> <p> Logit-Smartbot - ‚Ññ1 –ö—Ä—É–ø–Ω–µ–π—à–∞—è –∞—Å—Å–æ—Ü–∏–∞—Ü–∏—è –ª–æ–≥–∏—Å—Ç–∏–∫–∏ –≤ –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω–µ </p> </section> {/* Display WebApp Data */} {/* {webAppData && ( <div className='mt-4 p-4 bg-white/10 rounded-lg'> <h2 className='text-xl font-bold mb-2'>Telegram WebApp Data:</h2> <pre className='whitespace-pre-wrap text-sm'> {JSON.stringify(webAppData, null, 2)} </pre> </div> )} */} </div> </main> <footer className='p-4 fixed bottom-0 left-0 right-0'> <Link href='/select-lang' className='block w-full bg-blue-500 hover:bg-blue-600 text-white text-center py-3 rounded-lg text-lg font-semibold transition duration-300' > START </Link> </footer> </div> ); }
```

# app\profile\page.tsx

```tsx
// app/profile/page.tsx import React from 'react'; import Layout from '../components/Layout'; import Image from 'next/image'; import Link from 'next/link'; const ProfilePage: React.FC = () => { // Dummy data const user = { id: '12345', name: 'John Doe', username: 'johndoe', role: 'Logistics Manager', verified: true, rating: 4.8, complaints: 1, recommendations: 15, experience: '5 years', position: 'Senior Logistics Coordinator', contact: { email: 'john.doe@example.com', phone: '+1 234 567 8900', }, photoUrl: '/api/placeholder/150/150', }; return ( <Layout> <div className="max-w-2xl mx-auto bg-white shadow-lg rounded-lg overflow-hidden"> <div className="bg-primary text-white p-4"> <div className="flex items-center space-x-4"> <Image src={user.photoUrl} alt={user.name} width={80} height={80} className="rounded-full" /> <div> <h1 className="text-2xl font-bold">{user.name}</h1> <p className="text-sm">{user.username}</p> </div> </div> </div> <div className="p-4 space-y-4"> <div className="grid grid-cols-2 gap-4"> <div> <h2 className="font-semibold">User ID</h2> <p>{user.id}</p> </div> <div> <h2 className="font-semibold">Role</h2> <p>{user.role}</p> </div> <div> <h2 className="font-semibold">Verified</h2> <p>{user.verified ? 'Yes' : 'No'}</p> </div> <div> <h2 className="font-semibold">Rating</h2> <p>{user.rating}/5</p> </div> <div> <h2 className="font-semibold">Complaints</h2> <p>{user.complaints}</p> </div> <div> <h2 className="font-semibold">Recommendations</h2> <p>{user.recommendations}</p> </div> <div> <h2 className="font-semibold">Experience</h2> <p>{user.experience}</p> </div> <div> <h2 className="font-semibold">Position</h2> <p>{user.position}</p> </div> </div> <div> <h2 className="font-semibold">Contact Information</h2> <p>Email: {user.contact.email}</p> <p>Phone: {user.contact.phone}</p> </div> <div> <Link href='/menu'>Go to my profile</Link> </div> </div> </div> </Layout> ); }; export default ProfilePage;
```

# app\registration-confirm\page.tsx

```tsx
'use client'; import React, { useState } from 'react'; import { motion, AnimatePresence } from 'framer-motion'; import { useRouter } from 'next/navigation'; import { Input } from '@/components/ui/input'; import { Button } from '@/components/ui/button'; import AuthService from '@/lib/auth'; import { useUser } from '@/contexts/UserContext'; const RegistrationCompletionPage: React.FC = () => { const [stage, setStage] = useState<'contact-info' | 'confirmation'>( 'contact-info' ); const { userState } = useUser(); const [phone, setPhone] = useState(''); const [whatsapp, setWhatsapp] = useState(''); const [telegram, setTelegram] = useState(''); const router = useRouter(); const handleSubmit = async (e: React.FormEvent) => { e.preventDefault(); try { // if (window.Telegram?.WebApp) { const webApp = window?.Telegram?.WebApp; // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ const result = await AuthService.registerUser({ telegramData: webApp, userData: { type: userState.type, role: userState.role, preferred_language: userState.language, phone_number: phone, whatsapp_number: whatsapp, }, }); console.log(result, 'result'); // } // await setUserData({ // result, // // role: userState.role, // }); // await setUserRole(userState.role); // await setUserType(userState.type); // await setLanguage(userState.language); // await setUserType({ type: userState.type }) // toast.success('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞'); // router.push('/menu'); } catch (error) { // toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.'); console.error('Registration error:', error); } // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä setStage('confirmation'); }; const pageVariants = { initial: { opacity: 0, x: '-100%' }, in: { opacity: 1, x: 0 }, out: { opacity: 0, x: '100%' }, }; const pageTransition = { type: 'tween', ease: 'anticipate', duration: 0.5, }; return ( <div className='min-h-screen bg-blue-600 flex items-center justify-center p-4'> <AnimatePresence mode='wait'> {stage === 'contact-info' && ( <motion.div key='contact-info' initial='initial' animate='in' exit='out' variants={pageVariants} transition={pageTransition} className='bg-white rounded-lg shadow-xl p-8 max-w-md w-full' > <h1 className='text-3xl font-bold mb-6 text-blue-800 text-center'> –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! </h1> <p className='mb-6 text-gray-600 text-center'> –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ. –í —Ü–µ–ª—è—Ö —É–ª—É—á—à–µ–Ω–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∏ —Å–≤—è–∑–∏ —Å –Ω–∞—à–∏–º–∏ –ª–æ–≥–∏—Å—Ç–∞–º–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. </p> <form onSubmit={handleSubmit} className='space-y-4'> <Input type='tel' placeholder='–ú–æ–±–∏–ª—å–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω' value={phone} onChange={(e) => setPhone(e.target.value)} required className='w-full' /> <Input type='tel' placeholder='WhatsApp' value={whatsapp} onChange={(e) => setWhatsapp(e.target.value)} required className='w-full' /> <Input type='text' placeholder='Telegram' value={telegram} onChange={(e) => setTelegram(e.target.value)} required className='w-full' /> <Button type='submit' className='w-full bg-blue-500 hover:bg-blue-600 text-white' > –î–∞–ª–µ–µ </Button> </form> </motion.div> )} {stage === 'confirmation' && ( <motion.div key='confirmation' initial='initial' animate='in' exit='out' variants={pageVariants} transition={pageTransition} className='bg-white rounded-lg shadow-xl p-8 max-w-md w-full text-center' > <h1 className='text-3xl font-bold mb-6 text-blue-800'> –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! </h1> <p className='mb-6 text-gray-600'> –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ. –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞—à–∏–º–∏ —É—Å–ª—É–≥–∞–º–∏. </p> <p className='mb-6 text-gray-600'> –í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –≤—Å–µ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ä–∞–∑–¥–µ–ª–µ –ú–µ–Ω—é - –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç. </p> <Button onClick={() => router.push('/menu')} className='w-full bg-blue-500 hover:bg-blue-600 text-white' > –ü–µ—Ä–µ–π—Ç–∏ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç </Button> </motion.div> )} </AnimatePresence> </div> ); }; export default RegistrationCompletionPage;
```

# app\registration\page.tsx

```tsx
'use client'; import { useState, useEffect } from 'react'; import { Input } from '@/components/ui/input'; import { Button } from '@/components/ui/button'; import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue, } from '@/components/ui/select'; import { useRouter } from 'next/navigation'; import { useUser } from '@/contexts/UserContext'; // import { useUser } from '@/contexts/UserContext'; import { UserState } from '@/types'; import { toast } from 'sonner'; import AuthService from '@/lib/auth'; export default function RegistrationPage() { const router = useRouter(); const { userState, setUserData, setUserRole, setUserType, setLanguage } = useUser(); const [formData, setFormData] = useState<UserState['userData']>({}); const [isLoading, setIsLoading] = useState(false); useEffect(() => { // if (!userState.role) { // router.push('/select-role'); // return; // } // Pre-fill form with Telegram data if available if (typeof window !== 'undefined' && window.Telegram?.WebApp) { const { user } = window.Telegram.WebApp.initDataUnsafe; setFormData((prev) => ({ ...prev, fullName: user.first_name + (user.last_name ? ` ${user.last_name}` : ''), telegramNumber: user.username ? `@${user.username}` : '', })); } if (userState) { console.log(userState.language, 'userstatelang'); console.log(userState.type, 'userstatetype'); console.log(userState.role, 'userstaterole'); } }, [userState.role, router]); const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => { setFormData({ ...formData, [e.target.name]: e.target.value, }); }; const handleSelectChange = (name: string, value: string) => { setFormData({ ...formData, [name]: value, }); }; const validateForm = () => { const requiredFields = getRequiredFields(); // const missingFields = requiredFields.filter((field) => !formData[field]); const missingFields = requiredFields.filter( (field) => formData && formData[field as keyof typeof formData] === undefined ); if (missingFields.length > 0) { toast.error( `–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: ${missingFields.join(', ')}` ); return false; } return true; }; const getRequiredFields = () => { const commonFields = ['fullName', 'phoneNumber']; switch (userState.role) { case 'logistics-company': case 'cargo-owner': return [...commonFields, 'companyName']; case 'student': return [...commonFields, 'groupName']; //'studentId']; case 'carrier': return [...commonFields, 'licenseNumber']; default: return commonFields; } }; const handleSubmit = async (e: React.FormEvent) => { e.preventDefault(); if (!validateForm()) return; setIsLoading(true); try { // if (window.Telegram?.WebApp) { const webApp = window?.Telegram?.WebApp; // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ const result = await AuthService.registerUser({ telegramData: webApp, userData: { type: userState.type, role: userState.role, preferred_language: userState.language, ...formData, }, }); console.log(result, 'result'); // } // await setUserData({ // result, // // role: userState.role, // }); await setUserRole(userState.role); await setUserType(userState.type); await setLanguage(userState.language); // await setUserType({ type: userState.type }) toast.success('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞'); if (userState.role === 'carrier') { router.push('/driver-verification'); } else { router.push('/menu'); } } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.'); console.error('Registration error:', error); } finally { setIsLoading(false); } }; const clearForm = () => { setFormData({}); }; const renderExpeditorForm = () => ( <form onSubmit={handleSubmit} className='space-y-4'> <Input name='companyName' placeholder='–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏' onChange={handleInputChange} value={formData?.companyName || ''} required /> <Input name='fullName' placeholder='–§–ò–û' onChange={handleInputChange} value={formData?.fullName || ''} required /> <Input name='telegramNumber' placeholder='Telegram –Ω–æ–º–µ—Ä' onChange={handleInputChange} value={formData?.telegramNumber || ''} /> <Input name='whatsappNumber' placeholder='WhatsApp –Ω–æ–º–µ—Ä' onChange={handleInputChange} value={formData?.whatsappNumber || ''} /> <Input name='phoneNumber' placeholder='–ú–æ–±–∏–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä' onChange={handleInputChange} value={formData?.phoneNumber || ''} required /> <Select name='position' onValueChange={(value) => handleSelectChange('position', value)} > <SelectTrigger> <SelectValue placeholder='–ö–µ–º —è–≤–ª—è–µ—Ç–µ—Å—å' /> </SelectTrigger> <SelectContent> <SelectItem value='director'>–î–∏—Ä–µ–∫—Ç–æ—Ä</SelectItem> <SelectItem value='manager'>–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å</SelectItem> <SelectItem value='dispatcher'>–î–∏—Å–ø–µ—Ç—á–µ—Ä</SelectItem> </SelectContent> </Select> <Input name='registrationCertificate' placeholder='–°–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –æ –≥–æ—Å. —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —é—Ä. –ª–∏—Ü–∞' onChange={handleInputChange} value={formData?.registrationCertificate || ''} /> <div className='flex justify-between mt-6'> <Button variant='destructive' onClick={clearForm} type='button'> –û—á–∏—Å—Ç–∏—Ç—å </Button> <Button type='submit' disabled={isLoading}> {isLoading ? '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...' : '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å'} </Button> </div> </form> ); const renderCargoOwnerForm = () => ( <form onSubmit={handleSubmit} className='space-y-4'> <Input name='fullName' placeholder='–§–ò–û' onChange={handleInputChange} value={formData?.fullName || ''} required /> <Input name='telegramNumber' placeholder='Telegram –Ω–æ–º–µ—Ä' onChange={handleInputChange} value={formData?.telegramNumber || ''} /> <Input name='whatsappNumber' placeholder='WhatsApp –Ω–æ–º–µ—Ä' onChange={handleInputChange} value={formData?.whatsappNumber || ''} /> <Input name='phoneNumber' placeholder='–ú–æ–±–∏–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä' onChange={handleInputChange} value={formData?.phoneNumber || ''} required /> <Select name='role' onValueChange={(value) => handleSelectChange('role', value)} > <SelectTrigger> <SelectValue placeholder='–ö–µ–º —è–≤–ª—è–µ—Ç–µ—Å—å' /> </SelectTrigger> <SelectContent> <SelectItem value='shipper'>–ì—Ä—É–∑–æ–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å</SelectItem> <SelectItem value='consignee'>–ì—Ä—É–∑–æ–ø–æ–ª—É—á–∞—Ç–µ–ª—å</SelectItem> </SelectContent> </Select> <Input name='registrationCertificate' placeholder='–°–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –æ –≥–æ—Å. —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —é—Ä. –ª–∏—Ü–∞' onChange={handleInputChange} value={formData?.registrationCertificate || ''} /> <div className='flex justify-between mt-6'> <Button variant='destructive' onClick={clearForm} type='button'> –û—á–∏—Å—Ç–∏—Ç—å </Button> <Button type='submit' disabled={isLoading}> {isLoading ? '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...' : '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å'} </Button> </div> </form> ); const renderStudentForm = () => ( <form onSubmit={handleSubmit} className='space-y-4'> <Input name='fullName' placeholder='–§–ò–û' onChange={handleInputChange} value={formData?.fullName || ''} required /> <Input name='telegramNumber' placeholder='Telegram –Ω–æ–º–µ—Ä' onChange={handleInputChange} value={formData?.telegramNumber || ''} /> <Input name='whatsappNumber' placeholder='WhatsApp –Ω–æ–º–µ—Ä' onChange={handleInputChange} value={formData?.whatsappNumber || ''} /> <Input name='phoneNumber' placeholder='–ú–æ–±–∏–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä' onChange={handleInputChange} value={formData?.phoneNumber || ''} required /> <Select name='studentStatus' onValueChange={(value) => handleSelectChange('studentStatus', value)} > <SelectTrigger> <SelectValue placeholder='–ö–µ–º —è–≤–ª—è–µ—Ç–µ—Å—å' /> </SelectTrigger> <SelectContent> <SelectItem value='current'>–°—Ç—É–¥–µ–Ω—Ç –õ–æ–≥–∏—Ç –°–∫—É–ª</SelectItem> <SelectItem value='graduate'>–í—ã–ø—É—Å–∫–Ω–∏–∫ –õ–æ–≥–∏—Ç –°–∫—É–ª</SelectItem> </SelectContent> </Select> <Select name='city' onValueChange={(value) => handleSelectChange('city', value)} > <SelectTrigger> <SelectValue placeholder='–ì–æ—Ä–æ–¥ –æ–±—É—á–µ–Ω–∏—è' /> </SelectTrigger> <SelectContent> <SelectItem value='tashkent'>–¢–∞—à–∫–µ–Ω—Ç</SelectItem> <SelectItem value='samarkand'>–°–∞–º–∞—Ä–∫–∞–Ω–¥</SelectItem> </SelectContent> </Select> <Select name='tariff' onValueChange={(value) => handleSelectChange('tariff', value)} > <SelectTrigger> <SelectValue placeholder='–¢–∞—Ä–∏—Ñ –æ–±—É—á–µ–Ω–∏—è' /> </SelectTrigger> <SelectContent> <SelectItem value='standard'>–°—Ç–∞–Ω–¥–∞—Ä—Ç –ü—Ä–æ</SelectItem> <SelectItem value='vip'>–í–ò–ü –ü—Ä–æ</SelectItem> </SelectContent> </Select> <Input name='groupName' placeholder='–ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã' onChange={handleInputChange} value={formData?.groupName || ''} required /> <Select name='studyLanguage' onValueChange={(value) => handleSelectChange('studyLanguage', value)} > <SelectTrigger> <SelectValue placeholder='–Ø–∑—ã–∫ –æ–±—É—á–µ–Ω–∏—è' /> </SelectTrigger> <SelectContent> <SelectItem value='russian'>–†—É—Å—Å–∫–∏–π</SelectItem> <SelectItem value='uzbek'>–£–∑–±–µ–∫—Å–∫–∏–π</SelectItem> </SelectContent> </Select> <Input name='curatorName' placeholder='–ò–º—è –∫—É—Ä–∞—Ç–æ—Ä–∞' onChange={handleInputChange} value={formData?.curatorName || ''} /> <Input name='endDate' type='date' placeholder='–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è' onChange={handleInputChange} value={formData?.endDate || ''} /> <div className='flex justify-between mt-6'> <Button variant='destructive' onClick={clearForm} type='button'> –û—á–∏—Å—Ç–∏—Ç—å </Button> <Button type='submit' disabled={isLoading}> {isLoading ? '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...' : '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å'} </Button> </div> </form> ); // Show only the relevant form based on user role console.log(userState.role, 'userstate'); const renderForm = () => { switch (userState.role) { case 'logistics-company': return renderExpeditorForm(); case 'cargo-owner': return renderCargoOwnerForm(); case 'student': return renderStudentForm(); default: return null; } }; return ( <div className='min-h-screen bg-blue-900 p-4'> <h1 className='text-3xl font-bold text-white text-center mb-6'> –ü—Ä–æ–π—Ç–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é </h1> <div className='bg-white rounded-lg p-6 max-w-md mx-auto'> {renderForm()} </div> </div> ); }
```

# app\requests\page.tsx

```tsx
'use client'; import { useState } from 'react'; import { Button } from '@/components/ui/button'; import { Home, Truck, Package, Bell, Menu } from 'lucide-react'; import NavigationMenu from '../components/NavigationMenu'; interface RequestType { title: string; count: number; color: string; } export default function RequestsPage() { const [requestTypes, setRequestTypes] = useState<RequestType[]>([ { title: '–ó–∞—è–≤–∫–∏ –æ—Ç –≥—Ä—É–∑–æ–≤–ª–∞–¥–µ–ª—å—Ü–µ–≤', count: 15, color: 'bg-green-500' }, { title: '–ó–∞—è–≤–∫–∏ –æ—Ç —ç–∫—Å. –∫–æ–º–ø–∞–Ω–∏–π', count: 8, color: 'bg-yellow-500' }, { title: '–ó–∞—è–≤–∫–∏ –æ—Ç –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–æ–≤', count: 12, color: 'bg-red-500' }, ]); return ( <div className='min-h-screen bg-blue-900 p-4 pb-20'> <h1 className='text-3xl font-bold text-white text-center mb-6'>–ó–∞—è–≤–∫–∏</h1> <div className='grid grid-cols-1 md:grid-cols-3 gap-4 mb-20'> {requestTypes.map((type, index) => ( <div key={index} className='bg-white rounded-lg p-4 shadow-lg'> <div className='flex justify-between items-center mb-2'> <h2 className='text-lg font-semibold'>{type.title}</h2> <span className={`${type.color} text-white rounded-full w-8 h-8 flex items-center justify-center`} > {type.count} </span> </div> <Button className='w-full mt-2' variant='outline'> –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å </Button> </div> ))} </div> <NavigationMenu userRole='other' /> </div> ); } // 'use client'; // import React, { useState, useEffect } from 'react'; // import { Input } from '@/components/ui/input'; // import { Button } from '@/components/ui/button'; // import { Card, CardContent } from '@/components/ui/card'; // import { Badge } from '@/components/ui/badge'; // import { // Dialog, // DialogContent, // DialogHeader, // DialogTitle, // } from '@/components/ui/dialog'; // import { Checkbox } from '@/components/ui/checkbox'; // import { // Select, // SelectContent, // SelectItem, // SelectTrigger, // SelectValue, // } from '@/components/ui/select'; // import { DateRange, Range, RangeKeyDict } from 'react-date-range'; // import 'react-date-range/dist/styles.css'; // import 'react-date-range/dist/theme/default.css'; // import { // Filter, // Star, // CheckCircle, // Clock, // Bell, // Heart, // ChevronDown, // ChevronUp, // } from 'lucide-react'; // import NavigationMenu from '../components/NavigationMenu'; // type UserRole = 'carrier' | 'other'; // interface Order { // id: number; // cargo: string; // weight: number; // date: string; // payment: string; // price: string; // from: string; // to: string; // vehicleType: string; // description: string; // isTop: boolean; // isVerified: boolean; // experience: number; // rating: number; // dimensions: string; // loadingType: string; // unloadingType: string; // additionalRequirements: string; // } // interface FilterState { // category: string; // from: string; // to: string; // dateRange: Range; // notifications: boolean; // } // const mockOrders: Order[] = [ // { // id: 1, // cargo: '–ú–µ—Ç–∞–ª–ª', // weight: 22, // date: '12.12.2023 14:34', // payment: '–ö–æ–º–±–æ', // price: '–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è', // from: '–¢–∞—à–∫–µ–Ω—Ç', // to: '–ú–æ—Å–∫–≤–∞', // vehicleType: '–¢–µ–Ω—Ç', // description: // '–¢–∞—à–∫–µ–Ω—Ç-–ú–æ—Å–∫–≤–∞, –Ω—É–∂–µ–Ω-—Ç–µ–Ω—Ç, –≥—Ä—É–∑-–º–µ—Ç–∞–ª–ª, –≤–µ—Å:22—Ç, –æ–ø–ª–∞—Ç–∞:–∫–æ–º–±–æ, –¥–∞—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è: 12.12.2023', // isTop: true, // isVerified: true, // experience: 2, // rating: 4, // dimensions: '5x2x2 –º', // loadingType: '–ë–æ–∫–æ–≤–∞—è', // unloadingType: '–ó–∞–¥–Ω—è—è', // additionalRequirements: '–¢—Ä–µ–±—É–µ—Ç—Å—è –∫—Ä–µ–ø–ª–µ–Ω–∏–µ –≥—Ä—É–∑–∞', // }, // // –î–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ –∑–∞–∫–∞–∑–æ–≤ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏ // ]; // const cargoCategories = [ // '–ú–µ—Ç–∞–ª–ª', // '–¢–µ–∫—Å—Ç–∏–ª—å', // '–ü—Ä–æ–¥—É–∫—Ç—ã', // '–¢–µ—Ö–Ω–∏–∫–∞', // '–°—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª—ã', // ]; // const cities = [ // '–¢–∞—à–∫–µ–Ω—Ç', // '–ú–æ—Å–∫–≤–∞', // '–ë—É—Ö–∞—Ä–∞', // '–ê–Ω–¥–∏–∂–∞–Ω', // '–°–∞–º–∞—Ä–∫–∞–Ω–¥', // '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥', // ]; // const RoleConfirmationDialog: React.FC<{ // onConfirm: (role: UserRole) => void; // }> = ({ onConfirm }) => { // return ( // <Dialog open={true}> // <DialogContent> // <DialogHeader> // <DialogTitle>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –≤–∞—à—É —Ä–æ–ª—å</DialogTitle> // </DialogHeader> // <div className='space-y-4'> // <Button onClick={() => onConfirm('carrier')} className='w-full'> // –Ø –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫ // </Button> // <Button onClick={() => onConfirm('other')} className='w-full'> // –Ø –¥—Ä—É–≥–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å // </Button> // </div> // </DialogContent> // </Dialog> // ); // }; // const FilterModal: React.FC<{ // isOpen: boolean; // onClose: () => void; // onApply: (filters: FilterState) => void; // }> = ({ isOpen, onClose, onApply }) => { // const [filters, setFilters] = useState<FilterState>({ // category: '', // from: '', // to: '', // dateRange: { // startDate: undefined, // endDate: undefined, // key: 'selection', // }, // notifications: false, // }); // const handleSelectChange = (name: keyof FilterState, value: string) => { // setFilters((prev) => ({ ...prev, [name]: value })); // }; // const handleDateRangeChange = (ranges: RangeKeyDict) => { // setFilters((prev) => ({ ...prev, dateRange: ranges.selection })); // }; // const handleCheckboxChange = (checked: boolean) => { // setFilters((prev) => ({ ...prev, notifications: checked })); // }; // const handleApply = () => { // onApply(filters); // onClose(); // }; // return ( // <Dialog open={isOpen} onOpenChange={onClose}> // <DialogContent className='bg-blue-600 text-white max-w-[90vw] h-[80vh] overflow-y-auto'> // <DialogHeader> // <DialogTitle className='text-white'>–ü–æ–∏—Å–∫ –≥—Ä—É–∑–æ–≤</DialogTitle> // </DialogHeader> // <div className='space-y-4'> // <Select // onValueChange={(value) => handleSelectChange('category', value)} // > // <SelectTrigger className='bg-blue-500 text-white border-blue-400'> // <SelectValue placeholder='–ö–∞—Ç–µ–≥–æ—Ä–∏—è –≥—Ä—É–∑–æ–≤' /> // </SelectTrigger> // <SelectContent> // {cargoCategories.map((category) => ( // <SelectItem key={category} value={category}> // {category} // </SelectItem> // ))} // </SelectContent> // </Select> // <Select onValueChange={(value) => handleSelectChange('from', value)}> // <SelectTrigger className='bg-blue-500 text-white border-blue-400'> // <SelectValue placeholder='–û—Ç–∫—É–¥–∞' /> // </SelectTrigger> // <SelectContent> // {cities.map((city) => ( // <SelectItem key={city} value={city}> // {city} // </SelectItem> // ))} // </SelectContent> // </Select> // <Select onValueChange={(value) => handleSelectChange('to', value)}> // <SelectTrigger className='bg-blue-500 text-white border-blue-400'> // <SelectValue placeholder='–ö—É–¥–∞' /> // </SelectTrigger> // <SelectContent> // {cities.map((city) => ( // <SelectItem key={city} value={city}> // {city} // </SelectItem> // ))} // </SelectContent> // </Select> // <div className='bg-white rounded-md p-2'> // <DateRange // ranges={[filters.dateRange]} // onChange={handleDateRangeChange} // months={1} // direction='vertical' // className='w-full' // /> // </div> // <div className='flex items-center space-x-2'> // <Checkbox // id='notifications' // checked={filters.notifications} // onCheckedChange={handleCheckboxChange} // /> // <label htmlFor='notifications' className='text-white'> // –í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è // </label> // </div> // <Button // onClick={handleApply} // className='w-full bg-yellow-400 text-blue-800 hover:bg-yellow-500' // > // –ù–∞–π—Ç–∏ –≥—Ä—É–∑—ã // </Button> // </div> // </DialogContent> // </Dialog> // ); // }; // export default function OrdersPage() { // const [searchTerm, setSearchTerm] = useState(''); // const [orders, setOrders] = useState<Order[]>(mockOrders); // const [isFilterModalOpen, setIsFilterModalOpen] = useState(false); // const [showNotificationDialog, setShowNotificationDialog] = useState(false); // const [userRole, setUserRole] = useState<UserRole | null>(null); // const [expandedOrder, setExpandedOrder] = useState<number | null>(null); // useEffect(() => { // const savedRole = localStorage.getItem('userRole') as UserRole | null; // if (savedRole) { // setUserRole(savedRole); // } // const handleBeforeUnload = () => { // localStorage.clear(); // }; // window.addEventListener('beforeunload', handleBeforeUnload); // return () => { // window.removeEventListener('beforeunload', handleBeforeUnload); // }; // }, []); // const handleRoleConfirm = (role: UserRole) => { // setUserRole(role); // localStorage.setItem('userRole', role); // }; // const handleSearch = (e: React.ChangeEvent<HTMLInputElement>) => { // setSearchTerm(e.target.value); // // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∑–∞–∫–∞–∑–æ–≤ // }; // const handleApplyFilters = (filters: FilterState) => { // console.log('Applied filters:', filters); // // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∫ –∑–∞–∫–∞–∑–∞–º // }; // const renderStars = (rating: number) => { // return Array(5) // .fill(0) // .map((_, i) => ( // <Star // key={i} // className={`h-4 w-4 ${ // i < rating ? 'text-yellow-400 fill-current' : 'text-gray-300' // }`} // /> // )); // }; // const toggleOrderExpansion = (orderId: number) => { // setExpandedOrder(expandedOrder === orderId ? null : orderId); // }; // if (userRole === null) { // return <RoleConfirmationDialog onConfirm={handleRoleConfirm} />; // } // return ( // <div className='min-h-screen bg-blue-600 p-4 pb-20'> // <div className='flex items-center mb-4 bg-white rounded-lg p-2'> // <Input // type='text' // placeholder='–ü–æ–∏—Å–∫ –∑–∞–∫–∞–∑–æ–≤...' // value={searchTerm} // onChange={handleSearch} // className='mr-2 flex-grow' // /> // <Button // variant='default' // size='sm' // className='bg-yellow-400 text-black hover:bg-yellow-500 whitespace-nowrap' // onClick={() => setIsFilterModalOpen(true)} // > // <Filter className='h-4 w-4 mr-2' /> // –§–∏–ª—å—Ç—Ä—ã // </Button> // </div> // <FilterModal // isOpen={isFilterModalOpen} // onClose={() => setIsFilterModalOpen(false)} // onApply={handleApplyFilters} // /> // <div className='space-y-4 mb-20'> // {orders.map((order) => ( // <Card key={order.id} className='bg-white overflow-hidden'> // <CardContent className='p-4'> // <div className='flex justify-between items-start mb-2'> // <div className='flex space-x-1'> // {order.isTop && ( // <Badge // variant='secondary' // className='bg-yellow-100 text-yellow-800' // > // <Star className='h-4 w-4' /> // </Badge> // )} // {order.isVerified && ( // <Badge // variant='secondary' // className='bg-green-100 text-green-800' // > // <CheckCircle className='h-4 w-4' /> // </Badge> // )} // {order.experience > 1 && ( // <Badge // variant='secondary' // className='bg-blue-100 text-blue-800' // > // <Clock className='h-4 w-4' /> {order.experience}–≥ // </Badge> // )} // </div> // <div className='flex items-center'> // <span className='font-bold mr-1'>{order.rating}</span> // <div className='flex'>{renderStars(order.rating)}</div> // </div> // </div> // <div className='flex justify-between items-center mb-2'> // <span className='font-bold text-lg'> // {order.from} - {order.to} // </span> // <span className='text-sm text-gray-500'>{order.date}</span> // </div> // <div className='grid grid-cols-2 gap-2 mb-2 text-sm'> // <span>–ì—Ä—É–∑: {order.cargo}</span> // <span>–í–µ—Å: {order.weight} —Ç</span> // <span>–¢–∏–ø: {order.vehicleType}</span> // <span>–û–ø–ª–∞—Ç–∞: {order.payment}</span> // </div> // <div className='mb-2'> // <span className='font-semibold'>–¶–µ–Ω–∞: {order.price}</span> // </div> // {expandedOrder === order.id && ( // <div className='mt-4 text-sm'> // <p>–†–∞–∑–º–µ—Ä—ã: {order.dimensions}</p> // <p>–¢–∏–ø –ø–æ–≥—Ä—É–∑–∫–∏: {order.loadingType}</p> // <p>–¢–∏–ø —Ä–∞–∑–≥—Ä—É–∑–∫–∏: {order.unloadingType}</p> // <p>–î–æ–ø. —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è: {order.additionalRequirements}</p> // <p className='mt-2'>–û–ø–∏—Å–∞–Ω–∏–µ: {order.description}</p> // </div> // )} // <div className='flex justify-between mt-4'> // <Button // variant='outline' // size='sm' // className='flex-1 mr-1' // onClick={() => toggleOrderExpansion(order.id)} // > // {expandedOrder === order.id ? ( // <ChevronUp className='h-4 w-4 mr-1' /> // ) : ( // <ChevronDown className='h-4 w-4 mr-1' /> // )} // {expandedOrder === order.id ? '–°–∫—Ä—ã—Ç—å' : '–ü–æ–¥—Ä–æ–±–Ω–µ–µ'} // </Button> // <Button // variant='outline' // size='sm' // className='flex-1 ml-1 mr-1' // onClick={() => setShowNotificationDialog(true)} // > // <Bell className='h-4 w-4 mr-1' /> // </Button> // <Button variant='outline' size='sm' className='flex-1'> // <Heart className='h-4 w-4 mr-1' /> // </Button> // </div> // </CardContent> // </Card> // ))} // </div> // <Dialog // open={showNotificationDialog} // onOpenChange={setShowNotificationDialog} // > // <DialogContent> // <DialogHeader> // <DialogTitle>–í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è?</DialogTitle> // </DialogHeader> // <p> // –•–æ—Ç–∏—Ç–µ –≤–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Ç–∏–ø–∞–º –≥—Ä—É–∑–∞ –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º? // </p> // <div className='flex justify-end space-x-2 mt-4'> // <Button // variant='outline' // onClick={() => setShowNotificationDialog(false)} // > // –û—Ç–º–µ–Ω–∞ // </Button> // <Button // onClick={() => { // // –õ–æ–≥–∏–∫–∞ –≤–∫–ª—é—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π // setShowNotificationDialog(false); // }} // > // –í–∫–ª—é—á–∏—Ç—å // </Button> // </div> // </DialogContent> // </Dialog> // <NavigationMenu userRole={userRole} /> // </div> // ); // }
```

# app\search\page.tsx

```tsx
'use client'; import React, { useState } from 'react'; import { Button } from '@/components/ui/button'; import { Input } from '@/components/ui/input'; import { Card, CardContent } from '@/components/ui/card'; import { Avatar } from '@/components/ui/avatar'; import { Search, ArrowLeft } from 'lucide-react'; import { useRouter } from 'next/navigation'; interface SearchResult { id: string; name: string; type: 'participant' | 'firm'; details: string; avatar?: string; } const mockSearchResults: SearchResult[] = [ { id: '1', name: '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤', type: 'participant', details: '–õ–æ–≥–∏—Å—Ç, –ú–æ—Å–∫–≤–∞', avatar: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSRIRFWZntgIF7DtKKfdha91qSbJdq65mzTUNQNx2hG2Jc2PpLmjRszXG0DoUoWg6eyq2A&usqp=CAU', }, { id: '2', name: '–û–û–û "–õ–æ–≥–∏—Å—Ç–∏–∫–∞+"', type: 'firm', details: '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è, –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥', }, { id: '3', name: '–ê–Ω–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞', type: 'participant', details: '–ú–µ–Ω–µ–¥–∂–µ—Ä, –ö–∞–∑–∞–Ω—å', avatar: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSRIRFWZntgIF7DtKKfdha91qSbJdq65mzTUNQNx2hG2Jc2PpLmjRszXG0DoUoWg6eyq2A&usqp=CAU', }, { id: '4', name: '–ò–ü –°–∏–¥–æ—Ä–æ–≤', type: 'firm', details: '–ì—Ä—É–∑–æ–ø–µ—Ä–µ–≤–æ–∑–∫–∏, –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫', }, ]; export default function SearchParticipantsAndFirms() { const [searchTerm, setSearchTerm] = useState<string>(''); const [searchResults, setSearchResults] = useState<SearchResult[]>([]); const [isSearching, setIsSearching] = useState<boolean>(false); const router = useRouter(); const handleSearch = () => { setIsSearching(true); const results = mockSearchResults.filter( (result) => result.name.toLowerCase().includes(searchTerm.toLowerCase()) || result.details.toLowerCase().includes(searchTerm.toLowerCase()) ); setSearchResults(results); }; const renderSearchResults = () => ( <div className='mt-4 space-y-4'> {searchResults.map((result) => ( <Card key={result.id}> <CardContent className='flex items-center p-4'> {result.type === 'participant' && result.avatar && ( <Avatar className='h-10 w-10 mr-4'> <img src={result.avatar} alt={result.name} /> </Avatar> )} {result.type === 'firm' && ( <div className='h-10 w-10 mr-4 bg-blue-100 rounded-full flex items-center justify-center'> <span className='text-blue-600 font-bold'> {result.name[0]} </span> </div> )} <div> <h3 className='font-semibold'>{result.name}</h3> <p className='text-sm text-gray-600'>{result.details}</p> </div> </CardContent> </Card> ))} </div> ); return ( <div className='min-h-screen bg-gray-50 p-4'> <div className='flex items-center mb-6'> <Button variant='ghost' onClick={() => { router.push('/menu'); }} className='mr-2' > <ArrowLeft className='h-6 w-6' /> </Button> <h1 className='text-2xl font-bold'>–ü–æ–∏—Å–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏ —Ñ–∏—Ä–º</h1> </div> <div className='flex mb-4'> <Input type='text' placeholder='–ü–æ–∏—Å–∫ –ø–æ –∫–æ–¥—É –∏–ª–∏ —Ñ–∞–º–∏–ª–∏–∏' value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} className='mr-2' /> <Button onClick={handleSearch}> <Search className='h-4 w-4 mr-2' /> –ü–æ–∏—Å–∫ </Button> </div> {isSearching && searchResults.length === 0 && ( <p className='text-center text-gray-600 mt-4'>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p> )} {isSearching && searchResults.length > 0 && renderSearchResults()} </div> ); }
```

# app\select-lang\page.tsx

```tsx
'use client'; import Link from 'next/link'; import { useUser } from '@/contexts/UserContext'; import { useRouter } from 'next/navigation'; import { useEffect } from 'react'; export default function LanguageSelection() { const { userState, setLanguage } = useUser(); const router = useRouter(); useEffect(() => { if (userState.isAuthenticated) { router.push('/home'); } }, [userState.isAuthenticated, router]); const handleLanguageSelect = (language: 'ru' | 'uz') => { setLanguage(language); }; return ( <div className='flex flex-col min-h-screen bg-red-700'> <main className='flex-grow flex items-center justify-center p-4'> <div className='bg-red-700 rounded-lg shadow-lg p-6 max-w-sm w-full border-2 border-white'> <h1 className='text-3xl font-bold mb-4 text-center text-white'> –í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫ </h1> <section className='mb-8 text-center text-white'> <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º—ã–π —è–∑—ã–∫</p> </section> </div> </main> <footer className='p-4 fixed bottom-0 left-0 right-0 flex justify-between'> <Link href='/select-person' onClick={() => handleLanguageSelect('ru')} className='w-[48%] bg-blue-500 hover:bg-blue-600 text-white text-center py-3 rounded-lg text-lg font-semibold transition duration-300' > ru –†–£ </Link> <Link href='/select-person' onClick={() => handleLanguageSelect('uz')} className='w-[48%] bg-blue-500 hover:bg-blue-600 text-white text-center py-3 rounded-lg text-lg font-semibold transition duration-300' > uz –£–ó </Link> </footer> </div> ); }
```

# app\select-person\page.tsx

```tsx
'use client'; import Link from 'next/link'; import { User, Building2 } from 'lucide-react'; import { useUser } from '@/contexts/UserContext'; import { useRouter } from 'next/navigation'; import { useEffect } from 'react'; export default function PersonTypeSelection() { const { userState, setUserType } = useUser(); const router = useRouter(); useEffect(() => { if (userState.isAuthenticated) { router.push('/home'); } }, [userState.isAuthenticated, router]); const handleTypeSelect = (type: 'individual' | 'legal') => { setUserType(type); }; return ( <div className='flex flex-col min-h-screen bg-red-700'> <main className='flex-grow flex items-center justify-center p-4'> <div className='bg-red-700 rounded-lg shadow-lg p-6 max-w-sm w-full border-2 border-white'> <h1 className='text-3xl font-bold mb-4 text-center text-white'> –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ª–∏—Ü–∞ </h1> <section className='mb-8 text-center text-white'> <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ª–∏—Ü–∞</p> </section> </div> </main> <footer className='p-4 fixed bottom-0 left-0 right-0 flex justify-between'> <Link href='/select-role?type=individual' onClick={() => handleTypeSelect('individual')} className='w-[48%] bg-blue-500 hover:bg-blue-600 text-white text-center py-3 rounded-lg text-lg font-semibold transition duration-300 flex items-center justify-center' > <User className='mr-2' size={24} /> –§–∏–∑. –ª–∏—Ü–æ </Link> <Link href='/select-role?type=legal' onClick={() => handleTypeSelect('legal')} className='w-[48%] bg-blue-500 hover:bg-blue-600 text-white text-center py-3 rounded-lg text-lg font-semibold transition duration-300 flex items-center justify-center' > <Building2 className='mr-2' size={24} /> –Æ—Ä. –ª–∏—Ü–æ </Link> </footer> </div> ); }
```

# app\select-role\page.tsx

```tsx
'use client'; import Link from 'next/link'; import { useSearchParams, useRouter } from 'next/navigation'; import { useEffect } from 'react'; import { useUser } from '@/contexts/UserContext'; import { User, Truck, Building2, Package, Briefcase, TrendingUp, ArrowLeft, } from 'lucide-react'; import { Button } from '@/components/ui/button'; import { Card } from '@/components/ui/card'; export default function UserRoleSelection() { const searchParams = useSearchParams(); const router = useRouter(); const { userState, setUserRole } = useUser(); useEffect(() => { if (userState.isAuthenticated) { router.push('/home'); } // if (!userState.type || !userState.language) { // router.push('/select-lang'); // } console.log(userState.language, 'userstatelang') console.log(userState.type, 'userstatetype') }, [userState, router]); const handleRoleSelect = (role: string) => { setUserRole(role as any); if (role === 'student') { router.push('/student-password'); } else if (role === 'carrier') { router.push('/carrier-welcome'); } else { router.push('/start-mini'); } }; const renderIndividualButtons = () => ( <div className='grid grid-cols-2 gap-4 w-full mb-4'> <Button onClick={() => handleRoleSelect('student')} className='bg-blue-500 hover:bg-blue-600 text-white text-center py-6 px-4 rounded-lg text-sm font-semibold transition duration-300 flex flex-col items-center justify-center h-32' > <User size={32} className='mb-2' /> <span>–°—Ç—É–¥–µ–Ω—Ç</span> <span className='text-xs mt-1 text-blue-100'> –î–ª—è —É—á–∞—â–∏—Ö—Å—è Logit School </span> </Button> <Button onClick={() => handleRoleSelect('carrier')} className='bg-blue-500 hover:bg-blue-600 text-white text-center py-6 px-4 rounded-lg text-sm font-semibold transition duration-300 flex flex-col items-center justify-center h-32' > <Truck size={32} className='mb-2' /> <span>–ü–µ—Ä–µ–≤–æ–∑—á–∏–∫</span> <span className='text-xs mt-1 text-blue-100'> –î–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ </span> </Button> </div> ); const renderLegalButtons = () => ( <div className='grid grid-cols-2 gap-4 w-full mb-4'> <Button onClick={() => handleRoleSelect('cargo-owner')} className='bg-blue-500 hover:bg-blue-600 text-white text-center py-6 px-4 rounded-lg text-sm font-semibold transition duration-300 flex flex-col items-center justify-center h-32' > <Package size={32} className='mb-2' /> <span>–ì—Ä—É–∑–æ–≤–ª–∞–¥–µ–ª–µ—Ü</span> <span className='text-xs mt-1 text-blue-100'> –î–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –≥—Ä—É–∑–æ–≤ </span> </Button> <Button onClick={() => handleRoleSelect('logistics-company')} className='bg-blue-500 hover:bg-blue-600 text-white text-center py-6 px-4 rounded-lg text-sm font-semibold transition duration-300 flex flex-col items-center justify-center h-32' > <Briefcase size={32} className='mb-2' /> <span>–≠–∫—Å–ø–µ–¥–∏—Ç–æ—Ä—Å–∫–∞—è –∫–æ–º–ø–∞–Ω–∏—è</span> <span className='text-xs mt-1 text-blue-100'> –î–ª—è –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π </span> </Button> <Button onClick={() => handleRoleSelect('transport-company')} className='bg-blue-500 hover:bg-blue-600 text-white text-center py-6 px-4 rounded-lg text-sm font-semibold transition duration-300 flex flex-col items-center justify-center h-32' > <Truck size={32} className='mb-2' /> <span>–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è</span> <span className='text-xs mt-1 text-blue-100'> –î–ª—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π </span> </Button> <Button onClick={() => handleRoleSelect('logit-trans')} className='bg-blue-500 hover:bg-blue-600 text-white text-center py-6 px-4 rounded-lg text-sm font-semibold transition duration-300 flex flex-col items-center justify-center h-32' > <TrendingUp size={32} className='mb-2' /> <span>–õ–æ–≥–∏—Ç —Ç—Ä–∞–Ω—Å</span> <span className='text-xs mt-1 text-blue-100'>–î–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ Logit</span> </Button> </div> ); const renderContent = () => { const type = searchParams.get('type'); if (type === 'individual') { return renderIndividualButtons(); } if (type === 'legal') { return renderLegalButtons(); } return null; }; return ( <div className='min-h-screen bg-red-700'> <div className='p-4'> <Button variant='ghost' className='text-white mb-4' onClick={() => router.push('/select-person')} > <ArrowLeft className='mr-2' size={24} /> –ù–∞–∑–∞–¥ </Button> </div> <main className='flex-grow flex items-center justify-center p-4'> <Card className='bg-red-700 rounded-lg shadow-lg p-6 max-w-2xl w-full border-2 border-white'> <h1 className='text-3xl font-bold mb-4 text-center text-white'> –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à—É —Ä–æ–ª—å </h1> <section className='mb-8 text-center text-white'> <p className='mb-4'> –ü–æ–∂–∞–ª—É–π—Å—Ç–∞ –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ! –°–µ–π—á–∞—Å –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–±—Ä–∞—Ç—å –∫–µ–º –≤—ã —è–≤–ª—è–µ—Ç–µ—Å—å </p> <p>–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à —Å—Ç–∞—Ç—É—Å</p> </section> {renderContent()} </Card> </main> </div> ); }
```

# app\settings\page.tsx

```tsx
'use client'; import React, { useState } from 'react'; import { motion, AnimatePresence } from 'framer-motion'; import { Button } from '@/components/ui/button'; import { Card, CardContent } from '@/components/ui/card'; import { ArrowLeft, Bell, Globe, Star } from 'lucide-react'; import { useRouter } from 'next/navigation'; interface Language { code: string; name: string; flag: string; } const languages: Language[] = [ { code: 'en', name: 'English', flag: 'üá¨üáß' }, { code: 'uz', name: 'Ozbek', flag: 'üá∫üáø' }, { code: 'ru', name: '–†—É—Å—Å–∫–∏–π', flag: 'üá∑üá∫' }, ]; const NotificationToggle: React.FC<{ enabled: boolean; toggle: () => void; }> = ({ enabled, toggle }) => { return ( <motion.div className='relative w-64 h-64 bg-gradient-to-br from-purple-600 to-blue-600 rounded-full cursor-pointer overflow-hidden' onClick={toggle} whileHover={{ scale: 1.05 }} whileTap={{ scale: 0.95 }} > <motion.div className='absolute inset-0 bg-gradient-to-br from-yellow-400 to-orange-500' initial={{ scale: 0 }} animate={{ scale: enabled ? 1 : 0 }} transition={{ duration: 0.5, type: 'spring' }} /> <motion.div className='absolute inset-0 flex items-center justify-center' animate={{ rotate: enabled ? 360 : 0 }} transition={{ duration: 0.5 }} > <Bell className={`h-24 w-24 ${enabled ? 'text-white' : 'text-gray-300'}`} /> </motion.div> <AnimatePresence> {enabled && ( <motion.div className='absolute inset-0' initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} > {[...Array(12)].map((_, i) => ( <motion.div key={i} className='absolute' initial={{ x: '50%', y: '50%', scale: 0 }} animate={{ x: `${50 + 35 * Math.cos((i * 30 * Math.PI) / 180)}%`, y: `${50 + 35 * Math.sin((i * 30 * Math.PI) / 180)}%`, scale: [0, 1, 0], opacity: [0, 1, 0], }} transition={{ repeat: Infinity, duration: 2, delay: i * 0.1, }} > <Star className='h-4 w-4 text-white' /> </motion.div> ))} </motion.div> )} </AnimatePresence> </motion.div> ); }; const LanguageSelector: React.FC<{ selectedLanguage: string; setSelectedLanguage: (lang: string) => void; }> = ({ selectedLanguage, setSelectedLanguage }) => { const [showLanguages, setShowLanguages] = useState(false); return ( <div className='mt-6 relative'> <Button variant='outline' onClick={() => setShowLanguages(!showLanguages)} className='w-full justify-between' > <span> {languages.find((lang) => lang.code === selectedLanguage)?.name} </span> <Globe className='h-5 w-5' /> </Button> <AnimatePresence> {showLanguages && ( <motion.div initial={{ opacity: 0, y: -10 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -10 }} className='absolute top-full left-0 right-0 mt-2 bg-white rounded-lg shadow-xl overflow-hidden z-10' > {languages.map((lang) => ( <Button key={lang.code} variant='ghost' className='w-full justify-start' onClick={() => { setSelectedLanguage(lang.code); setShowLanguages(false); }} > <span className='mr-2'>{lang.flag}</span> {lang.name} </Button> ))} </motion.div> )} </AnimatePresence> </div> ); }; export default function AppSettingsPage() { const [notificationsEnabled, setNotificationsEnabled] = useState<boolean>(false); const [selectedLanguage, setSelectedLanguage] = useState<string>('ru'); const router = useRouter(); return ( <div className='min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 p-6 text-white'> <motion.div initial={{ opacity: 0, y: -20 }} animate={{ opacity: 1, y: 0 }} transition={{ duration: 0.5 }} className='flex items-center mb-8' > <Button variant='ghost' className='mr-4 text-white' onClick={() => { router.push('/menu'); }} > <ArrowLeft className='h-6 w-6' /> </Button> <h1 className='text-3xl font-bold'>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h1> </motion.div> <Card className='bg-gray-800 border-gray-700'> <CardContent className='p-6'> <h2 className='text-xl font-semibold mb-4 text-center'> –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è </h2> <div className='flex justify-center mb-4'> <NotificationToggle enabled={notificationsEnabled} toggle={() => setNotificationsEnabled(!notificationsEnabled)} /> </div> <p className='text-center text-lg'> {notificationsEnabled ? '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã' : '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—ã–∫–ª—é—á–µ–Ω—ã'} </p> <LanguageSelector selectedLanguage={selectedLanguage} setSelectedLanguage={setSelectedLanguage} /> </CardContent> </Card> </div> ); }
```

# app\start-mini\page.tsx

```tsx
'use client'; import Link from 'next/link'; import { ArrowRight } from 'lucide-react'; export default function StartMiniWebsite() { return ( <div className="flex flex-col min-h-screen bg-red-700"> <main className="flex-grow flex items-center justify-center p-4"> <div className="bg-red-700 rounded-lg shadow-lg p-6 max-w-sm w-full border-2 border-white"> <h1 className="text-3xl font-bold mb-4 text-center text-white">–£–≤–∞–∂–∞–µ–º—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏!</h1> <section className="mb-8 text-center text-white"> <p> –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –Ω–∞—à –º–∏–Ω–∏-–≤–µ–±—Å–∞–π—Ç –ø–æ —Å–ª–µ–¥—É—é—â–µ–π –∫–Ω–æ–ø–∫–µ "–Ω–∞—á–∞—Ç—å"üëá. </p><br/><p> –í—Å—è —Ä–∞–±–æ—Ç–∞ –±—É–¥–µ—Ç –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ —ç—Ç–æ—Ç –≤–µ–±—Å–∞–π—Ç. </p> <p className="mt-4 font-semibold"> –°–ø–∞—Å–∏–±–æ –∑–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ! </p> </section> </div> </main> <footer className="p-4 fixed bottom-0 left-0 right-0 flex flex-col"> <Link href="/registration" className="w-full bg-blue-500 hover:bg-blue-600 text-white text-center py-3 rounded-lg text-lg font-semibold transition duration-300 flex items-center justify-center" > –ù–∞—á–∞—Ç—å <ArrowRight className="ml-2" size={24} /> </Link> </footer> </div> ); }
```

# app\student-password\page.tsx

```tsx
'use client'; import { useState } from 'react'; import { useRouter } from 'next/navigation'; import { Phone } from 'lucide-react'; export default function StudentPasswordPage() { const [password, setPassword] = useState(''); const router = useRouter(); const handleSubmit = (e: any) => { e.preventDefault(); // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–æ–ª—è // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å—Ç–∞—Ä—Ç–∞ –º–∏–Ω–∏-–≤–µ–±—Å–∞–π—Ç–∞ router.push('/start-mini'); }; return ( <div className='flex flex-col min-h-screen bg-red-700'> <main className='flex-grow flex items-center justify-center p-4'> <div className='bg-red-700 rounded-lg shadow-lg p-6 max-w-sm w-full border-2 border-white'> <h1 className='text-3xl font-bold mb-4 text-center text-white'> –î–æ—Å—Ç—É–ø –∫ –±–æ—Ç—É </h1> <section className='mb-8 text-center text-white'> <p> –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –±–æ—Ç—É, –≤–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω –≤–∞—à–∏–º –∫—É—Ä–∞—Ç–æ—Ä–æ–º, –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –±–æ—Ç–∞. </p> </section> <form onSubmit={handleSubmit} className='mt-4'> <input type='number' value={password} onChange={(e) => setPassword(e.target.value)} className='w-full px-4 py-2 rounded-lg bg-white text-black text-center text-2xl tracking-widest' placeholder='–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å' required /> <button type='submit' className='w-full mt-4 bg-blue-500 hover:bg-blue-600 text-white text-center py-3 rounded-lg text-lg font-semibold transition duration-300' > –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å </button> </form> </div> </main> <footer className='p-4 fixed bottom-0 left-0 right-0'> <button onClick={() => alert('–í—ã–∑–æ–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞')} className='w-full bg-green-500 hover:bg-green-600 text-white text-center py-3 rounded-lg text-lg font-semibold transition duration-300 flex items-center justify-center' > <Phone className='mr-2' size={24} /> –í—ã–∑–≤–∞—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ </button> </footer> </div> ); }
```

# app\student\cargos\page.tsx

```tsx
'use client'; import React, { useState, useEffect } from 'react'; import { Button } from '@/components/ui/button'; import { Card, CardContent } from '@/components/ui/card'; import { Badge } from '@/components/ui/badge'; import { ScrollArea } from '@/components/ui/scroll-area'; import { Input } from '@/components/ui/input'; import { Dialog, DialogContent, DialogHeader, DialogTitle, } from '@/components/ui/dialog'; import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue, } from '@/components/ui/select'; import { Loader2, Search, Filter, ExternalLink, AlertCircle, } from 'lucide-react'; import NavigationMenu from '@/app/components/NavigationMenu'; import { useUser } from '@/contexts/UserContext'; import { api } from '@/lib/api'; import { toast } from 'sonner'; interface CargoResponse { results: Cargo[]; } interface CarrierRequestResponse { results: CarrierRequest[]; } interface Cargo { id: string; title: string; description: string; owner: { id: string; role: string; company_name?: string; full_name: string; }; weight: number; volume?: number; loading_point: string; unloading_point: string; loading_date: string; vehicle_type: string; payment_method: string; price?: number; status: string; created_at: string; } interface CarrierRequest { id: string; carrier: { id: string; full_name: string; company_name?: string; rating: number; }; vehicle: { id: string; registration_number: string; body_type: string; }; loading_point: string; unloading_point: string; ready_date: string; status: string; } export default function StudentCargosPage() { const [cargos, setCargos] = useState<CargoResponse>({ results: [] }); const [matchingRequests, setMatchingRequests] = useState<CarrierRequest[]>( [] ); const [allRequests, setAllRequests] = useState<CarrierRequestResponse>({ results: [], }); const [selectedCargo, setSelectedCargo] = useState<Cargo | null>(null); const [isLoading, setIsLoading] = useState(true); const [isLoadingRequests, setIsLoadingRequests] = useState(false); const [showCargoDetails, setShowCargoDetails] = useState(false); const [showMatchingRequests, setShowMatchingRequests] = useState(false); const [searchTerm, setSearchTerm] = useState(''); const [filters, setFilters] = useState({ vehicle_type: '', loading_point: '', unloading_point: '', }); const { userState } = useUser(); useEffect(() => { fetchCargos(); }, []); const fetchCargos = async () => { try { setIsLoading(true); const response = await api.get('/cargo/cargos', { params: { status: 'pending', assigned_to: null, ...filters, search: searchTerm, }, }); setCargos(response); console.log(response, 'res'); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≥—Ä—É–∑–æ–≤'); console.error('Fetch cargos error:', error); } finally { setIsLoading(false); } }; const fetchCarrierRequests = async (cargoId: string) => { try { setIsLoadingRequests(true); // Get matching carriers const matchingResponse = await api.get( `/cargo/cargos/${cargoId}/matching_carriers/` ); setMatchingRequests(matchingResponse.data); console.log(matchingRequests, 'mareq'); // Get all available carriers const allResponse = await api.get('/cargo/carrier-requests/', { params: { status: 'pending', assigned_cargo: null }, }); console.log(allResponse, 'allres'); setAllRequests(allResponse); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∑–∞—è–≤–æ–∫ –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–æ–≤'); console.error('Fetch carrier requests error:', error); } finally { setIsLoadingRequests(false); } }; const handleAssignCarrier = async (cargoId: string, requestId: string) => { try { await api.post(`/cargo/cargos/${cargoId}/assign_carrier/`, { carrier_request: requestId, }); toast.success('–ì—Ä—É–∑ —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫—É'); setShowMatchingRequests(false); fetchCargos(); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–∞'); console.error('Assign carrier error:', error); } }; const handleCargoClick = async (cargo: Cargo) => { setSelectedCargo(cargo); setShowCargoDetails(true); await fetchCarrierRequests(cargo.id); }; const renderCargoCard = (cargo: Cargo) => ( <Card key={cargo.id} className='mb-4 hover:shadow-lg transition-shadow cursor-pointer' onClick={() => handleCargoClick(cargo)} > <CardContent className='p-4'> <div className='flex justify-between items-start mb-2'> <div> <h3 className='font-bold text-lg'>{cargo.title}</h3> <p className='text-sm text-gray-600'> {cargo.owner.role === 'cargo-owner' ? '–ì—Ä—É–∑–æ–≤–ª–∞–¥–µ–ª–µ—Ü' : '–≠–∫—Å–ø–µ–¥–∏—Ç–æ—Ä'} : {cargo.owner.company_name || cargo.owner.full_name} </p> </div> <Badge>–ù–æ–≤—ã–π</Badge> </div> <div className='grid grid-cols-2 gap-2 mb-2 text-sm'> <p> –ì—Ä—É–∑: {cargo.weight} —Ç{cargo.volume ? `, ${cargo.volume} –º¬≥` : ''} </p> <p>–¢–∏–ø: {cargo.vehicle_type}</p> <p> –ú–∞—Ä—à—Ä—É—Ç: {cargo.loading_point} ‚Üí {cargo.unloading_point} </p> <p> –î–∞—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏: {new Date(cargo.loading_date).toLocaleDateString()} </p> </div> <div className='flex justify-between items-center mt-2'> <span className='font-semibold'> {cargo.price ? `${cargo.price} ‚ÇΩ` : '–¶–µ–Ω–∞ –¥–æ–≥–æ–≤–æ—Ä–Ω–∞—è'} </span> <span className='text-sm text-gray-500'> {new Date(cargo.created_at).toLocaleString()} </span> </div> </CardContent> </Card> ); const renderCargoDetails = () => { if (!selectedCargo) return null; return ( <Dialog open={showCargoDetails} onOpenChange={setShowCargoDetails}> <DialogContent className='max-w-3xl'> <DialogHeader> <DialogTitle>–î–µ—Ç–∞–ª–∏ –≥—Ä—É–∑–∞</DialogTitle> </DialogHeader> <div className='space-y-4'> <div className='grid grid-cols-2 gap-4'> <div> <h3 className='font-semibold'>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3> <p>–ù–∞–∑–≤–∞–Ω–∏–µ: {selectedCargo.title}</p> <p>–û–ø–∏—Å–∞–Ω–∏–µ: {selectedCargo.description}</p> <p>–í–µ—Å: {selectedCargo.weight} —Ç</p> {selectedCargo.volume && ( <p>–û–±—ä–µ–º: {selectedCargo.volume} –º¬≥</p> )} </div> <div> <h3 className='font-semibold'>–ú–∞—Ä—à—Ä—É—Ç</h3> <p>–ü–æ–≥—Ä—É–∑–∫–∞: {selectedCargo.loading_point}</p> <p>–í—ã–≥—Ä—É–∑–∫–∞: {selectedCargo.unloading_point}</p> <p> –î–∞—Ç–∞ –ø–æ–≥—Ä—É–∑–∫–∏:{' '} {new Date(selectedCargo.loading_date).toLocaleDateString()} </p> </div> </div> <div> <h3 className='font-semibold'>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è</h3> <p>–¢–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞: {selectedCargo.vehicle_type}</p> <p>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã: {selectedCargo.payment_method}</p> {selectedCargo.price && <p>–¶–µ–Ω–∞: {selectedCargo.price} ‚ÇΩ</p>} </div> <div className='flex justify-end space-x-2 mt-4'> <Button onClick={() => setShowMatchingRequests(true)}> –ù–∞–π—Ç–∏ –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–∞ </Button> </div> </div> </DialogContent> </Dialog> ); }; const renderMatchingRequests = () => { return ( <Dialog open={showMatchingRequests} onOpenChange={setShowMatchingRequests} > <DialogContent className='max-w-4xl'> <DialogHeader> <DialogTitle>–ü–æ–¥—Ö–æ–¥—è—â–∏–µ –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–∏</DialogTitle> </DialogHeader> {isLoadingRequests ? ( <div className='flex justify-center py-8'> <Loader2 className='h-8 w-8 animate-spin' /> </div> ) : ( <div className='space-y-4'> {matchingRequests?.length > 0 && ( <div> <h3 className='font-semibold mb-2'>–ü–æ–¥—Ö–æ–¥—è—â–∏–µ –∑–∞—è–≤–∫–∏</h3> <div className='space-y-2'> {matchingRequests?.map((request) => ( <Card key={request.id}> <CardContent className='p-4'> <div className='flex justify-between items-start'> <div> <h4 className='font-semibold'> {request.carrier.company_name || request.carrier.full_name} </h4> <p className='text-sm'> {request.vehicle.registration_number} -{' '} {request.vehicle.body_type} </p> <p className='text-sm'> {request.loading_point} ‚Üí{' '} {request.unloading_point} </p> </div> <Button onClick={() => selectedCargo && handleAssignCarrier( selectedCargo.id, request.id ) } > –í—ã–±—Ä–∞—Ç—å </Button> </div> </CardContent> </Card> ))} </div> </div> )} <div> <h3 className='font-semibold mb-2'>–í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞—è–≤–∫–∏</h3> <div className='space-y-2'> {allRequests?.results?.map((request) => ( <Card key={request.id}> <CardContent className='p-4'> <div className='flex justify-between items-start'> <div> <h4 className='font-semibold'> {request.carrier.company_name || request.carrier.full_name} </h4> <p className='text-sm'> {request.vehicle.registration_number} -{' '} {request.vehicle.body_type} </p> <p className='text-sm'> {request.loading_point} ‚Üí{' '} {request.unloading_point} </p> </div> <Button variant='outline' onClick={() => selectedCargo && handleAssignCarrier( selectedCargo?.id, request?.id ) } > –í—ã–±—Ä–∞—Ç—å </Button> </div> </CardContent> </Card> ))} </div> </div> </div> )} </DialogContent> </Dialog> ); }; if (isLoading) { return ( <div className='flex justify-center items-center min-h-screen'> <Loader2 className='h-8 w-8 animate-spin' /> </div> ); } return ( <div className='min-h-screen bg-gray-50 p-4 pb-20'> <div className='max-w-6xl mx-auto'> <h1 className='text-2xl font-bold mb-6'>–î–æ—Å—Ç—É–ø–Ω—ã–µ –≥—Ä—É–∑—ã</h1> <div className='mb-6 space-y-4'> <div className='flex gap-4'> <Input placeholder='–ü–æ–∏—Å–∫ –≥—Ä—É–∑–æ–≤...' value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} className='max-w-sm' /> <Button onClick={fetchCargos}> <Search className='h-4 w-4 mr-2' /> –ü–æ–∏—Å–∫ </Button> </div> <div className='flex gap-4'> <Select value={filters.vehicle_type} onValueChange={(value) => setFilters((f) => ({ ...f, vehicle_type: value })) } > <SelectTrigger className='w-[200px]'> <SelectValue placeholder='–¢–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞' /> </SelectTrigger> <SelectContent>{/* Add vehicle types */}</SelectContent> </Select> <Button variant='outline' onClick={() => setFilters({ vehicle_type: '', loading_point: '', unloading_point: '', }) } > –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã </Button> </div> </div> <div className='space-y-4'> {cargos?.results?.length === 0 ? ( <div className='text-center py-8 text-gray-500'> –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≥—Ä—É–∑–æ–≤ </div> ) : ( cargos?.results?.map(renderCargoCard) )} </div> {renderCargoDetails()} {renderMatchingRequests()} </div> <NavigationMenu userRole={userState.role === 'carrier' ? 'carrier' : 'other'} /> {/* <NavigationMenu userRole={userState.role} /> */} </div> ); }
```

# components.json

```json
{ "$schema": "https://ui.shadcn.com/schema.json", "style": "default", "rsc": true, "tsx": true, "tailwind": { "config": "tailwind.config.ts", "css": "app/globals.css", "baseColor": "neutral", "cssVariables": false, "prefix": "" }, "aliases": { "components": "@/components", "utils": "@/lib/utils", "ui": "@/components/ui", "lib": "@/lib", "hooks": "@/hooks" } }
```

# components\ErrorBoundary.tsx

```tsx
'use client'; import React from 'react'; import { Button } from '@/components/ui/button'; import { AlertTriangle } from 'lucide-react'; interface Props { children: React.ReactNode; } interface State { hasError: boolean; error?: Error; } export class ErrorBoundary extends React.Component<Props, State> { public state: State = { hasError: false, }; static getDerivedStateFromError(error: Error): State { return { hasError: true, error }; } componentDidCatch(error: Error, errorInfo: React.ErrorInfo) { console.error('ErrorBoundary caught an error:', error, errorInfo); } render() { if (this.state.hasError) { return ( <div className='min-h-screen bg-gray-100 flex items-center justify-center p-4'> <div className='bg-white rounded-lg shadow-xl p-6 max-w-md w-full text-center'> <AlertTriangle className='h-12 w-12 text-red-500 mx-auto mb-4' /> <h2 className='text-2xl font-bold text-gray-800 mb-2'> –ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫ </h2> <p className='text-gray-600 mb-4'> –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É. </p> <Button onClick={() => window.location.reload()} className='w-full'> –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É </Button> </div> </div> ); } return this.props.children; } }
```

# components\FileUpload.tsx

```tsx
'use client'; import React, { useRef, useState } from 'react'; import { Button } from '@/components/ui/button'; import { Progress } from '@/components/ui/progress'; import { FileService } from '@/lib/files'; import { X, Upload, FileIcon } from 'lucide-react'; import { toast } from 'sonner'; interface FileUploadProps { onUpload: (file: any) => void; // type: string; maxSize?: number; allowedTypes?: string[]; label?: string; } export function FileUpload({ onUpload, // type, maxSize = 5 * 1024 * 1024, allowedTypes = ['image/jpeg', 'image/png', 'application/pdf'], label = '–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª', }: FileUploadProps) { const [file, setFile] = useState<File | null>(null); const [progress, setProgress] = useState<number>(0); const [isUploading, setIsUploading] = useState<boolean>(false); const fileInputRef = useRef<HTMLInputElement>(null); const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => { const selectedFile = event.target.files?.[0]; if (!selectedFile) return; const error = FileService.validateFile(selectedFile, { maxSize, allowedTypes, }); if (error) { toast.error(error); return; } setFile(selectedFile); }; const handleUpload = async () => { if (!file) return; setIsUploading(true); try { // const result = await FileService.upload(file, type, setProgress); onUpload(file); // onUpload(result); toast.success('–§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω'); setFile(null); setProgress(0); } catch (error) { toast.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞'); console.error('Upload error:', error); } finally { setIsUploading(false); } }; const handleClear = () => { setFile(null); setProgress(0); if (fileInputRef.current) { fileInputRef.current.value = ''; } }; return ( <div className='space-y-4'> <div className='flex items-center gap-4'> <input type='file' onChange={handleFileSelect} accept={allowedTypes.join(',')} className='hidden' ref={fileInputRef} /> <Button variant='outline' onClick={() => fileInputRef.current?.click()} disabled={isUploading} > <Upload className='h-4 w-4 mr-2' /> {label} </Button> {file && ( <Button variant='destructive' size='sm' onClick={handleClear} disabled={isUploading} > <X className='h-4 w-4' /> </Button> )} </div> {file && ( <div className='bg-muted p-4 rounded-lg'> <div className='flex items-center justify-between mb-2'> <div className='flex items-center gap-2'> <FileIcon className='h-5 w-5' /> <span className='font-medium truncate'>{file.name}</span> </div> <span className='text-sm text-muted-foreground'> {FileService.formatFileSize(file.size)} </span> </div> {isUploading ? ( <div className='space-y-2'> <Progress value={progress} className='h-2' /> <p className='text-sm text-center text-muted-foreground'> {progress}% </p> </div> ) : ( <Button className='w-full mt-2' onClick={handleUpload}> –ó–∞–≥—Ä—É–∑–∏—Ç—å </Button> )} </div> )} <div className='text-sm text-muted-foreground'> <p>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: {allowedTypes.join(', ')}</p> <p>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: {FileService.formatFileSize(maxSize)}</p> </div> </div> ); }
```

# components\LoadingProvider.tsx

```tsx
// components/LoadingProvider.tsx 'use client'; import React, { createContext, useContext, useState, useEffect } from 'react'; import { usePathname, useSearchParams } from 'next/navigation'; import { motion } from 'framer-motion'; interface LoadingContextType { isLoading: boolean; setIsLoading: (loading: boolean) => void; } const LoadingContext = createContext<LoadingContextType | undefined>(undefined); export function LoadingProvider({ children }: { children: React.ReactNode }) { const [isLoading, setIsLoading] = useState(false); const pathname = usePathname(); const searchParams = useSearchParams(); useEffect(() => { setIsLoading(true); const timer = setTimeout(() => { setIsLoading(false); }, 300); return () => clearTimeout(timer); }, [pathname, searchParams]); return ( <LoadingContext.Provider value={{ isLoading, setIsLoading }}> {isLoading && ( <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className='fixed top-0 left-0 w-full h-1 bg-primary/80 z-50' > <motion.div className='h-full bg-primary' initial={{ width: '0%' }} animate={{ width: '100%' }} transition={{ duration: 0.3, ease: 'easeInOut' }} /> </motion.div> )} {children} </LoadingContext.Provider> ); } export const useLoading = () => { const context = useContext(LoadingContext); if (context === undefined) { throw new Error('useLoading must be used within a LoadingProvider'); } return context; };
```

# components\LoadingSpinner.tsx

```tsx
'use client'; import { Loader2 } from 'lucide-react'; interface LoadingSpinnerProps { size?: number; className?: string; } export default function LoadingSpinner({ size = 24, className = '', }: LoadingSpinnerProps) { return ( <div className={`flex items-center justify-center ${className}`}> <Loader2 className='animate-spin' size={size} /> </div> ); }
```

# components\RouteGuard.tsx

```tsx
'use client'; import { useUser } from '@/contexts/UserContext'; import { useRouter, usePathname } from 'next/navigation'; import { useEffect } from 'react'; const publicPaths = ['/select-lang', '/select-person', '/select-role']; export default function RouteGuard({ children, }: { children: React.ReactNode; }) { const { userState } = useUser(); const router = useRouter(); const pathname = usePathname(); useEffect(() => { if (!userState.isAuthenticated && !publicPaths.includes(pathname)) { if (!userState.language) { router.push('/select-lang'); } else if (!userState.type) { router.push('/select-person'); } else if (!userState.role) { router.push('/select-role'); } } }, [userState, router, pathname]); return <>{children}</>; }
```

# components\ToastProvider.tsx

```tsx
'use client'; import { Toaster } from 'sonner'; export function ToastProvider() { return ( <Toaster position='top-center' toastOptions={{ style: { background: 'white', color: 'black', border: '1px solid #E2E8F0', }, className: 'shadow-lg', }} /> ); }
```

# contexts\AppContext.tsx

```tsx
'use client'; import React, { createContext, useContext, useEffect, useState } from 'react'; import { useNotifications, Notification } from '@/hooks/useNotifications'; import { FavoriteItem, useFavorites } from '@/hooks/useFavorites'; interface AppContextType { notifications: Notification[]; notificationsCount: number; favoritesCount: number; favorites: FavoriteItem[]; addNotification: (notification: any) => void; markNotificationAsRead: (id: string) => void; markAllNotificationsAsRead: () => void; deleteNotification: (id: string) => void; clearAllNotifications: () => void; addToFavorites: (item: any) => void; removeFromFavorites: (id: number) => void; clearAllFavorites: () => void; isFavorite: (id: number) => boolean; } const AppContext = createContext<AppContextType | undefined>(undefined); export function AppProvider({ children }: { children: React.ReactNode }) { const { notifications: originalNotifications, unreadCount, addNotification: originalAddNotification, markAsRead: originalMarkAsRead, markAllAsRead: originalMarkAllAsRead, deleteNotification: originalDeleteNotification, clearAllNotifications: originalClearAllNotifications, } = useNotifications(); const { favorites: originalFavorites, addToFavorites: originalAddToFavorites, removeFromFavorites: originalRemoveFromFavorites, isFavorite: originalIsFavorite, clearAllFavorites: originalClearAllFavorites, } = useFavorites(); const [notifications, setNotifications] = useState(originalNotifications); const [favorites, setFavorites] = useState(originalFavorites); const [notificationsCount, setNotificationsCount] = useState(unreadCount); const [favoritesCount, setFavoritesCount] = useState( originalFavorites.length ); useEffect(() => { setNotifications(originalNotifications); setNotificationsCount(unreadCount); }, [originalNotifications, unreadCount]); useEffect(() => { setFavorites(originalFavorites); setFavoritesCount(originalFavorites.length); }, [originalFavorites]); // const hasNotification = (type: string, itemId: string): boolean => { // return notifications.some( // notification => notification.type === type && notification.orderId === itemId // ); // }; // const isFavorite = (type: string, itemId: string): boolean => { // return favorites.some( // favorite => favorite.type === type && favorite.orderId === itemId // ); // }; const addNotification = (notification: any) => { originalAddNotification(notification); // –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ setNotifications((prev) => [...prev, notification]); setNotificationsCount((prev) => prev + 1); }; const markNotificationAsRead = (id: string) => { originalMarkAsRead(id); setNotifications((prev) => prev.map((notif) => notif.id === id ? { ...notif, isRead: true } : notif ) ); setNotificationsCount((prev) => Math.max(0, prev - 1)); }; const markAllNotificationsAsRead = () => { originalMarkAllAsRead(); setNotifications((prev) => prev.map((notif) => ({ ...notif, isRead: true })) ); setNotificationsCount(0); }; const deleteNotification = (id: string) => { const notification = notifications.find((n) => n.id === id); originalDeleteNotification(id); setNotifications((prev) => prev.filter((notif) => notif.id !== id)); if (notification && !notification.isRead) { setNotificationsCount((prev) => Math.max(0, prev - 1)); } }; const clearAllNotifications = () => { originalClearAllNotifications(); setNotifications([]); setNotificationsCount(0); }; const addToFavorites = (item: any) => { originalAddToFavorites(item); setFavorites((prev) => [...prev, item]); setFavoritesCount((prev) => prev + 1); }; const removeFromFavorites = (id: number) => { originalRemoveFromFavorites(id); setFavorites((prev) => prev.filter((item) => item.orderId !== id)); setFavoritesCount((prev) => Math.max(0, prev - 1)); }; const clearAllFavorites = () => { originalClearAllFavorites(); setFavorites([]); setFavoritesCount(0); }; const value = { notifications, notificationsCount, favoritesCount, favorites, addNotification, markNotificationAsRead, markAllNotificationsAsRead, deleteNotification, clearAllNotifications, addToFavorites, removeFromFavorites, clearAllFavorites, isFavorite: originalIsFavorite, }; return <AppContext.Provider value={value}>{children}</AppContext.Provider>; } export function useApp() { const context = useContext(AppContext); if (context === undefined) { throw new Error('useApp must be used within an AppProvider'); } return context; }
```

# contexts\AuthContext.tsx

```tsx
// contexts/AuthContext.tsx 'use client'; import React, { createContext, useContext, useEffect, useState } from 'react'; import { api } from '@/lib/api'; import { useRouter } from 'next/navigation'; import { toast } from 'sonner'; interface User { id: string; telegram_id: string; username?: string; full_name: string; type?: 'individual' | 'legal'; role?: 'student' | 'carrier' | 'cargo-owner' | 'logistics-company'; is_verified: boolean; preferred_language?: string; [key: string]: any; } interface AuthContextType { user: User | null; isAuthenticated: boolean; isLoading: boolean; login: (telegramData: any) => Promise<void>; logout: () => void; updateUser: (data: Partial<User>) => Promise<void>; handleTelegramWebAppInit: () => Promise<void>; } const AuthContext = createContext<AuthContextType | undefined>(undefined); interface TelegramWebAppData { initData: string; initDataUnsafe: { query_id: string; user: { id: number; first_name: string; last_name?: string; username?: string; language_code?: string; }; auth_date: string; hash: string; }; } export function AuthProvider({ children }: { children: React.ReactNode }) { const [user, setUser] = useState<User | null>(null); const [isLoading, setIsLoading] = useState(true); const router = useRouter(); useEffect(() => { checkAuth(); }, []); const handleTelegramWebAppInit = async () => { try { if (typeof window !== 'undefined' && window.Telegram?.WebApp) { const webApp = window.Telegram.WebApp; if (webApp.initData) { const webAppData = { initData: webApp.initData, user: webApp.initDataUnsafe.user, auth_date: webApp.initDataUnsafe.auth_date, hash: webApp.initDataUnsafe.hash, }; await login(webAppData); } } } catch (error) { console.error('Telegram WebApp init error:', error); toast.error('Failed to initialize Telegram WebApp'); } }; const checkAuth = async () => { try { const token = localStorage.getItem('access_token'); if (!token) { setIsLoading(false); return; } const userData = await api.getCurrentUser(); setUser(userData); } catch (error) { console.error('Auth check error:', error); logout(); } finally { setIsLoading(false); } }; const login = async (telegramData: any) => { try { setIsLoading(true); const userData = await api.telegramAuth(telegramData); setUser(userData); // Redirect based on user type and verification status if (!userData.type || !userData.role) { router.push('/select-lang'); } else if (userData.role === 'carrier' && !userData.is_verified) { router.push('/driver-verification'); } else { router.push('/home'); } } catch (error) { console.error('Login error:', error); toast.error('Authentication failed. Please try again.'); } finally { setIsLoading(false); } }; const logout = () => { localStorage.removeItem('access_token'); localStorage.removeItem('refresh_token'); setUser(null); router.push('/select-lang'); }; const updateUser = async (data: Partial<User>) => { try { const updatedUser = await api.updateProfile(data); setUser(updatedUser); return updatedUser; } catch (error) { console.error('Update user error:', error); toast.error('Failed to update profile'); throw error; } }; const value = { user, isAuthenticated: !!user, isLoading, login, logout, updateUser, handleTelegramWebAppInit, }; return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>; } export function useAuth() { const context = useContext(AuthContext); if (context === undefined) { throw new Error('useAuth must be used within an AuthProvider'); } return context; }
```

# contexts\ThemeContext.tsx

```tsx
// contexts/ThemeContext.tsx 'use client'; import React, { createContext, useContext, useEffect, useState } from 'react'; import { Sun, Moon } from 'lucide-react'; import { Button } from '@/components/ui/button'; type Theme = 'light' | 'dark'; interface ThemeContextType { theme: Theme; toggleTheme: () => void; } const ThemeContext = createContext<ThemeContextType | undefined>(undefined); export function ThemeProvider({ children }: { children: React.ReactNode }) { const [theme, setTheme] = useState<Theme>('light'); useEffect(() => { const savedTheme = localStorage.getItem('theme') as Theme; if (savedTheme) { setTheme(savedTheme); document.documentElement.className = savedTheme; } }, []); const toggleTheme = () => { const newTheme = theme === 'light' ? 'dark' : 'light'; setTheme(newTheme); localStorage.setItem('theme', newTheme); document.documentElement.className = newTheme; }; return ( <ThemeContext.Provider value={{ theme, toggleTheme }}> <div className={theme}> {children} <Button variant='ghost' size='icon' className='fixed top-4 right-4 z-50 rounded-full bg-background/80 backdrop-blur-sm' onClick={toggleTheme} > {theme === 'light' ? ( <Sun className='h-5 w-5' /> ) : ( <Moon className='h-5 w-5' /> )} </Button> </div> </ThemeContext.Provider> ); } export const useTheme = () => { const context = useContext(ThemeContext); if (context === undefined) { throw new Error('useTheme must be used within a ThemeProvider'); } return context; };
```

# contexts\UserContext.tsx

```tsx
import React, { createContext, useContext, useEffect, useState } from 'react'; import { useRouter } from 'next/navigation'; import { AuthService } from '@/lib/auth'; import { UserState } from '@/types'; interface UserContextType { userState: UserState; setUserType: (type: UserState['type']) => void; setUserRole: (role: UserState['role']) => void; setLanguage: (language: UserState['language']) => void; setUserData: (data: any) => void; logout: () => void; isAuthenticated: boolean; } const USER_STORAGE_KEY = 'logit_user_state'; const UserContext = createContext<UserContextType | undefined>(undefined); export function UserProvider({ children }: { children: React.ReactNode }) { const [userState, setUserState] = useState<UserState>({}); const router = useRouter(); // useEffect(() => { // const initUser = async () => { // try { // // Check if we're in Telegram WebApp // if (typeof window !== 'undefined' && window.Telegram?.WebApp) { // const webApp = window.Telegram.WebApp; // console.log('WebApp data:', { // initData: webApp.initData, // initDataUnsafe: webApp.initDataUnsafe, // }); // // const initdata = webApp.initData; // // const initdataunsafe = webApp.initDataUnsafe // // const data = {initdataunsafe, initdata} // if (webApp) { // const response = await AuthService.telegramAuth(webApp); // console.log(response); // if (response.user) { // setUserData(response.user); // } // // await AuthService.telegramAuth(webApp).catch((err) => // // console.log(err) // // ); // // setUserState((prev) => ({ // // ...prev, // // isAuthenticated: true, // // userData: { // // fullName: response.user?.username || '', // // // telegramNumber: telegramUser.user?.id?.toString() || '', // // }, // // })); // // Store user state // // localStorage.setItem( // // USER_STORAGE_KEY, // // JSON.stringify({ // // isAuthenticated: true, // // }) // // ); // } // } // } catch (error) { // console.error('Init user error:', error); // } // }; // initUser(); // }, []); // Inside UserProvider component useEffect(() => { const initUser = async () => { try { if (typeof window !== 'undefined' && window.Telegram?.WebApp) { const webApp = window.Telegram.WebApp; if (webApp.initData && webApp.initDataUnsafe) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å const userExists = await AuthService.checkTelegramAuth( webApp ).catch((err) => { console.error('Auth check error:', err); return false; }); if (userExists) { // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ home console.log('user exists'); webApp.requestFullscreen(); router.push('/menu'); } else { // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ router.push('/select-lang'); } } } } catch (error) { console.error('Init user error:', error); } }; initUser(); }, []); const updateUserState = (newState: Partial<UserState>) => { const updatedState = { ...userState, ...newState }; setUserState((prev) => ({ ...prev, ...newState })); localStorage.setItem(USER_STORAGE_KEY, JSON.stringify(updatedState)); }; const setUserType = (type: UserState['type']) => { updateUserState({ type }); }; const setUserRole = (role: UserState['role']) => { updateUserState({ role }); }; const setLanguage = (language: UserState['language']) => { updateUserState({ language }); }; const setUserData = async (data: any) => { try { // const updatedUser = await AuthService.updateProfile(data); updateUserState({ type: data.type, role: data.role, language: data.preferred_language, isAuthenticated: true, }); console.log(data.type, 'test'); } catch (error) { console.error('Update user data error:', error); } }; const logout = () => { AuthService.logout(); localStorage.removeItem(USER_STORAGE_KEY); setUserState({}); router.push('/select-lang'); }; return ( <UserContext.Provider value={{ userState, setUserType, setUserRole, // updateUserState, setLanguage, setUserData, logout, isAuthenticated: Boolean(userState.isAuthenticated), }} > {children} </UserContext.Provider> ); } export function useUser() { const context = useContext(UserContext); if (context === undefined) { throw new Error('useUser must be used within a UserProvider'); } return context; }
```

# hooks\useFavorites.ts

```ts
import { useState, useEffect } from 'react'; export interface FavoriteItem { id: string; type: 'cargo' | 'route' | 'carrier'; title: string; description: string; createdAt: Date; details: Record<string, any>; orderId?: number; } const FAVORITES_STORAGE_KEY = 'logit_favorites'; export const useFavorites = () => { const [favorites, setFavorites] = useState<FavoriteItem[]>([]); useEffect(() => { const storedFavorites = localStorage.getItem(FAVORITES_STORAGE_KEY); if (storedFavorites) { setFavorites(JSON.parse(storedFavorites)); } }, []); const saveFavorites = (newFavorites: FavoriteItem[]) => { localStorage.setItem(FAVORITES_STORAGE_KEY, JSON.stringify(newFavorites)); setFavorites(newFavorites); }; const addToFavorites = (item: Omit<FavoriteItem, 'id' | 'createdAt'>) => { const newItem: FavoriteItem = { ...item, id: Date.now().toString(), createdAt: new Date(), }; // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ —É–∂–µ —Ç–∞–∫–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ const exists = favorites.some( (favorite) => favorite.type === item.type && favorite.title === item.title ); if (!exists) { const updatedFavorites = [...favorites, newItem]; saveFavorites(updatedFavorites); return true; } return false; }; const removeFromFavorites = (itemId: number) => { const updatedFavorites = favorites.filter( (item) => item.orderId !== itemId ); saveFavorites(updatedFavorites); }; const isFavorite = (itemId: number) => { return favorites.some((item) => item.orderId === itemId); }; const getFavoritesByType = (type: FavoriteItem['type']) => { return favorites.filter((item) => item.type === type); }; const clearAllFavorites = () => { saveFavorites([]); }; const updateFavoriteDetails = ( itemId: string, details: Record<string, any> ) => { const updatedFavorites = favorites.map((item) => item.id === itemId ? { ...item, details: { ...item.details, ...details } } : item ); saveFavorites(updatedFavorites); }; return { favorites, addToFavorites, removeFromFavorites, isFavorite, getFavoritesByType, clearAllFavorites, updateFavoriteDetails, }; };
```

# hooks\useNotifications.ts

```ts
import { useState, useEffect } from 'react'; export interface Notification { id: string; type: 'cargo' | 'route' | 'system'; message: string; createdAt: Date; isRead: boolean; orderId?: number; } const NOTIFICATIONS_STORAGE_KEY = 'logit_notifications'; export const useNotifications = () => { const [notifications, setNotifications] = useState<Notification[]>([]); useEffect(() => { const storedNotifications = localStorage.getItem(NOTIFICATIONS_STORAGE_KEY); if (storedNotifications) { setNotifications(JSON.parse(storedNotifications)); } }, []); const saveNotifications = (newNotifications: Notification[]) => { localStorage.setItem( NOTIFICATIONS_STORAGE_KEY, JSON.stringify(newNotifications) ); setNotifications(newNotifications); }; const addNotification = ( notification: Omit<Notification, 'id' | 'createdAt' | 'isRead'> ) => { const newNotification: Notification = { ...notification, id: Date.now().toString(), createdAt: new Date(), isRead: false, }; const updatedNotifications = [...notifications, newNotification]; saveNotifications(updatedNotifications); }; const markAsRead = (notificationId: string) => { const updatedNotifications = notifications.map((notification) => notification.id === notificationId ? { ...notification, isRead: true } : notification ); saveNotifications(updatedNotifications); }; const markAllAsRead = () => { const updatedNotifications = notifications.map((notification) => ({ ...notification, isRead: true, })); saveNotifications(updatedNotifications); }; const deleteNotification = (notificationId: string) => { const updatedNotifications = notifications.filter( (notification) => notification.id !== notificationId ); saveNotifications(updatedNotifications); }; const clearAllNotifications = () => { saveNotifications([]); }; const unreadCount = notifications.filter((n) => !n.isRead).length; return { notifications, unreadCount, addNotification, markAsRead, markAllAsRead, deleteNotification, clearAllNotifications, }; };
```

# lib\api.ts

```ts
import axios, { AxiosInstance } from 'axios'; const BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000/api'; export class ApiClient { private static instance: ApiClient; private api: AxiosInstance; private constructor() { this.api = axios.create({ baseURL: BASE_URL, headers: { 'Content-Type': 'application/json', 'ngrok-skip-browser-warning': '69420', }, }); // Request interceptor for adding auth token this.api.interceptors.request.use( (config) => { const token = localStorage.getItem('access_token'); if (token) { config.headers.Authorization = `Bearer ${token}`; } return config; }, (error) => Promise.reject(error) ); // Response interceptor for token refresh this.api.interceptors.response.use( (response) => response, async (error) => { const originalRequest = error.config; if (error.response?.status === 401 && !originalRequest._retry) { originalRequest._retry = true; try { const refreshToken = localStorage.getItem('refresh_token'); const response = await this.api.post('/auth/token/refresh/', { refresh: refreshToken, }); const { access } = response.data; localStorage.setItem('access_token', access); originalRequest.headers.Authorization = `Bearer ${access}`; return this.api(originalRequest); } catch (refreshError) { localStorage.removeItem('access_token'); localStorage.removeItem('refresh_token'); window.location.href = '/select-lang'; return Promise.reject(refreshError); } } return Promise.reject(error); } ); } public static getInstance(): ApiClient { if (!ApiClient.instance) { ApiClient.instance = new ApiClient(); } return ApiClient.instance; } // Generic request methods public async get(url: string, params?: any) { try { const response = await this.api.get(url, { params }); return response.data; } catch (error) { console.error('GET request error:', error); throw error; } } public async post(url: string, data?: any) { try { const response = await this.api.post(url, data); return response.data; } catch (error) { console.error('POST request error:', error); throw error; } } public async put(url: string, data: any) { try { const response = await this.api.put(url, data); return response.data; } catch (error) { console.error('PUT request error:', error); throw error; } } public async patch(url: string, data: any) { try { const response = await this.api.patch(url, data); return response.data; } catch (error) { console.error('PATCH request error:', error); throw error; } } public async delete(url: string) { try { const response = await this.api.delete(url); return response.data; } catch (error) { console.error('DELETE request error:', error); throw error; } } // Authentication public async telegramAuth(telegramData: any) { try { const response = await this.api.post( '/users/telegram_auth/', telegramData ); const { access, refresh, user } = response.data; localStorage.setItem('access_token', access); localStorage.setItem('refresh_token', refresh); return user; } catch (error) { console.error('Telegram auth error:', error); throw error; } } // User Profile public async getCurrentUser() { try { const response = await this.api.get('/users/me/'); return response.data; } catch (error) { console.error('Get profile error:', error); throw error; } } public async updateProfile(data: any) { try { const response = await this.api.put('/users/update_profile/', data); return response.data; } catch (error) { console.error('Update profile error:', error); throw error; } } // Cargo public async getCargos(params?: any) { try { const response = await this.api.get('/cargo/cargos/', { params }); return response.data; } catch (error) { console.error('Get cargos error:', error); throw error; } } public async createCargo(data: any) { try { console.log(data, 'createcargodata') const response = await this.api.post('/cargo/cargos/', data); return response.data; } catch (error) { console.error('Create cargo error:', error); throw error; } } public async updateCargo(id: string, data: any) { try { const response = await this.api.patch(`/cargo/${id}/`, data); return response.data; } catch (error) { console.error('Update cargo error:', error); throw error; } } // Vehicles public async getVehicles(params?: any) { try { const response = await this.api.get('/vehicles/', { params }); return response.data; } catch (error) { console.error('Get vehicles error:', error); throw error; } } public async createVehicle(data: any) { try { const response = await this.api.post('/vehicles/', data); return response.data; } catch (error) { console.error('Create vehicle error:', error); throw error; } } public async updateVehicle(id: string, data: any) { try { const response = await this.api.patch(`/vehicles/${id}/`, data); return response.data; } catch (error) { console.error('Update vehicle error:', error); throw error; } } public async deleteVehicle(id: string) { try { const response = await this.api.delete(`/vehicles/${id}/`); return response.data; } catch (error) { console.error('Delete vehicle error:', error); throw error; } } // Vehicle Documents public async addVehicleDocument( vehicleId: string, data: { file: File; type: | 'tech_passport' | 'license' | 'insurance' | 'adr_cert' | 'dozvol' | 'tir' | 'other'; title: string; expiry_date?: string; } ) { try { const formData = new FormData(); formData.append('file', data.file); formData.append('type', data.type); formData.append('title', data.title); if (data.expiry_date) { formData.append('expiry_date', data.expiry_date); } const response = await this.api.post( `/vehicles/${vehicleId}/add_document/`, formData, { headers: { 'Content-Type': 'multipart/form-data', }, } ); return response.data; } catch (error) { console.error('Add vehicle document error:', error); throw error; } } // Carrier Requests public async getCarrierRequests(params?: any) { try { const response = await this.api.get('/carrier-requests/', { params }); return response.data; } catch (error) { console.error('Get carrier requests error:', error); throw error; } } public async createCarrierRequest(data: any) { try { const response = await this.api.post('/carrier-requests/', data); return response.data; } catch (error) { console.error('Create carrier request error:', error); throw error; } } public async updateCarrierRequest(id: string, data: any) { try { const response = await this.api.patch(`/carrier-requests/${id}/`, data); return response.data; } catch (error) { console.error('Update carrier request error:', error); throw error; } } public async deleteCarrierRequest(id: string) { try { const response = await this.api.delete(`/carrier-requests/${id}/`); return response.data; } catch (error) { console.error('Delete carrier request error:', error); throw error; } } // Notifications public async getNotifications() { try { const response = await this.api.get('/core/notifications/'); return response.data; } catch (error) { console.error('Get notifications error:', error); throw error; } } public async markNotificationAsRead(id: string) { try { const response = await this.api.post( `/core/notifications/${id}/mark-read/` ); return response.data; } catch (error) { console.error('Mark notification error:', error); throw error; } } // Favorites public async getFavorites() { try { const response = await this.api.get('/core/favorites/'); return response.data; } catch (error) { console.error('Get favorites error:', error); throw error; } } public async addToFavorites(data: any) { try { const response = await this.api.post('/core/favorites/', data); return response.data; } catch (error) { console.error('Add to favorites error:', error); throw error; } } // Search public async searchCargo(filters: any) { try { const response = await this.api.post('/cargo/search/', filters); return response.data; } catch (error) { console.error('Search cargo error:', error); throw error; } } public async addUserDocument(data: { file: File; type: 'driver_license' | 'passport' | 'company_certificate' | 'other'; title: string; }) { try { const formData = new FormData(); formData.append('file', data.file); formData.append('type', data.type); formData.append('title', data.title); const response = await this.api.post( '/users/upload_document/', formData, { headers: { 'Content-Type': 'multipart/form-data', }, } ); return response.data; } catch (error) { console.error('Add user document error:', error); throw error; } } public async getUserDocuments() { try { const response = await this.api.get('/users/documents/'); return response.data; } catch (error) { console.error('Get user documents error:', error); throw error; } } public async deleteUserDocument(id: string) { try { const response = await this.api.delete(`/users/documents/${id}/`); return response.data; } catch (error) { console.error('Delete user document error:', error); throw error; } } // public async updateCargo(id: string, data: any) { // try { // const response = await this.api.patch(`/cargo/${id}/`, data); // return response.data; // } catch (error) { // console.error('Update cargo error:', error); // throw error; // } // } } export const api = ApiClient.getInstance();
```

# lib\auth.ts

```ts
import axios, { AxiosError } from 'axios'; import { toast } from 'sonner'; interface TelegramUser { id: number; first_name: string; last_name?: string; username?: string; language_code?: string; } interface TelegramAuthResponse { access: string; refresh: string; user: any; } interface RegistrationData { telegramData: any; userData: any; } const API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000/api'; // Create axios instance with default config const api = axios.create({ baseURL: API_URL, headers: { 'Content-Type': 'application/json', 'ngrok-skip-browser-warning': '69420', }, withCredentials: true, // Important for CORS }); export class AuthService { private static async prepareAuthPayload(telegramData: any) { return { init_data: telegramData?.initData, user: telegramData?.initDataUnsafe.user, auth_date: Number(telegramData?.initDataUnsafe.auth_date), hash: telegramData?.initDataUnsafe.hash, }; } private static async handleAuthResponse(response: any) { const { access, refresh, user } = response.data; localStorage.setItem('access_token', access); localStorage.setItem('refresh_token', refresh); return response.data; } static async checkTelegramAuth(telegramData: any): Promise<boolean> { try { const authPayload = await this.prepareAuthPayload(telegramData); console.log('Checking auth payload:', authPayload); const response = await api.post('/users/telegram_auth/', authPayload); // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω, —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–∫–µ–Ω—ã –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º true await this.handleAuthResponse(response); return true; } catch (error) { if (error instanceof AxiosError) { if (error.response?.status === 404) { // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω - —ç—Ç–æ –æ–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç return false; } // –î—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ const message = error.response?.data?.detail || 'Authentication check failed'; toast.error(message); console.error('Auth check error:', error.response?.data); } throw error; } } private static delay(ms: number): Promise<void> { return new Promise((resolve) => setTimeout(resolve, ms)); } static async registerUser( data: RegistrationData ): Promise<TelegramAuthResponse> { try { // –®–∞–≥ 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å Telegram –¥–∞–Ω–Ω—ã–º–∏ const authPayload = await this.prepareAuthPayload(data.telegramData); const registrationResponse = await api.post('/users/register/', { ...authPayload, userData: data.userData, }); console.log(registrationResponse, 'regres'); // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–∫–µ–Ω—ã –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ await this.handleAuthResponse(registrationResponse); // Add delay before profile update (2 seconds) // await this.delay(2000); // // Configure headers with new token // const token = localStorage.getItem('access_token'); // api.defaults.headers.common['Authorization'] = `Bearer ${token}`; // // Step 2: Update user profile // const updateResponse = await api.put('/users/update_profile/', { // ...data.userData, // }); return { ...registrationResponse.data, // user: updateResponse.data, }; } catch (error) { if (error instanceof AxiosError) { const message = error.response?.data?.detail || 'Registration failed'; toast.error(message); console.error('Registration error:', error.response?.data); } throw error; } } static async refreshToken(): Promise<string> { try { const refresh = localStorage.getItem('refresh_token'); if (!refresh) throw new Error('No refresh token'); const response = await api.post<{ access: string }>( '/auth/token/refresh/', { refresh, } ); const { access } = response.data; localStorage.setItem('access_token', access); return access; } catch (error) { localStorage.removeItem('access_token'); localStorage.removeItem('refresh_token'); throw error; } } static async updateProfile(data: any) { try { const token = localStorage.getItem('access_token'); const response = await api.put('/users/update_profile/', data, { headers: { Authorization: `Bearer ${token}`, }, }); return response.data; } catch (error) { if (error instanceof AxiosError) { const message = error.response?.data?.detail || 'Failed to update profile'; toast.error(message); } throw error; } } static async getProfile() { try { const token = localStorage.getItem('access_token'); if (!token) throw new Error('No auth token'); const response = await api.get('/users/me/', { headers: { Authorization: `Bearer ${token}`, }, }); return response.data; } catch (error) { if (error instanceof AxiosError) { const message = error.response?.data?.detail || 'Failed to get profile'; toast.error(message); } throw error; } } static logout() { localStorage.removeItem('access_token'); localStorage.removeItem('refresh_token'); } } // Add axios interceptor for token refresh api.interceptors.response.use( (response) => response, async (error) => { const originalRequest = error.config; if (error.response?.status === 401 && !originalRequest._retry) { originalRequest._retry = true; try { const access = await AuthService.refreshToken(); originalRequest.headers.Authorization = `Bearer ${access}`; return api(originalRequest); } catch (refreshError) { AuthService.logout(); window.location.href = '/select-lang'; return Promise.reject(refreshError); } } return Promise.reject(error); } ); export default AuthService;
```

# lib\errors.ts

```ts
export class ApiError extends Error { constructor( public statusCode: number, message: string, public code?: string ) { super(message); this.name = 'ApiError'; } } export class ValidationError extends ApiError { constructor(message: string) { super(400, message, 'VALIDATION_ERROR'); this.name = 'ValidationError'; } } export class AuthenticationError extends ApiError { constructor(message: string = 'Authentication required') { super(401, message, 'AUTHENTICATION_ERROR'); this.name = 'AuthenticationError'; } } export class AuthorizationError extends ApiError { constructor(message: string = 'Not authorized') { super(403, message, 'AUTHORIZATION_ERROR'); this.name = 'AuthorizationError'; } } export class NotFoundError extends ApiError { constructor(resource: string) { super(404, `${resource} not found`, 'NOT_FOUND'); this.name = 'NotFoundError'; } }
```

# lib\files.ts

```ts
import axios from 'axios'; const API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000/api'; export interface FileUploadResponse { id: string; url: string; filename: string; mimetype: string; size: number; } export class FileService { static async upload( file: File, type: string, onProgress?: (progress: number) => void ): Promise<FileUploadResponse> { const formData = new FormData(); formData.append('file', file); formData.append('type', type); const response = await axios.post(`${API_URL}/upload/`, formData, { headers: { 'ngrok-skip-browser-warning': '69420', 'Content-Type': 'multipart/form-data', }, onUploadProgress: (progressEvent) => { if (onProgress && progressEvent.total) { const progress = Math.round( (progressEvent.loaded * 100) / progressEvent.total ); onProgress(progress); } }, }); return response.data; } static async delete(fileId: string): Promise<void> { await axios.delete(`${API_URL}/upload/${fileId}/`, { headers: { 'ngrok-skip-browser-warning': '69420', }, }); } static getFileType(file: File): string { if (file.type.startsWith('image/')) { return 'image'; } if (file.type === 'application/pdf') { return 'pdf'; } return 'document'; } static validateFile( file: File, options: { maxSize?: number; allowedTypes?: string[]; } = {} ): string | null { const { maxSize = 5 * 1024 * 1024, // 5MB default allowedTypes = ['image/jpeg', 'image/png', 'application/pdf'], } = options; if (!allowedTypes.includes(file.type)) { return '–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–∏–ø —Ñ–∞–π–ª–∞'; } if (file.size > maxSize) { return `–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–≤—ã—à–∞—Ç—å ${maxSize / (1024 * 1024)}MB`; } return null; } static formatFileSize(bytes: number): string { if (bytes === 0) return '0 Bytes'; const k = 1024; const sizes = ['Bytes', 'KB', 'MB', 'GB']; const i = Math.floor(Math.log(bytes) / Math.log(k)); return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]; } static getFileExtension(filename: string): string { return filename.split('.').pop()?.toLowerCase() || ''; } static getFileIcon(file: File): string { const type = file.type; if (type.startsWith('image/')) return 'üñºÔ∏è'; if (type === 'application/pdf') return 'üìÑ'; if (type.includes('spreadsheet') || type.includes('excel')) return 'üìä'; if (type.includes('document') || type.includes('word')) return 'üìù'; return 'üìé'; } }
```

# lib\geocoding.ts

```ts
interface Coordinates { lat: number; lng: number; } interface GeocodingCache { [key: string]: Coordinates; } // –ü—Ä–æ—Å—Ç–æ–π –∫—ç—à –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç const coordinatesCache: GeocodingCache = { –º–æ—Å–∫–≤–∞: { lat: 55.7558, lng: 37.6173 }, '—Å–∞–Ω–∫—Ç-–ø–µ—Ç–µ—Ä–±—É—Ä–≥': { lat: 59.9343, lng: 30.3351 }, —Ç–∞—à–∫–µ–Ω—Ç: { lat: 41.2995, lng: 69.2401 }, —Å–∞–º–∞—Ä–∫–∞–Ω–¥: { lat: 39.627, lng: 66.975 }, –±—É—Ö–∞—Ä–∞: { lat: 39.768, lng: 64.421 }, }; export async function getCoordinates( city: string ): Promise<Coordinates | null> { const normalizedCity = city.toLowerCase().trim(); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à if (coordinatesCache[normalizedCity]) { return coordinatesCache[normalizedCity]; } // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã –∑–∞–ø—Ä–æ—Å –∫ –≥–µ–æ–∫–æ–¥–∏–Ω–≥ —Å–µ—Ä–≤–∏—Å—É // –Ω–∞–ø—Ä–∏–º–µ—Ä, Google Maps Geocoding API –∏–ª–∏ OpenStreetMap Nominatim return null; } export function calculateDistance(from: Coordinates, to: Coordinates): number { const R = 6371; // –†–∞–¥–∏—É—Å –ó–µ–º–ª–∏ –≤ –∫–∏–ª–æ–º–µ—Ç—Ä–∞—Ö const dLat = toRad(to.lat - from.lat); const dLon = toRad(to.lng - from.lng); const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(toRad(from.lat)) * Math.cos(toRad(to.lat)) * Math.sin(dLon / 2) * Math.sin(dLon / 2); const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a)); const distance = R * c; return Math.round(distance); } function toRad(degrees: number): number { return (degrees * Math.PI) / 180; } export function isWithinRadius( point: Coordinates, center: Coordinates, radius: number ): boolean { const distance = calculateDistance(point, center); return distance <= radius; } export function findNearestCities( city: string, radius: number = 100 ): string[] { const coordinates = coordinatesCache[city.toLowerCase()]; if (!coordinates) return []; return Object.entries(coordinatesCache) .filter(([name, coords]) => { if (name === city.toLowerCase()) return false; return isWithinRadius(coords, coordinates, radius); }) .map(([name]) => name); } export function getRegionForCity(city: string): string { // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã –±–æ–ª–µ–µ –ø–æ–ª–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ä–µ–≥–∏–æ–Ω–æ–≤ const regions: Record<string, string> = { –º–æ—Å–∫–≤–∞: '–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', '—Å–∞–Ω–∫—Ç-–ø–µ—Ç–µ—Ä–±—É—Ä–≥': '–õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', —Ç–∞—à–∫–µ–Ω—Ç: '–¢–∞—à–∫–µ–Ω—Ç—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', —Å–∞–º–∞—Ä–∫–∞–Ω–¥: '–°–∞–º–∞—Ä–∫–∞–Ω–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', –±—É—Ö–∞—Ä–∞: '–ë—É—Ö–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', }; return regions[city.toLowerCase()] || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ä–µ–≥–∏–æ–Ω'; }
```

# lib\jwt.ts

```ts
import jwt from 'jsonwebtoken'; const JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key'; export interface JWTPayload { userId: string; role: string; } export function signToken(payload: JWTPayload): string { return jwt.sign(payload, JWT_SECRET, { expiresIn: '7d' }); } export function verifyToken(token: string): JWTPayload { try { return jwt.verify(token, JWT_SECRET) as JWTPayload; } catch (error) { throw new Error('Invalid token'); } } export function extractToken(authHeader: string | null): string { if (!authHeader || !authHeader.startsWith('Bearer ')) { throw new Error('No token provided'); } return authHeader.split(' ')[1]; }
```

# lib\utils.ts

```ts
import { clsx, type ClassValue } from 'clsx'; import { twMerge } from 'tailwind-merge'; export function cn(...inputs: ClassValue[]) { return twMerge(clsx(inputs)); } export const formatDate = (date: Date | string): string => { const d = new Date(date); return d.toLocaleDateString('ru-RU', { day: '2-digit', month: '2-digit', year: 'numeric', hour: '2-digit', minute: '2-digit', }); }; export const formatCurrency = ( amount: number, currency: string = 'USD' ): string => { return new Intl.NumberFormat('ru-RU', { style: 'currency', currency, minimumFractionDigits: 0, maximumFractionDigits: 0, }).format(amount); }; export const generateId = (): string => { return Math.random().toString(36).substr(2, 9); }; export const formatPhoneNumber = (phone: string): string => { const cleaned = phone.replace(/\D/g, ''); if (cleaned.length === 0) return ''; let formatted = cleaned; if (cleaned.length >= 11) { formatted = `+${cleaned.slice(0, 1)} (${cleaned.slice( 1, 4 )}) ${cleaned.slice(4, 7)}-${cleaned.slice(7, 9)}-${cleaned.slice(9, 11)}`; } return formatted; }; export const isValidEmail = (email: string): boolean => { const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/; return re.test(email); }; export const truncateText = (text: string, maxLength: number): string => { if (text.length <= maxLength) return text; return text.slice(0, maxLength) + '...'; }; export const debounce = <T extends (...args: any[]) => any>( func: T, wait: number ): ((...args: Parameters<T>) => void) => { let timeout: NodeJS.Timeout; return (...args: Parameters<T>) => { clearTimeout(timeout); timeout = setTimeout(() => func(...args), wait); }; }; export const getDistanceInKm = ( lat1: number, lon1: number, lat2: number, lon2: number ): number => { const R = 6371; // Earth's radius in km const dLat = ((lat2 - lat1) * Math.PI) / 180; const dLon = ((lon2 - lon1) * Math.PI) / 180; const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos((lat1 * Math.PI) / 180) * Math.cos((lat2 * Math.PI) / 180) * Math.sin(dLon / 2) * Math.sin(dLon / 2); const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a)); return Math.round(R * c); }; export const validatePassword = (password: string): boolean => { const minLength = 8; const hasUpperCase = /[A-Z]/.test(password); const hasLowerCase = /[a-z]/.test(password); const hasNumbers = /\d/.test(password); return ( password.length >= minLength && hasUpperCase && hasLowerCase && hasNumbers ); }; export const getCityTimezone = (city: string): string => { const timezones: Record<string, string> = { –ú–æ—Å–∫–≤–∞: 'Europe/Moscow', '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥': 'Europe/Moscow', –¢–∞—à–∫–µ–Ω—Ç: 'Asia/Tashkent', –°–∞–º–∞—Ä–∫–∞–Ω–¥: 'Asia/Samarkand', –ë—É—Ö–∞—Ä–∞: 'Asia/Bukhara', }; return timezones[city] || 'UTC'; }; export const formatFileSize = (bytes: number): string => { if (bytes === 0) return '0 Bytes'; const k = 1024; const sizes = ['Bytes', 'KB', 'MB', 'GB']; const i = Math.floor(Math.log(bytes) / Math.log(k)); return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]; };
```

# middleware\auth.ts

```ts
import { NextRequest, NextResponse } from 'next/server'; import { verifyToken, extractToken } from '@/lib/jwt'; import { AuthenticationError, AuthorizationError } from '@/lib/errors'; export async function authenticateRequest( request: NextRequest, allowedRoles?: string[] ) { try { const authHeader = request.headers.get('authorization'); const token = extractToken(authHeader); const payload = verifyToken(token); if (allowedRoles && !allowedRoles.includes(payload.role)) { throw new AuthorizationError(); } return payload; } catch (error) { if (error instanceof AuthorizationError) { throw error; } throw new AuthenticationError(); } } export function withAuth(handler: Function, allowedRoles?: string[]) { return async function (request: NextRequest, ...args: any[]) { try { const payload = await authenticateRequest(request, allowedRoles); return handler(request, payload, ...args); } catch (error) { if ( error instanceof AuthenticationError || error instanceof AuthorizationError ) { return NextResponse.json( { error: error.message }, { status: error.statusCode } ); } return NextResponse.json( { error: 'Internal server error' }, { status: 500 } ); } }; }
```

# next-env.d.ts

```ts
/// <reference types="next" /> /// <reference types="next/image-types/global" /> // NOTE: This file should not be edited // see https://nextjs.org/docs/app/building-your-application/configuring/typescript for more information.
```

# next.config.mjs

```mjs
/** @type {import('next').NextConfig} */ const nextConfig = {}; export default nextConfig;
```

# package.json

```json
{ "name": "logit", "version": "0.1.0", "private": true, "scripts": { "dev": "next dev", "build": "next build", "start": "next start", "lint": "next lint" }, "dependencies": { "@radix-ui/react-accordion": "^1.2.0", "@radix-ui/react-alert-dialog": "^1.1.5", "@radix-ui/react-avatar": "^1.1.1", "@radix-ui/react-checkbox": "^1.1.2", "@radix-ui/react-dialog": "^1.1.2", "@radix-ui/react-label": "^2.1.2", "@radix-ui/react-progress": "^1.1.1", "@radix-ui/react-radio-group": "^1.2.3", "@radix-ui/react-scroll-area": "^1.2.0", "@radix-ui/react-select": "^2.1.1", "@radix-ui/react-separator": "^1.1.1", "@radix-ui/react-slot": "^1.1.2", "@radix-ui/react-tabs": "^1.1.3", "@react-three/cannon": "^6.6.0", "@react-three/drei": "^9.121.4", "@react-three/fiber": "^8.17.14", "@types/bcryptjs": "^2.4.6", "@types/jsonwebtoken": "^9.0.8", "@types/react-date-range": "^1.4.9", "@types/three": "^0.172.0", "axios": "^1.7.9", "bcryptjs": "^2.4.3", "class-variance-authority": "^0.7.0", "clsx": "^2.1.1", "date-fns": "^4.1.0", "framer-motion": "^11.11.1", "jsonwebtoken": "^9.0.2", "lucide-react": "^0.446.0", "mongoose": "^8.9.5", "next": "14.2.13", "react": "^18", "react-date-range": "^2.0.1", "react-day-picker": "^8.10.1", "react-dom": "^18", "sonner": "^1.7.2", "tailwind-merge": "^2.5.2", "tailwindcss-animate": "^1.0.7", "three": "^0.172.0" }, "devDependencies": { "@types/node": "^20", "@types/react": "^18", "@types/react-dom": "^18", "postcss": "^8", "tailwindcss": "^3.4.1", "typescript": "^5" } }
```

# postcss.config.mjs

```mjs
/** @type {import('postcss-load-config').Config} */ const config = { plugins: { tailwindcss: {}, }, }; export default config;
```

# README.md

```md
This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app). ## Getting Started First, run the development server: \`\`\`bash npm run dev # or yarn dev # or pnpm dev # or bun dev \`\`\` Open [http://localhost:3000](http://localhost:3000) with your browser to see the result. You can start editing the page by modifying `app/page.tsx`. The page auto-updates as you edit the file. This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel. ## Learn More To learn more about Next.js, take a look at the following resources: - [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API. - [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial. You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome! ## Deploy on Vercel The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js. Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.
```

# tailwind.config.ts

```ts
// tailwind.config.ts import type { Config } from 'tailwindcss'; const config: Config = { darkMode: 'class', content: [ './pages/**/*.{js,ts,jsx,tsx,mdx}', './components/**/*.{js,ts,jsx,tsx,mdx}', './app/**/*.{js,ts,jsx,tsx,mdx}', ], theme: { extend: { colors: { background: { DEFAULT: 'var(--background)', secondary: 'var(--background-secondary)', }, foreground: { DEFAULT: 'var(--foreground)', secondary: 'var(--foreground-secondary)', }, primary: { DEFAULT: 'var(--primary)', foreground: 'var(--primary-foreground)', }, secondary: { DEFAULT: 'var(--secondary)', foreground: 'var(--secondary-foreground)', }, muted: { DEFAULT: 'var(--muted)', foreground: 'var(--muted-foreground)', }, accent: { DEFAULT: 'var(--accent)', foreground: 'var(--accent-foreground)', }, destructive: { DEFAULT: 'var(--destructive)', foreground: 'var(--destructive-foreground)', }, border: 'var(--border)', input: 'var(--input)', ring: 'var(--ring)', }, animation: { 'accordion-down': 'accordion-down 0.2s ease-out', 'accordion-up': 'accordion-up 0.2s ease-out', 'fade-in': 'fade-in 0.3s ease-out', 'fade-out': 'fade-out 0.2s ease-in', 'slide-in': 'slide-in 0.3s ease-out', 'slide-out': 'slide-out 0.2s ease-in', }, keyframes: { 'accordion-down': { from: { height: '0' }, to: { height: 'var(--radix-accordion-content-height)' }, }, 'accordion-up': { from: { height: 'var(--radix-accordion-content-height)' }, to: { height: '0' }, }, 'fade-in': { '0%': { opacity: '0' }, '100%': { opacity: '1' }, }, 'fade-out': { '0%': { opacity: '1' }, '100%': { opacity: '0' }, }, 'slide-in': { '0%': { transform: 'translateY(10px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' }, }, 'slide-out': { '0%': { transform: 'translateY(0)', opacity: '1' }, '100%': { transform: 'translateY(-10px)', opacity: '0' }, }, }, }, }, plugins: [require('tailwindcss-animate')], }; export default config;
```

# tsconfig.json

```json
{ "compilerOptions": { "lib": ["dom", "dom.iterable", "esnext"], "allowJs": true, "skipLibCheck": true, "strict": true, "noEmit": true, "esModuleInterop": true, "module": "esnext", "moduleResolution": "bundler", "resolveJsonModule": true, "isolatedModules": true, "jsx": "preserve", "incremental": true, "plugins": [ { "name": "next" } ], "paths": { "@/*": ["./*"] } }, "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"], "exclude": ["node_modules"] }
```

# types\index.ts

```ts
export type UserType = 'individual' | 'legal'; export type UserRole = | 'student' | 'carrier' | 'cargo-owner' | 'logistics-company' | 'transport-company' | 'logit-trans'; export type Language = 'ru' | 'uz'; export interface UserState { type?: UserType; role?: UserRole; language?: Language; isAuthenticated?: boolean; userData?: { photo?: string; companyName?: string; fullName?: string; telegramNumber?: string; whatsappNumber?: string; phoneNumber?: string; position?: string; registrationCertificate?: string; studentStatus?: string; city?: string; tariff?: string; groupName?: string; studyLanguage?: string; curatorName?: string; endDate?: string; }; }
```